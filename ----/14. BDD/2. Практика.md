Java_QA / Level 2. Medium - Продвинутые темы / Урок 03. Подходы в разработке автотестов

[![Назад](https://img.shields.io/badge/-%D0%9D%D0%B0%D0%B7%D0%B0%D0%B4-brightgreen)](1.%20Лекция.md)
[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](3.%20Задание.md)

***

# 1. Создание и настройка нового проекта

## 1.1. Файл POM

### 1.1.1. Раздел \<properties\>

Шаги:

1. Создать новый проект **Maven** в **IntelliJ IDEA**.

2. Открыть файл **POM.xml**.

3. Добавить в раздел **\<properties\>**:

```xml
<!-- Параметры -->
<properties>
    Добавлять вот сюда
</properties>
```

* кодировку проекта - **UTF-8**

```xml
<!-- Кодировка проекта - UTF-8 -->
<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
<project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
```

* версию Java - **15** или на ваше усмотрение

```xml
<!-- Версия Java - 15 -->
<source>15</source>
<target>15</target>
```

* версии библиотек (**dependencies**)

```xml
<!-- Версии зависимостей: -->
<!-- Cucumber -->
<cucumber>6.11.0</cucumber>
<!-- JUnit -->
<junit-jupiter-engine>5.8.0</junit-jupiter-engine>
<junit-vintage-engine>5.8.0</junit-vintage-engine>
<!-- Selenium WebDriver -->
<selenium-java>4.0.0-beta-4</selenium-java>
<!-- WebDriver Manager -->
<webdrivermanager>5.0.2</webdrivermanager>
<!-- Log4J -->
<log4j-api>2.14.1</log4j-api>
<log4j-core>2.14.1</log4j-core>
<!-- aShot -->
<ashot>1.5.4</ashot>
```

* версии плагинов (**plugins**)

```xml
<!-- Версии плагинов: -->
<!-- maven-surefire-plugin -->
<maven-surefire-plugin>2.22.2</maven-surefire-plugin>
<!-- maven-compiler-plugin -->
<maven-compiler-plugin>3.8.1</maven-compiler-plugin>
```

### 1.1.2. Раздел \<dependencies\>

Шаги:

1. Открыть файл **POM.xml**.

2. Добавить в раздел **\<dependencies\>**:

```xml
<!-- Зависимости -->
<dependencies>
    Добавлять вот сюда
</dependencies>
```  

* BDD фреймворк **Cucumber**

```xml
<!-- Cucumber -->
<dependency>
    <groupId>io.cucumber</groupId>
    <artifactId>cucumber-java</artifactId>
    <version>${cucumber}</version>
    <scope>test</scope>
</dependency>
<dependency>
    <groupId>io.cucumber</groupId>
    <artifactId>cucumber-junit</artifactId>
    <version>${cucumber}</version>
    <scope>test</scope>
</dependency>
```

* фреймворк тестирования **JUnit**

```xml
<!-- JUnit -->
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter-engine</artifactId>
    <version>${junit-jupiter-engine}</version>
    <scope>test</scope>
</dependency>
<dependency>
    <groupId>org.junit.vintage</groupId>
    <artifactId>junit-vintage-engine</artifactId>
    <version>${junit-vintage-engine}</version>
    <scope>test</scope>
</dependency>
```    

* драйвер браузера **Selenium WebDriver**

```xml
<!-- Selenium WebDriver -->
<dependency>
    <groupId>org.seleniumhq.selenium</groupId>
    <artifactId>selenium-java</artifactId>
    <version>${selenium-java}</version>
    <scope>test</scope>
</dependency>
```

* менеджер драйверов **WebDriver Manager**

```xml
<!-- WebDriver Manager -->
<dependency>
    <groupId>io.github.bonigarcia</groupId>
    <artifactId>webdrivermanager</artifactId>
    <version>${webdrivermanager}</version>
    <scope>test</scope>
</dependency>
```

* логгер **Log4J**

```xml
<!-- Log4J -->
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-api</artifactId>
    <version>${log4j-api}</version>
    <scope>test</scope>
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-core</artifactId>
    <version>${log4j-core}</version>
    <scope>test</scope>
</dependency>
```

* скриншотер **aShot**

```xml
<!-- aShot -->
<dependency>
    <groupId>ru.yandex.qatools.ashot</groupId>
    <artifactId>ashot</artifactId>
    <version>${ashot}</version>
    <scope>test</scope>
</dependency>
```

### 1.1.3. Раздел \<build\>\<plugins\>

Шаги:

1. Открыть файл **POM.xml**.

2. Добавить в раздел **\<build\>\<plugins\>**:

```xml
<!-- Сборка -->
<build>
    <!-- Плагины -->
    <plugins>
        Добавлять сюда
    </plugins>
</build>
```

* плагин для запуска автотестов **maven-surefire-plugin**

```xml
<!-- maven-surefire-plugin -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>${maven-surefire-plugin}</version>
</plugin>
```

* плагин для компиляции **Java** программ **maven-compiler-plugin**

```xml
<!-- maven-compiler-plugin -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>${maven-compiler-plugin}</version>
    <configuration>
        <source>${source}</source>
        <target>${target}</target>
    </configuration>
</plugin>
```

## 1.2. Полный код POM.xml

[POM.xml](_Sample_03/pom.xml)

## 1.3. Файл .gitignore

Шаги:

1. Создать файл **.gitignore** в корне проекта.

2. Настроить файл.

Использовать онлайн генератор [gitignore.io](https://docs.gitignore.io/).

В репозитории **GitHub** не должно быть:

* файлов *IntelliJ IDEA*
* файлов *VS Code*
* файлов компиляции *Java*

## 1.4. Файл log4j2.xml

Шаги:

1. Создать конфиг файл для логгирования **log4j2.xml** в **./src/main/resources**.

![New Maven Project - log4j2.xml](./_Files/2.%20New%20Project/01.jpg "New Project - log4j2.xml")

2. Настроить конфиг файл **log4j2.xml**.

```xml
<Configuration monitorInterval="30">
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%highlight{[%d{HH:mm:ss.SSS}] | %-5p | %-32.42t | %-32.42c{1} | %m%n}{FATAL=red blink, ERROR=red blink, WARN=yellow bold, INFO=black, DEBUG=green bold, TRACE=blue}"/>
        </Console>
        <File name="MyFile" fileName="logs.log">
            <PatternLayout>
                <Pattern>%d %p %c{1.} [%t] %m%n</Pattern>
            </PatternLayout>
        </File>
    </Appenders>
    <Loggers>
        <Root level="info">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="MyFile"/>
        </Root>
    </Loggers>
</Configuration>
```

## 1.5. Полный код log4j2.xml

[log4j2.xml](_Sample_03/src/main/resources/log4j2.xml))

## 1.6. Коммит и пуш проекта

Шаги:

1. Проверить, что шаги с **1.1.** по **1.5.** выполнены.

2. Закоммитить и запушить проект в удаленный репозиторий (**GitHub**).

***

# 2. Структура папок проекта

Для дальнейшей работы с фреймворком необходимо настроить структуру папок проекта.

Изначально все выглядит так:

![New Maven Project - Project](./_Files/2.%20New%20Project/02.jpg "New Project - Project")

В общем случае может быть любая конфигурация пакетов и папок с файлами.

## 2.1. Папка с .feature файлами

Шаги:

1. Создать папку Java **resources** в папке **./src/test**.

![New Maven Project - ./src/test/resources](./_Files/2.%20New%20Project/03.jpg "New Project - ./src/test/resources")

2. Создать папку **features** в папке **./src/test/resources**.

В данной папке будут находиться **.feature** файлы.
Вообще можно разместить папку с данными файлами в любом другом месте, 
но в Java принято размещать любые файлы не содержащие исходный код в папку **resources**.

![New Maven Project - ./src/test/resources/features](./_Files/2.%20New%20Project/04.jpg "New Project - ./src/test/resources/features")

## 2.2. Пакеты с .java файлами

Шаги:

1. Создать пакет Java **steps** в папке **./src/test/java**.

В данном пакете будут находиться **.java** файлы c реализацией шагов тестовых сценариев описанных **.feature** файлах.

![New Maven Project - ./src/test/java/steps](./_Files/2.%20New%20Project/05.jpg "New Project - ./src/test/java/steps")

2. Создать пакет Java **hooks** в папке **./src/test/java**.

В данном пакете будут находиться **.java** файлы c действиями, 
выполняемыми до и после исполнения сценариев / шагов описанных в **.feature** файлах.

![New Maven Project - ./src/test/java/hooks](./_Files/2.%20New%20Project/06.jpg "New Project - ./src/test/java/hooks")

3. Создать пакет Java **web** в папке **./src/test/java**.

В данном пакете будут находиться пакеты с **.java** файлами, в которых описаны классы и 
методы для взаимодействия с тестируемой системой - сайтом **DNS** в веб браузере.

![New Maven Project - ./src/test/java/web](./_Files/2.%20New%20Project/07.jpg "New Project - ./src/test/java/web")

3.1. Создать пакет Java **drivers** в папке **./src/test/java/web**.

В данном пакете будут находиться **.java** файлы для настройки Selenium драйвера.

3.2. Создать пакет Java **helpers** в папке **./src/test/java/web**.

В данном пакете будут находиться **.java** файлы для настройки ожиданий и выполнения скриптом на JS.

3.3. Создать пакет Java **elements** в папке **./src/test/java/web**.

В данном пакете будут находиться **.java** файлы с веб элементами.

3.4. Создать пакет Java **pages** в папке **./src/test/java/web**.

В данном пакете будут находиться **.java** файлы с пейдж обджектами.

![New Maven Project - ./src/test/java/web](./_Files/2.%20New%20Project/08.jpg "New Project - ./src/test/java/web")

4. Создать пакет Java **models** в папке **./src/text/java**.

В данном пакете будут находиться **.java** файлы с моделями тестовых данных.

![New Maven Project - ./src/test/java/models](./_Files/2.%20New%20Project/09.jpg "New Project - ./src/test/java/models")

4.1. Создать пакет **valueobjects** в папке **./src/text/java/models**.

В данном пакете будут находиться **.java** файлы с объектами-значениями.

4.2. Создать пакет **testobjects** в папке **./src/text/java/models**.

В данном пакете будут находиться **.java** файлы с объектами.

![New Maven Project - ./src/test/java/models](./_Files/2.%20New%20Project/10.jpg "New Project - ./src/test/java/models")

***

# 3. Драйверы браузера

## 3.1. Перечисление BrowserName

***BrowserName*** - перечисление для хранения имен браузеров,
которые будут передаваться в качестве параметров при запуске.

Шаги:

1. Создать файл **BrowserName.java** в **./src/test/java/web/drivers**.

При создании класса выбрать **Enum** (Перечисление).

![New Maven Project - BrowserName.java](./_Files/2.%20New%20Project/11.jpg "New Project - BrowserName.java")

2. Добавить в файл **BrowserName.java** код.

* константы, определяющие названия браузеров

```java
// Имена браузеров
CHROME("chrome"),   // Google Chrome
FIREFOX("firefox"), // Mozilla Firefox
EDGE("edge");       // Microsoft Edge
```

* переменная для хранения строкового значения константы

```java
private String browserName; // Имя браузера
```

* приватный конструктор

```java
// Приватный конструктор
private BrowserName(String browserName) {
    this.browserName = browserName;
}
```

* переопределенный метод **toString**

```java
// Переопределенный метод toString()
@Override
public String toString() {
    return String.valueOf(this.browserName);
}
```

* метод **fromString** - возврат константы по строковому значению константы

```java
// Возврат значения константы по строковому значению константы
public static BrowserName fromString(String browserName) {
    if (browserName != null) {
        for(BrowserName b : BrowserName.values()) {
            if (browserName.equalsIgnoreCase(b.browserName)) {
                return b;
            }
        }
    }
    return null;
}
```

* метод **getBrowserName** - получение имени браузера

```java
// Получение имени браузера
public String getBrowserName() {
    return this.browserName;
}
```

## 3.2. Полный код BrowserName.java

[BrowserName.java](_Sample_03/src/test/java/web/drivers/BrowserName.java)

## 3.3. Класс ChromeBrowserDriver

***ChromeBrowserDriver*** - класс для создания и настройки экземпляра веб драйвера **Goggle Chrome**.

Шаги:

1. Создать файл **ChromeBrowserDriver.java** в **./src/test/java/web/drivers**.

![New Maven Project - ChromeBrowser.java](./_Files/2.%20New%20Project/12.jpg "New Project - ChromeBrowserDriver.java")

2. Добавить в файл **ChromeBrowserDriver.java** код.

* метод **getDriver** - получение экземпляра драйвера браузера **Google Chrome**

```java
// Получение экземпляра драйвера браузера "Google Chrome"
public WebDriver getDriver() {
    // Настройка исполняемого файла драйвера
    WebDriverManager.chromedriver().setup();
    
    // Опции драйвера:
    ChromeOptions options = new ChromeOptions();
    // - поведение при появлении алертов "Игнорирование"
    options.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.IGNORE);
    // - стратегия загрузки страницы "NORMAL"
    options.setCapability(CapabilityType.PAGE_LOAD_STRATEGY, PageLoadStrategy.NORMAL);
    // - режим "Инкогнито"
    options.addArguments("--incognito");
    // - режим "Полный экран"
    options.addArguments("--start-fullscreen");
    
    // Новый экземпляр драйвера
    return new ChromeDriver(options);
}
```

## 3.4. Полный код ChromeBrowserDriver.java

[ChromeBrowserDriver.java](_Sample_03/src/test/java/web/drivers/ChromeBrowserDriver.java)

## 3.5. Класс FirefoxBrowserDriver

***FirefoxBrowserDriver*** - класс для создания и настройки экземпляра веб драйвера **Mozilla Firefox**.

Шаги:

1. Создать файл **FirefoxBrowserDriver.java** в **./src/test/java/web/drivers**.

![New Maven Project - FirefoxBrowserDriver.java](./_Files/2.%20New%20Project/13.jpg "New Project - FirefoxBrowserDriver.java")

2. Добавить в файл **FirefoxBrowserDriver.java** код.

* метод **getDriver** - получение экземпляра драйвера браузера **Mozilla Firefox**

```java
// Получение экземпляра драйвера браузера "Mozilla Firefox"
public static WebDriver getDriver() {
    // Настройка исполняемого файла драйвера
    WebDriverManager.firefoxdriver().setup();
    
    // Опции драйвера:
    FirefoxOptions options = new FirefoxOptions();
    // - поведение при появлении алертов "Игнорирование"
    options.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.IGNORE);
    // - стратегия загрузки страницы "NORMAL"
    options.setCapability(CapabilityType.PAGE_LOAD_STRATEGY, PageLoadStrategy.NORMAL);
    // - режим "Инкогнито"
    options.addArguments("-private");
    // - режим "Полный экран"
    options.addArguments("-kiosk");
    
    // Новый экземпляр драйвера
    return new FirefoxDriver(options);
}
```

## 3.6. Полный код FirefoxBrowserDriver.java

[FirefoxBrowserDriver.java](_Sample_03/src/test/java/web/drivers/FirefoxBrowserDriver.java)

## 3.7. Класс EdgeBrowserDriver

***EdgeBrowserDriver*** - класс для создания и настройки экземпляра веб драйвера **Microsoft Edge**.

Шаги:

1. Создать файл **EdgeBrowserDriver.java** в **./src/test/java/web/drivers**.

![New Maven Project - EdgeBrowserDriver.java](./_Files/2.%20New%20Project/14.jpg "New Project - EdgeBrowserDriver.java")

2. Добавить в файл **EdgeBrowserDriver.java** код.

* метод **getDriver** - получение экземпляра драйвера браузера **Microsoft Edge**

```java
// Получение экземпляра драйвера браузера "Microsoft Edge"
public static WebDriver getDriver() {
    // Настройка исполняемого файла драйвера
    WebDriverManager.edgedriver().setup();
    
    // Опции драйвера:
    EdgeOptions options = new EdgeOptions();
    // - поведение при появлении алертов "Игнорирование"
    options.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.IGNORE);
    // - стратегия загрузки страницы "NORMAL"
    options.setCapability(CapabilityType.PAGE_LOAD_STRATEGY, PageLoadStrategy.NORMAL);
    // - режим "Инкогнито"
    options.addArguments("--incognito");
    // - режим "Полный экран"
    options.addArguments("--start-fullscreen");
    
    // Новый экземпляр драйвера
    return new EdgeDriver(options);
}
```

## 3.8. Полный код EdgeBrowserDriver.java

[EdgeBrowserDriver.java](_Sample_03/src/test/java/web/drivers/EdgeBrowserDriver.java)

## 3.9. Класс WebDriverFactory

***WebDriverFactory*** - класс реализующий паттерн фабрика, фабрика по созданию экземпляров веб драйверов.

Шаги:

1. Создать файл **WebDriverFactory.java** в **./src/test/java/web/drivers**.

![New Maven Project - WebDriverFactory.java](./_Files/2.%20New%20Project/15.jpg "New Project - WebDriverFactory.java")

2. Добавить в файл **WebDriverFactory.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(WebDriverFactory.class);
```

* объявление ссылки на экземпляр драйвера

```java
// Драйвер
private static WebDriver webDriver;
```

* метод **getDriver** - получение экземпляра драйвера по имени

```java
// Получение экземпляра драйвера по имени
public static WebDriver getDriver(BrowserName name) {
    switch (name) {
    // Драйвер браузера Google Chrome
    case CHROME:
        logger.info("Драйвер браузера Google Chrome");
        webDriver = ChromeBrowserDriver.getDriver();
        return webDriver;
    // Драйвер браузера Mozilla Firefox
    case FIREFOX:
        logger.info("Драйвер браузера Mozilla Firefox");
        webDriver = FirefoxBrowserDriver.getDriver();
        return webDriver;
    // Драйвер браузера Microsoft Edge
    case EDGE:
        logger.info("Драйвер браузера Microsoft Edge");
        webDriver = EdgeBrowserDriver.getDriver();
        return webDriver;
    // По умолчанию
    default:
        throw new RuntimeException("Некорректное наименование браузера");
    }
}
```

* метод **getCurrentDriver** - получение уже созданного экземпляра драйвера

```java
// Получение уже созданного экземпляра драйвера
public static WebDriver getCurrentDriver() {
    return webDriver;
}
```
## 3.10. Полный код WebDriverFactory.java

[WebDriverFactory.java](_Sample_03/src/test/java/web/drivers/WebDriverFactory.java)

***

## 4. Хелперы

## 4.1. Класс WaitHelper

***WaitHelper*** - класс для настройки и выполнения явных ожиданий.
Содержит статические методы для настройки таймингов ожиданий и ожидания появления событий.

Шаги:

1. Создать файл **WaitHelper.java** в **./src/test/java/web/helpers**.

![New Maven Project - WaitHelper.java](./_Files/2.%20New%20Project/16.jpg "New Project - WaitHelper.java")

2. Добавить в файл **WaitHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(WaitHelper.class);
```

* объявление ожидания драйвера браузера

```java
// Ожидание
protected static WebDriverWait wait;
```

* метод **init** - инициализация ожидания

```java
// Инициализация ожидания драйвера браузера
// Установка таймаута ожидания и интервала опроса
public static void init(Duration timeOut, Duration sleep) {
    wait = new WebDriverWait(WebDriverFactory.getCurrentDriver(), timeOut, sleep);
}
```

* метод **presenceOfElementLocated** - ожидание наличия элемента по локатору

```java
// Ожидание наличия элемента по локатору
public static void presenceOfElementLocated(By webElement) {
    wait.until(ExpectedConditions.presenceOfElementLocated(webElement));
}
```

* метод **presenceOfTextInElement** - ожидание появления текста в элементе

```java
// Ожидание появления текста в элементе
public static void presenceOfTextInElement(WebElement webElement, String text) {
    wait.until(ExpectedConditions.textToBePresentInElement(webElement, text));
}
```

* метод **clickabilityOfElement** - ожидание кликабельности элемента

```java
// Ожидание кликабельности элемента
public static void clickabilityOfElement(WebElement webElement) {
    wait.until(ExpectedConditions.elementToBeClickable(webElement));
}
```    

* метод **clickabilityOfElementLocated** - ожидание кликабельности элемента по локатору

```java
// Ожидание кликабельности элемента по локатору
public static void clickabilityOfElementLocated(By webElement) {
    wait.until(ExpectedConditions.elementToBeClickable(webElement));
}
```

* метод **visibilityOfElement** - ожидание видимости элемента

```java
// Ожидание видимости элемента
public static void visibilityOfElement(WebElement webElement) {
    wait.until(ExpectedConditions.visibilityOf(webElement));
}
```

* метод **visibilityOfElementLocated** - ожидание видимости элемента по локатору

 ```java
// Ожидание видимости элемента по локатору
public static void visibilityOfElementLocated(By webElement) {
    wait.until(ExpectedConditions.visibilityOfElementLocated(webElement));
}
```

* метод **firstProductMustBe** - ожидание появления в списке продуктов в первой позиции заданного продукта

 ```java
// Ожидание появления в списке продуктов в первой позиции заданного продукта
public static void firstProductMustBe(By webElement, String product) {
    wait.until((ExpectedCondition<Boolean>) webDriver ->
        webDriver.findElement(webElement).getText().contains(product));
}
```

## 4.2. Полный код WaitHelper.java

[WaitHelper.java](_Sample_03/src/test/java/web/helpers/WaitHelper.java)

## 4.3. Класс JavaScriptHelper

***JavaScriptHelper*** - класс для выполнения скриптов **JavaScript**.
Содержит статические методы для выполнения скриптов, решающих задачи,
которые нельзя решить стандартными возможностями **Selenium WebDriver**.

Шаги:

1. Создать файл **JavaScriptHelper.java** в **./src/test/java/web/helpers**.

![New Maven Project - JavaScriptHelper.java](./_Files/2.%20New%20Project/17.jpg "New Project - JavaScriptHelper.java")

2. Добавить в файл **JavaScriptHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(JavaScriptHelper.class);
```

* объявление исполнителя JS скриптов **JavascriptExecutor**

```java
// Исполнитель JS скриптов
protected static JavascriptExecutor javascriptExecutor;
```

* метод **init** - инициализация исполнителя JS скриптов

```java
// Инициализация исполнителя JS скриптов
public static void init() {
    javascriptExecutor = (JavascriptExecutor) WebDriverFactory.getCurrentDriver();
}
```

* метод **scrollBy** - скролл страницы на заданное расстояние в пикселях по X и по Y

```java
// Скролл страницы на заданное расстояние в пикселях по X и по Y
public static void scrollBy(int x, int y) {
    String script = "window.scrollBy(" + x + "," + y + ");";
    js.executeScript(script);
}
```

* метод **displayNone** - установка невидимости веб элемента

```java
// Установка невидимости веб элемента
public static void displayNone(WebElement element) {
    String script = "arguments[0].style.display='none';";
    js.executeScript(script, element);
}
```

## 4.4. Полный код JavaScriptHelper.java

[JavaScriptHelper.java](_Sample_03/src/test/java/web/helpers/JavaScriptHelper.java)

## 4.5. Класс ActionHelper

***ActionHelper*** - класс выполнения сложных действий на страницах.
Содержит статические методы для выполнения сложных действий пользователя, 
таких как наведение мыши на элемент, перетаскивание и т д.

Шаги:

1. Создать файл **ActionHelper.java** в **./src/test/java/web/helpers**.

![New Maven Project - ActionHelper.java](./_Files/2.%20New%20Project/18.jpg "New Project - ActionHelper.java")

2. Добавить в файл **ActionHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(ActionHelper.class);
```

* объявление экшена

```java
// Экшен
protected static Actions actions;
```

* метод **init** - инициализация экшена

```java
// Инициализация экшена
public static void init() {
    actions = new Actions(WebDriverFactory.getCurrentDriver());
}
```

* метод **moveToElement** - перемещение курсора мыши на элемент

```java
// Перемещение курсора мыши на элемент
public static void moveToElement(WebElement webElement) {
    actions.moveToElement(webElement).perform();
}
```

## 4.6. Полный код ActionHelper.java

[ActionHelper.java](_Sample_03/src/test/java/web/helpers/ActionHelper.java)

## 4.7. Класс NavigationHelper

***NavigationHelper*** - класс для навигации в браузере.
Содержит статические методы для навигации по истории браузера, 
обновления страницы и загрузки новой страницы.

Шаги:

1. Создать файл **NavigationHelper.java** в **./src/test/java/web/helpers**.

![New Maven Project - NavigationHelper.java](./_Files/2.%20New%20Project/19.jpg "New Project - NavigationHelper.java")

2. Добавить в файл **NavigationHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(NavigationHelper.class);
```

* метод **navigateTo** - открытие новой страницы

```java
// Открытие новой страницы
public static void navigateTo(String URL) {
    WebDriverFactory.getCurrentDriver().navigate().to(URL);
}
```

* метод **back** - переход на предыдущую страницу

```java
// Переход на предыдущую страницу
public static void back() {
    WebDriverFactory.getCurrentDriver().navigate().back();
}
```

* метод **forward** - переход на следующую страницу

```java
// Переход на следующую страницу
public static void forward() {
    WebDriverFactory.getCurrentDriver().navigate().forward();
}
```

* метод **refresh** - обновление страницы

```java
// Обновление страницы
public static void refresh() {
    WebDriverFactory.getCurrentDriver().navigate().refresh();
}
```

## 4.8. Полный код NavigationHelper.java

[NavigationHelper.java](_Sample_03/src/test/java/web/helpers/NavigationHelper.java)

## 4.9. Класс WindowHelper

***WindowHelper*** - класс для управления окнами браузера.
Содержит статические методы для изменения размеров и положения окна браузера.

Шаги:

1. Создать файл **WindowHelper.java** в **./src/test/java/web/helpers**.

![New Maven Project - WindowHelper.java](./_Files/2.%20New%20Project/20.jpg "New Project - WindowHelper.java")

2. Добавить в файл **WindowHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(WindowHelper.class);
```

* метод **maximizeWindow** - максимизация размеров окна

```java
// Максимизация размеров окна
public static void maximizeWindow() {
    WebDriverFactory.getCurrentDriver().manage().window().maximize();
}
```

* метод **minimizeWindow** - минимизация размеров окна

```java
// Минимизация размеров окна
public static void minimizeWindow() {
    WebDriverFactory.getCurrentDriver().manage().window().minimize();
}
```

* метод **fullscreenWindow** - отображение окна браузера в полноэкранном режиме

```java
// Отображение окна браузера в полноэкранном режиме
public static void fullscreenWindow() {
    WebDriverFactory.getCurrentDriver().manage().window().fullscreen();
}
```

* метод **getWindowPosition** - получение координат расположения окна

```java
// Получение координат расположения окна
public static Point getWindowPosition() {
    return WebDriverFactory.getCurrentDriver().manage().window().getPosition();
}
```

* метод **setWindowPosition** - установка координат расположения окна

```java
// Установка координат расположения окна
public static void setWindowPosition(Point point) {
    WebDriverFactory.getCurrentDriver().manage().window().setPosition(point);
}
```

* метод **getWindowSize** - получение размеров окна

```java
// Получение размеров окна
public static Dimension getWindowSize() {
    return WebDriverFactory.getCurrentDriver().manage().window().getSize();
}
```

* метод **setWindowSize** - установка размеров окна

```java
// Установка размеров окна
public static void setWindowSize(Dimension dimension) {
    WebDriverFactory.getCurrentDriver().manage().window().setSize(dimension);
}
```

## 4.10. Полный код WindowHelper.java

[WindowHelper.java](_Sample_03/src/test/java/web/helpers/WindowHelper.java)

## 4.11. Класс SwitchHelper

***SwitchHelper*** - класс для переключения на объекты.
Содержит статические методы для переключения на окна браузера, алерты, фреймы.

Шаги:

1. Создать файл **SwitchHelper.java** в **./src/test/java/web/helpers**.

![New Maven Project - SwitchHelper.java](./_Files/2.%20New%20Project/21.jpg "New Project - SwitchHelper.java")

2. Добавить в файл **SwitchHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(SwitchHelper.class);
```

* метод **switchToExistWindow** - переключение на созданное окно

```java
// Переключение на созданное окно
public static void switchToExistWindow(String window) {
    WebDriverFactory.getCurrentDriver().switchTo().window(window);
}
```

* метод **switchToNewWindow** - переключение на создаваемое окно

```java
// Переключение на создаваемое окно
public static void switchToNewWindow() {
    WebDriverFactory.getCurrentDriver().switchTo().newWindow(WindowType.WINDOW);
}
```

* метод **switchToNewTab** - переключение на создаваемую вкладку

```java
// Переключение на создаваемую вкладку
public static void switchToNewTab() {
    WebDriverFactory.getCurrentDriver().switchTo().newWindow(WindowType.TAB);
}
```

* метод **switchToAlert** - переключение на алерт

```java
// Переключение на алерт
public static void switchToAlert() {
    WebDriverFactory.getCurrentDriver().switchTo().alert();
}
```

* метод **switchToFrameByIndex** - переключение на фрейм по его индексу

```java
// Переключение на фрейм по его индексу
public static void switchToFrameByIndex(int index) {
    WebDriverFactory.getCurrentDriver().switchTo().frame(index);
}
```

* метод **switchToFrameByNameOrId** - переключение на фрейм по его атрибуту name или id

```java
// Переключение на фрейм по его атрибуту name или id
public static void switchToFrameByNameOrId(String nameOrId) {
    WebDriverFactory.getCurrentDriver().switchTo().frame(nameOrId);
}
```

* метод **switchToFrameByFrameWebElement** - переключение на фрейм по веб элементу

```java
// Переключение на фрейм по веб элементу
public static void switchToFrameByFrameWebElement(WebElement webElement) {
    WebDriverFactory.getCurrentDriver().switchTo().frame(webElement);
}
```

* метод **switchToParentFrame** - переключение на родительский фрейм

```java
// Переключение на родительский фрейм
public static void switchToParentFrame() {
    WebDriverFactory.getCurrentDriver().switchTo().parentFrame();
}
```

* метод **switchToDefaultContent** - переключение на основной документ

```java
// Переключение на основной документ 
public static void switchToDefaultContent() {
    WebDriverFactory.getCurrentDriver().switchTo().defaultContent();
}
```

* метод **switchToActiveWebElement** - переключение на активный веб элемент

```java
// Переключение на активный веб элемент
public static void switchToActiveWebElement() {
    WebDriverFactory.getCurrentDriver().switchTo().activeElement();
}
```

## 4.12. Полный код SwitchHelper.java

[SwitchHelper.java](_Sample_03/src/test/java/web/helpers/SwitchHelper.java)

***

# 5. Элементы страницы

## 5.1. Класс BaseElement

***BaseElement*** - базовый класс для всех веб элементов страниц.
Содержит ссылку на экземпляр класса **WebElement** и конструктор.

От данного класса наследуются все классы моделирующие конкретные типы веб элементов страницы.

Шаги:

1. Создать файл **BaseElement.java** в **./src/test/java/web/elements**.

![New Maven Project - BaseElement.java](./_Files/2.%20New%20Project/22.jpg "New Project - BaseElement.java")

2. Добавить в файл **BaseElement.java** код.

* объявление ссылки на экземпляр класса **WebElement**

```java
// Веб элемент
protected WebElement webElement;
```

* конструктор класса

```java
// Конструктор класса
public BaseElement(WebElement webElement) {
    this.webElement = webElement;
}
```

* метод **getWebElement** - получение ссылки экземпляра класса **WebElement**

```java
// Получение оборачиваемого веб элемента
// Получив оборачиваемый элемент, можно вызвать его методы
// Например, getText()
public WebElement getWebElement() {
    return webElement;
}
```

## 5.2. Полный код BaseElement.java

[BaseElement.java](_Sample_03/src/test/java/web/elements/BaseElement.java)

## 5.3. Класс Button

***Button*** - класс моделирующий элемент интерфейса **Кнопка**.

Класс **Button** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Button.java** в **./src/test/java/web/elements**.

![New Maven Project - Button.java](./_Files/2.%20New%20Project/23.jpg "New Project - Button.java")

2. Добавить в файл **Button.java** код.

* конструктор класса

```java
// Конструктор
public Button(WebElement webElement) {
    super(webElement);
}
```

* метод **click** - нажатие на кнопку

```java
// Нажатие на кнопку
public void click() {
    // Ожидание кликабельности кнопки    
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

## 5.4. Полный код Button.java

[Button.java](_Sample_03/src/test/java/web/elements/Button.java)

## 5.5. Класс TextBox

***TextBox*** - класс моделирующий элемент интерфейса **Текстовое поле ввода**.

Класс **TextBox** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **TextBox.java** в **./src/test/java/web/elements**.

![New Maven Project - TextBox.java](./_Files/2.%20New%20Project/24.jpg "New Project - TextBox.java")

2. Добавить в файл **TextBox.java** код.

* конструктор класса

```java
// Конструктор
public TextBox(WebElement webElement) {
    super(webElement);
}
```

* метод **click** - нажатие на текстовое поле ввода

```java
// Нажатие на текстовое поле ввода
public void click() {
    // Ожидание кликабельности флажка текстового поля ввода 
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

* метод **setValue** - ввод значения в текстовое поле ввода

```java
// Ввод значения в текстовое поле ввода
public void setValue(String value) {
    // Ожидание кликабельности флажка текстового поля ввода 
    WaitHelper.clickabilityOfElement(webElement);
    webElement.sendKeys(value);
}
```

## 5.6. Полный код TextBox.java

[TextBox.java](_Sample_03/src/test/java/web/elements/TextBox.java)

## 5.7. Класс CheckBox

***CheckBox*** - класс моделирующий элемент интерфейса **Флажок**.

Класс **CheckBox** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **CheckBox.java** в **./src/test/java/web/elements**.

![New Maven Project - CheckBox.java](./_Files/2.%20New%20Project/25.jpg "New Project - CheckBox.java")

2. Добавить в файл **CheckBox.java** код.

* конструктор класса

```java
// Конструктор
public CheckBox(WebElement webElement) {
    super(webElement);
}
```

* метод **setChecked** - установка флажка

```java
// Установка флажка
public void setChecked(boolean value) {
    // Ожидание кликабельности флажка
    WaitHelper.clickabilityOfElement(webElement);
    if (value != isChecked()) {
        webElement.click();
    }
}
```

* метод **isChecked** - проверка, что флажок установлен

```java
// Проверка, что флажок установлен
public boolean isChecked() {
    return webElement.isSelected();
}
```

## 5.8. Полный код CheckBox.java

[CheckBox.java](_Sample_03/src/test/java/web/elements/CheckBox.java)

## 5.9. Класс RadioButton

***RadioButton*** - класс моделирующий элемент интерфейса **Переключатель**.

Класс **RadioButton** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **RadioButton.java** в **./src/test/java/web/elements**.

![New Maven Project - RadioButton.java](./_Files/2.%20New%20Project/26.jpg "New Project - RadioButton.java")

2. Добавить в файл **RadioButton.java** код.

* конструктор класса

```java
// Конструктор
public RadioButton(WebElement webElement) {
    super(webElement);
}
```

* метод **setSelected** - установка переключателя

```java
// Установка переключателя
public void setSelected(boolean value) {
    // Ожидание кликабельности переключателя
    WaitHelper.clickabilityOfElement(webElement);
    if (value != isSelected()) {
        webElement.click();
    }
}
```

* метод **isSelected** - проверка, что переключатель установлен

```java
// Проверка, что переключатель установлен
public boolean isSelected() {
    return webElement.isSelected();
}
```

## 5.10. Полный код RadioButton.java

[RadioButton.java](_Sample_03/src/test/java/web/elements/RadioButton.java)

## 5.11. Класс Link

***Link*** - класс моделирующий элемент интерфейса **Ссылка**.

Класс **Link** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Link.java** в **./src/test/java/web/elements**.

![New Maven Project - Link.java](./_Files/2.%20New%20Project/27.jpg "New Project - Link.java")

2. Добавить в файл **Link.java** код.

* конструктор класса

```java
// Конструктор
public Link(WebElement webElement) {
    super(webElement);
}
```

* метод **click** - нажатие на ссылку

```java
// Нажатие на ссылку
public void click() {
    // Ожидание кликабельности ссылки
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

* метод **focusOnLink** - наведение курсора мыши на ссылку

```java
// Наведение курсора мыши на ссылку 
public void focusOnLink() {
    ActionHelper.moveToElement(webElement);
}
```

* метод **openInNewWindow** - открытие ссылки в новом окне

```java
// Открытие ссылки в новом окне
public void openInNewWindow() {
    // Получение URL ссылки
    String URL = this.getURL();
    // Создание нового окна и переключение на него
    SwitchHelper.switchToNewWindow();
    // Максимизация размеров окна
    WindowHelper.maximizeWindow();
    // Переход по ссылке в новом окне
    NavigationHelper.navigateTo(URL);
}
```

* метод **getURL** - получение URL ссылки

```java
// Получение URL ссылки
public String getURL() {
    return webElement.getAttribute("href");
}
```

* метод **getText** - получение текста ссылки

```java
// Получение текста ссылки
public String getText() {
    return webElement.getText();
}
```

## 5.12. Полный код Link.java

[Link.java](_Sample_03/src/test/java/web/elements/Link.java)

## 5.13. Класс Accordeon

***Accordeon*** - класс моделирующий элемент интерфейса **Гармошка**.

Класс **Accordeon** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Accordeon.java** в **./src/test/java/web/elements**.

![New Maven Project - Accordeon.java](./_Files/2.%20New%20Project/28.jpg "New Project - Accordeon.java")

2. Добавить в файл **Accordeon.java** код.

* конструктор класса

```java
// Конструктор
public Accordeon(WebElement webElement) {
    super(webElement);
}
```

* метод **show** - раскрытие гармошки

```java
// Раскрытие гармошки
public void show() {
    // Ожидание кликабельности гармошки
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

## 5.14. Полный код Accordeon.java

[Accordeon.java](_Sample_03/src/test/java/web/elements/Accordeon.java)

## 5.15. Класс MainBlock

***MainBlock*** - класс моделирующий элемент интерфейса **Главный блок**.

Класс **MainBlock** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **MainBlock.java** в **./src/test/java/web/elements**.

![New Maven Project - MainBlock.java](./_Files/2.%20New%20Project/29.jpg "New Project - MainBlock.java")

2. Добавить в файл **MainBlock.java** код.

* конструктор класса

```java
// Конструктор
public MainBlock(WebElement webElement) {
    super(webElement);
}
```

* метод **hide** - скрытие блока

```java
// Скрытие блока
public void hide() {
    JavaScriptHelper.displayNone(webElement);
}
```

## 5.16. Полный код MainBlock.java

[MainBlock.java](_Sample_03/src/test/java/web/elements/MainBlock.java)

## 5.17. Класс Table

***Table*** - класс моделирующий элемент интерфейса **Таблица**.

Класс **Table** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Table.java** в **./src/test/java/web/elements**.

![New Maven Project - Table.java](./_Files/2.%20New%20Project/30.jpg "New Project - Table.java")

2. Добавить в файл **Table.java** код.

* конструктор класса

```java
// Конструктор
public Table(WebElement webElement) {
    super(webElement);
}
```

* метод **getDataValue** - получение значения ячеек таблицы

```java
// Получение значения ячеек таблицы
public String getDataValue(String dataName) {
    String xpath = "//table//td//span[contains(text(), \"" + dataName +
        "\")]/ancestor::td/following-sibling::td//span";
    return webElement.findElement(By.xpath(xpath)).getText();
}
```

## 5.18. Полный код Table.java

[Table.java](_Sample_03/src/test/java/web/elements/Table.java)

***

# 6. Страницы

## 6.1. Класс Base Page (Базовый объект страниц)

***Base Page*** - базовый класс для всех страниц.
Содержит ссылку на экземпляр драйвера и базовый конструктор.
В базовый конструктор передается ссылка на экземпляр драйвера.  
В базовом конструкторе инициализируются явное ожидание и исполнитель JS скриптов.

От данного класса наследуются все классы моделирующие конкретные страницы.

Шаги:

1. Создать файл **BasePage.java** в **./src/test/java/web/pages**.

![New Maven Project - BasePage.java](./_Files/2.%20New%20Project/31.jpg "New Project - BasePage.java")

2. Добавить в файл **BasePage.java** код.

* объявление драйвера

```java
// Драйвер браузера
protected static WebDriver driver;
```

* конструктор базового класса

```java
// Конструктор базового класса 
public BasePage(WebDriver driver) {
    BasePage.driver = driver;
    // Инициализация ожидания - 10 секунд
    WaitHelper.init(Duration.ofSeconds(10), Duration.ofMillis(100));
    // Инициализация исполнителя JS скриптов
    JavaScriptHelper.init();
    // Инициализация экшена
    ActionHelper.init();
}
```

* метод **getPageTitle** - получение заголовка текущей страницы

```java
// Получение заголовка текущей страницы
public String getPageTitle() {
    return driver.getTitle();
}
```

## 6.2. Полный код BasePage.java

[BasePage.java](_Sample_03/src/test/java/web/pages/BasePage.java)

## 6.3. Класс StartPage

***StartPage*** - класс моделирующий объекты **Стартовой страницы** сайта [dns-shop.ru](https://www.dns-shop.ru/).

Класс **StartPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **StartPage.java** в **./src/test/java/web/pages**.

![New Maven Project - StartPage.java](./_Files/2.%20New%20Project/32.jpg "New Project - StartPage.java")

2. Добавить в файл **StartPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(StartPage.class);
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// Кнопка "Да" на всплывашке
@FindBy(xpath = "//a[contains(text(),\"Да\")]")
private WebElement linkYes;
// Ссылка "Смартфоны и гаджеты"
@FindBy(xpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[1]")
private WebElement linkSmartsAndGadgets;
// Ссылка "Смартфоны"
@FindBy(xpath = "//a[text()=\"Смартфоны\"]")
private WebElement linkSmarts;
```

* конструктор класса

```java
// Конструктор класса
public StartPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* получение обернутых веб элементов

```java
// ***** Получение обернутых веб элементов *****
// Кнопка "Да" на всплывашке
public Link linkYes() {
    return new Link(linkYes);
}
// Ссылка "Смартфоны и гаджеты"
public Link linkSmartsAndGadget() {
    return new Link(linkSmartsAndGadgets);
}
// Ссылка "Смартфоны"
public Link linkSmarts() {
    return new Link(linkSmarts);
}
```

## 6.4. Полный код StartPage.java

[StartPage.java](_Sample_03/src/test/java/web/pages/StartPage.java)

## 6.5. Класс SmartphonesPage

***SmartphonesPage*** - класс моделирующий объекты страницы **Смартфоны**.

Класс **SmartphonesPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphonesPage.java** в **./src/test/java/web/pages**.

![New Maven Project - SmartphonesPage.java](./_Files/2.%20New%20Project/33.jpg "New Project - Smartphones.java")

2. Добавить в файл **SmartphonesPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphonesPage.class);
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// Шапка
@FindBy(xpath = "//header")
private WebElement mainBlock;
// Фильтры
// Фильтр "Производитель"
// Блок с чекбоксами "Производитель"
@FindBy(xpath = "//span[text()=\"Производитель\"]/parent::a/following-sibling::div//div[@class=\"ui-checkbox-group ui-checkbox-group_list\"]")
private WebElement divCompany;
// Фильтр "Объем оперативной памяти"
// Аккордеон "Объем оперативной памяти"
@FindBy(xpath = "//div[@class=\"ui-list-controls ui-collapse ui-collapse_list\"]//span[contains(text(), \"Объем оперативной памяти\")]")
private WebElement accordeonRAM;
// Блок с чекбоксами "Объем оперативной памяти"
@FindBy(xpath = "//span[text()=\"Объем оперативной памяти\"]/parent::a/following-sibling::div//div[@class=\"ui-checkbox-group ui-checkbox-group_list\"]")
private WebElement divRAM;
// Кнопка "Применить"
@FindBy(xpath = "//button[contains(text(), \"Применить\")]")
private WebElement buttonApply;
// Сортировка
// Аккордеон "Сортировка"
@FindBy(xpath = "//span[contains(text(), \"Сортировка:\")]/following::a")
private WebElement accordeonSort;
// Блок с переключателями "Сортировка"
@FindBy(xpath = "(//div[@class=\"top-filter__radio-list ui-radio top-filter__popover\"])[1]")
private WebElement divSort;
// Смартфоны
// Ссылка на первый продукт в списке
@FindBy(xpath = "(//a[contains(@class, \"catalog-product__name\")])[1]")
private WebElement linkFirstProduct;
```

* конструктор класса

```java
// Конструктор класса
public SmartphonesPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* получение обернутых веб элементов

```java
// ***** Получение обернутых веб элементов *****
// 1. Шапка
public MainBlock mainBlock() {
    return new MainBlock(mainBlock);
}
// 2. Фильтры
// Фильтр "Производитель"
// Чекбокс "Производитель"
public CheckBox checkBoxCompany(String company) {
    return new CheckBox(findCheckBoxCompany(company));
}
// Поиск чекбокса "Производитель"
private WebElement findCheckBoxCompany(String company) {
    WaitHelper.visibilityOfElement(divCompany);
    return divCompany.findElement(By.xpath("./label/span[contains(text(), \"" + company + "\")]"));
}

// Фильтр "Объем оперативной памяти"
// Аккордеон "Объем оперативной памяти"
public Accordeon accordeonRAM() {
    return new Accordeon(accordeonRAM);
}
// Чекбокс "Объем оперативной памяти"
public CheckBox checkBoxRAM(String ram) {
    return new CheckBox(findCheckBoxRAM(ram));
}
// Поиск чекбокса "Объем оперативной памяти"
private WebElement findCheckBoxRAM(String ram) {
    WaitHelper.visibilityOfElement(divRAM);
    return divRAM.findElement(By.xpath("./label/span[contains(text(), \"" + ram + "\")]"));
}

// Кнопка Применить
public Button buttonApply() {
    return new Button(buttonApply);
}
// 3. Сортировка
// Аккордеон "Сортировка"
public Accordeon accordeonSort() {
    return new Accordeon(accordeonSort);
}
// Переключатель "Сортировка"
public RadioButton radioButtonSort(String sort) {
    return new RadioButton(findRadioButtonSort(sort));
}
// Поиск переключателя "Сортировка"
private WebElement findRadioButtonSort(String sort) {
    WaitHelper.visibilityOfElement(divSort);
    return divSort.findElement(By.xpath("//span[contains(text(), \"" + sort + "\")]"));
}

// 4. Ссылка на первый продукт в списке
public Link linkFirstProduct() {
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofMillis(1000));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    return new Link(linkFirstProduct);
}
```

## 6.6. Полный код SmartphonesPage.java

[SmartphonesPage.java](_Sample_03/src/test/java/web/pages/SmartphonesPage.java)

## 6.7. Класс SmartphoneProductPage (Страница "Продукт. Смартфон")

***SmartphoneProductPage*** - класс моделирующий объекты страницы **Продукт. Смартфон**.

Класс **SmartphoneProductPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphoneProductPage.java** в **./src/test/java/web/pages**.

![New Maven Project - SmartphoneProductPage.java](./_Files/2.%20New%20Project/34.jpg "New Project - SmartphoneProductPage.java")

2. Добавить в файл **SmartphoneProductPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphoneProductPage.class);
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// Ссылка "Характеристики"
@FindBy(xpath = "//a[text()=\"Характеристики\"]")
private WebElement linkCharacteristics;
// Таблица "Характеристики"
@FindBy(xpath = "//table")
private WebElement tableCharacteristics;
```

* конструктор класса

```java
// Конструктор класса
public SmartphoneProductPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* получение обернутых веб элементов

```java
// ***** Получение обернутых веб элементов *****
// Ссылка "Характеристики"
public Link linkCharacteristics() {
    WaitHelper.visibilityOfElement(linkCharacteristics);
    return new Link(linkCharacteristics);
}
// Таблица "Характеристики"
public Table tableCharacteristics() {
    WaitHelper.visibilityOfElement(tableCharacteristics);
    return new Table(tableCharacteristics);
}
```

## 6.8. Полный код SmartphoneProductPage.java

[SmartphoneProductPage.java](_Sample_03/src/test/java/web/pages/SmartphoneProductPage.java)

***

# 7. Объекты Значения

## 7.1. Класс Ram

***Ram*** - класс представляющий объект-значение ОП.

Данный класс реализует интерфейс **java.io.Serializable**.

Шаги:

1. Создать файл **Ram.java** в **./src/test/java/models/valueobjects**.

![New Maven Project - Ram.java](./_Files/2.%20New%20Project/35.jpg "New Project - Ram.java")

2. Добавить в файл **Ram.java** код.

* объявление полей класса

```java
// ОП
private int ram;
```

* конструктор класса по умолчанию

```java
// Конструктор по умолчанию
public Ram() {

}
```

* конструктор класса с проверкой

```java
// Конструктор с проверкой
public Ram(int ram) {
    // Если задано значение меньше 0, то выбросить исключение
    if (ram > 0)
        this.ram = ram;
    else
        throw new IllegalArgumentException("ОП не может быть меньше 0");
}
```

* геттеры

```java
// Геттер
public int getRam() {
    return this.ram;
}
```

* переопределенный метод сравнения

```java
// Переопределенный метод сравнения
public boolean equals(Ram otherRam) {
    return this.ram == otherRam.ram;
}
```

## 7.2. Полный код Ram.java

[Ram.java](_Sample_03/src/test/java/models/valueobjects/Ram.java)

## 7.3. Класс Company

***Company*** - класс представляющий объект-значение Производитель.

Данный класс реализует интерфейс **java.io.Serializable**.

Шаги:

1. Создать файл **Company.java** в **./src/test/java/models/valueobjects**.

![New Maven Project - Company.java](./_Files/2.%20New%20Project/36.jpg "New Project - Company.java")

2. Добавить в файл **Company.java** код.

* объявление полей класса

```java
// Производитель
private String company;
```

* конструктор класса по умолчанию

```java
// Конструктор по умолчанию
public Company() {

}
```

* конструктор класса с проверкой

```java
// Конструктор с проверкой
public Company(String company) {
    if (!company.isBlank() || !company.isEmpty())
        this.company = company;
    else
        throw new IllegalArgumentException("Наименование производителя не может быть пустым!");
}
```

* геттеры

```java
// Геттер
public String getCompany() {
    return this.company;
}
```

* переопределенный метод сравнения

```java
// Переопределенный метод сравнения
public boolean equals(Company otherCompany) {
    return this.company.equals(otherCompany.company);
}
```

## 7.4. Полный код Company.java

[Company.java](_Sample_03/src/test/java/models/valueobjects/Company.java)

***

# 8. Объекты JavaBean

## 8.1. Класс Smartphone

***Smartphone*** - класс представляющий смартфон, созданный с применением **JavaBeans** и **ValueObject**.

Данный класс реализует интерфейс **java.io.Serializable**.

Шаги:

1. Создать файл **Smartphone.java** в **./src/test/java/models**.

![New Maven Project - Smartphone.java](./_Files/2.%20New%20Project/37.jpg "New Project - Smartphone.java")

2. Добавить в файл **Smartphone.java** код.

* объявление полей класса

```java
// Оперативная память
private Ram ram;
// Компания
private Company company;
```

* конструктор класса по умолчанию

```java
// Конструктор по умолчанию
public Smartphone() {

}
```

* конструктор класса

```java
// Конструктор
public Smartphone(Ram ram, Company company) {
    this.ram = ram;
    this.company = company;
}
```

* cеттеры и геттеры

```java
// Сеттеры и геттеры
// Оперативная память
public void setRam(Ram ram) {
    this.ram = ram;
}

public Ram getRam() {
    return this.ram;
}
// Компания
public void setCompany(Company company) {
    this.company = company;
}

public Company getCompany() {
    return this.company;
}
```

## 8.2. Полный код Smartphone.java

[Smartphone.java](_Sample_03/src/test/java/models/Smartphone.java)

***

# 9. Фичи и сценарии

## 9.1. Фича Smartphone

***Smartphone*** - **.feature** файл, содержащий сценарии.

Шаги:

1. Создать файл **Smartphone.feature** в **./src/test/resources/features**.

![New Maven Project - Smartphone.feature](./_Files/2.%20New%20Project/38.jpg "New Project - Smartphone.feature")

2. Добавить в файл **Smartphone.feature**:

* язык сценариев - **русский**

```gherkin
# language: ru
```

* кодировка - **utf-8**

```gherkin
# encoding: utf-8
```

* заголовок фичи - **Смартфоны**

```gherkin
# language: ru
# encoding: utf-8
Функция: Смартфоны
```

* описание (пользовательская история)

```gherkin
# language: ru
# encoding: utf-8
Функция: Смартфоны

  Я как посетитель сайта ДНС хочу просматривать раздел со смартфонами.
  Это позволит мне выбрать понравившийся смартфон и просмотреть его характеристики.

```

### 9.1.1. Сценарий Просмотр страницы Смартфоны

***Просмотр страницы Смартфоны*** - сценарий просмотра страницы "Смартфоны".

Шаги:

1. Открыть файл **Smartphone.feature** в **./src/test/resources/features**.

2. Добавить сценарий:

* заголовок сценария - **Просмотр страницы Смартфоны**

```gherkin
# language: ru
# encoding: utf-8
Функция: Смартфоны

  Я как посетитель сайта ДНС хочу просматривать раздел со смартфонами.
  Это позволит мне выбрать понравившийся смартфон и просмотреть его характеристики.

  Сценарий: Просмотр страницы Смартфоны
```

* шаг **Дано** *Запущен браузер и открыта Главная страница ДНС*

```gherkin
# language: ru
# encoding: utf-8
Функция: Смартфоны

  Я как посетитель сайта ДНС хочу просматривать раздел со смартфонами.
  Это позволит мне выбрать понравившийся смартфон и просмотреть его характеристики.

  Сценарий: Просмотр страницы Смартфоны
    Дано Запущен браузер и открыта Главная страница ДНС
```

* шаг **Когда** *Выполнен переход на страницу Смартфоны*

```gherkin
# language: ru
# encoding: utf-8
Функция: Смартфоны

  Я как посетитель сайта ДНС хочу просматривать раздел со смартфонами.
  Это позволит мне выбрать понравившийся смартфон и просмотреть его характеристики.

  Сценарий: Просмотр страницы Смартфоны
    Дано Запущен браузер и открыта Главная страница ДНС
    Когда Выполнен переход на страницу Смартфоны
```

* шаг **Тогда** *Проверить: В заголовке страницы отображется текст Смартфоны*

```gherkin
# language: ru
# encoding: utf-8
Функция: Смартфоны

  Я как посетитель сайта ДНС хочу просматривать раздел со смартфонами.
  Это позволит мне выбрать понравившийся смартфон и просмотреть его характеристики.

  Сценарий: Просмотр страницы Смартфоны
    Дано Запущен браузер и открыта Главная страница ДНС
    Когда Выполнен переход на страницу Смартфоны
    Тогда Проверить: В заголовке страницы отображется текст Смартфоны
```

## 9.2. Полный код Smartphone.feature

[Smartphone.feature](_Sample_03/src/test/resources/features/Smartphone.feature)

***

# 10. Шаги

## 10.1. Класс SmartphoneSteps 

***SmartphoneSteps*** - класс с реализацией шагов сценариев.

Шаги:

1. Создать файл **SmartphoneSteps.java** в **./src/test/java/steps**.

![New Maven Project - SmartphoneSteps.java](./_Files/2.%20New%20Project/39.jpg "New Project - SmartphoneSteps.java")

2. Добавить в файл **SmartphoneSteps.java** код.

* объявление драйвера браузера

```java
// Драйвер браузера
protected static WebDriver driver;
```
* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphoneSteps.class);
```

* метод **startDriverAndOpenStartPage** - шаг **Дано** *Запущен браузер и открыта Главная страница ДНС*

```java
@Дано("Запущен браузер и открыта Главная страница ДНС")
public void startDriverAndOpenStartPage() {
    // Запустить драйвер
    driver = WebDriverFactory.getDriver(BrowserName.fromString("Chrome"));
    logger.info("Драйвер стартовал!");
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");
    logger.info("Открыта Стартовая страница сайта DNS");
}
```

* метод **openSmartphonesPage** - шаг **Когда** *Выполнен переход на страницу Смартфоны*

```java
@Когда("Выполнен переход на страницу Смартфоны")
public void openSmatphonesPage() {
    StartPage startPage = new StartPage(driver);
    startPage.linkYes().click();
    startPage.linkSmartsAndGadget().focusOnLink();
    startPage.linkSmarts().click();
    logger.info("Выполнен переход на страницу Смартфоны");
}
```

* метод **assertTitle** - шаг **Тогда** *Проверить: В заголовке страницы отображается текст Смартфоны*


```java
@Тогда("Проверить: В заголовке страницы отображается текст Смартфоны")
public void assertTitle() {
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Проверка заголовка страницы
    Assertions.assertTrue(smartphonesPage.getPageTitle().contains("Смартфоны"));
    // Если драйвер еще существует
    if(driver != null) {
        // Закрываем его
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 10.2. Полный код SmartphoneSteps.java

[SmartphoneSteps.java](_Sample_03/src/test/java/steps/SmartphoneSteps.java)

***

# 11. Раннер

***RunCucumberTest*** - класс для запуска сценариев.

Шаги:

1. Создать файл **RunCucumberTest.java** в **./src/test/java**.

![New Maven Project - RunCucumberTest.java](./_Files/2.%20New%20Project/40.jpg "New Project - RunCucumberTest.java")

2. Добавить в файл **RunCucumberTest.java** код.

* указание класса для запуска тестов

```java
// @RunWith
// Указание класса для запуска тестов
@RunWith(Cucumber.class)
```

* указание опций для запуска сценариев

```java
// @CucumberOptions
// Указание опции для запуска сценариев
@CucumberOptions(
    // Список папок с feature файлами - фичи/сценарии
    features = {"src/test/resources/features"},
    // Спиcок пакетов с steps файлами - шаги
    glue = {"steps"}
)
```

***

# 12. Запуск тестовых сценариев

## 12.1. С помощью IntelliJ IDEA

Шаги:

1. Открыть **.feature** файл **Smartphone.feature**

2. Запустить только один сценария

![New Maven Project - Запуск 1 сценария](./_Files/2.%20New%20Project/41.jpg "New Project - Запуск 1 сценария")

![New Maven Project - Запуск 1 сценария](./_Files/2.%20New%20Project/42.jpg "New Project - Запуск 1 сценария")

3. Запустить все сценарии функции

![New Maven Project - Запуск всех сценариев](./_Files/2.%20New%20Project/43.jpg "New Project - Запуск всех сценариев")

![New Maven Project - Запуск всех сценариев](./_Files/2.%20New%20Project/44.jpg "New Project - Запуск всех сценариев")

4. Получить результаты запуска в консоли

![New Maven Project - Результаты запуска сценария](./_Files/2.%20New%20Project/45.jpg "New Project - Результаты запуска сценария")

## 12.2. С помощью раннер класса

Шаги:

1. Открыть файл **RunCucumberTest.java**

2. Проверить, что в **@CucumberOptions** заданы верные пути до **.feature** файлов и реализации шагов сценариев

3. Запустить сценарии

![New Maven Project - Запуск всех сценариев](./_Files/2.%20New%20Project/46.jpg "New Project - Запуск всех сценариев")

4. Получить результаты запуска в консоли

![New Maven Project - Результаты запуска сценария](./_Files/2.%20New%20Project/47.jpg "New Project - Результаты запуска сценария")

## 12.3. С помощью Maven

Шаги:

1. Проверить, что модуль **JUnit Vintage** подключен к проекту

**Cucumber** основан на **JUnit 4**.
Поэтому для запуска через **Maven** сценариев **Cucumber** с **JUnit5** обязательно нужно подключить
модуль **JUnit Vintage**.

В отличие от предыдущих версий **JUnit**, **JUnit 5** состоит из нескольких разных модулей.
Модуль **JUnit Vintage** предоставляет возможности для запуска тестов на основе **JUnit 3** и **JUnit 4**.

2. Запустить выполнение сценариев через команду **Maven**

При запуске считываются параметры (по приоритету) из:

* переменных среды 
* **-D** параметров 
* **@CucumberOptions**
* **junit-platform.properties**

* запуск всех сценариев

```shell
mvn clean test -Dtest=RunCucumberTest
```

или

```shell
mvn clean test
```

* запуск файла с фичами

```shell
mvn clean test -Dcucumber.features=src/test/resources/features/Smartphone.feature
```

3. Получить результаты запуска в консоли

![New Maven Project - Результаты запуска сценария](./_Files/2.%20New%20Project/48.jpg "New Project - Результаты запуска сценария")

***

Задание [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](3.%20Задание.md)