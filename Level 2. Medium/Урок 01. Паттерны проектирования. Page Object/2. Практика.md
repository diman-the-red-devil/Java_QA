Java_QA / Level 2. Medium - Продвинутые темы / Урок 01. Паттерны проектирования. Page Object

[![Назад](https://img.shields.io/badge/-%D0%9D%D0%B0%D0%B7%D0%B0%D0%B4-brightgreen)](1.%20Лекция.md)
[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](3.%20Задание.md)

***

# 1. Создание и настройка нового проекта

## 1.1. Файл POM

### 1.1.1. Раздел \<properties\>

Шаги:

1. Создать новый проект **Maven** в **IntelliJ IDEA**.

2. Открыть файл **POM.xml**.

3. Добавить в раздел **\<properties\>**:

```xml
<!-- Параметры -->
<properties>
    Добавлять вот сюда
</properties>
```

* кодировку проекта - **UTF-8**
  
```xml
<!-- Кодировка проекта - UTF-8 -->
<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
<project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
```

* версию Java - **15** или на ваше усмотрение

```xml
<!-- Версия Java - 15 -->
<source>15</source>
<target>15</target>
```

* версии библиотек (**dependencies**)
  
```xml
<!-- Версии зависимостей: -->
<!-- JUnit -->
<junit-jupiter-engine>5.1.0</junit-jupiter-engine>
<!-- Selenium WebDriver -->
<selenium-java>4.0.0-beta-4</selenium-java>
<!-- WebDriver Manager -->
<webdrivermanager>4.2.2</webdrivermanager>
<!-- Log4J -->
<log4j-api>2.14.0</log4j-api>
<log4j-core>2.14.0</log4j-core>
<!-- aShot -->
<ashot>1.5.4</ashot>
```

* версии плагинов (**plugins**)

```xml
<!-- Версии плагинов: -->
<!-- maven-surefire-plugin -->
<maven-surefire-plugin>2.22.2</maven-surefire-plugin>
<!-- maven-compiler-plugin -->
<maven-compiler-plugin>3.8.1</maven-compiler-plugin>
```

### 1.1.2. Раздел \<dependencies\>

Шаги:

1. Открыть файл **POM.xml**.

2. Добавить в раздел **\<dependencies\>**:

```xml
<!-- Зависимости -->
<dependencies>
    Добавлять вот сюда
</dependencies>
```  

* фреймворк тестирования **JUnit**

```xml
<!-- JUnit -->
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter-engine</artifactId>
    <version>${junit-jupiter-engine}</version>
    <scope>test</scope>
</dependency>
```    

* драйвер браузера **Selenium WebDriver**

```xml
<!-- Selenium WebDriver -->
<dependency>
    <groupId>org.seleniumhq.selenium</groupId>
    <artifactId>selenium-java</artifactId>
    <version>${selenium-java}</version>
    <scope>test</scope>
</dependency>
```

* менеджер драйверов **WebDriver Manager**

```xml
    <!-- WebDriver Manager -->
    <dependency>
        <groupId>io.github.bonigarcia</groupId>
        <artifactId>webdrivermanager</artifactId>
        <version>${webdrivermanager}</version>
        <scope>test</scope>
    </dependency>
```

* логгер **Log4J**

```xml
    <!-- Log4J -->
    <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-api</artifactId>
        <version>${log4j-api}</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-core</artifactId>
        <version>${log4j-core}</version>
        <scope>test</scope>
    </dependency>
</dependencies>
```

* скриншотер **aShot**

```xml
    <!-- aShot -->
    <dependency>
        <groupId>ru.yandex.qatools.ashot</groupId>
        <artifactId>ashot</artifactId>
        <version>${ashot}</version>
        <scope>test</scope>
    </dependency>
</dependencies>
```

### 1.1.3. Раздел \<build\>\<plugins\>

Шаги:

1. Открыть файл **POM.xml**.

2. Добавить в раздел **\<build\>\<plugins\>**:

```xml
<!-- Сборка -->
<build>
    <!-- Плагины -->
    <plugins>
        Добавлять сюда
    </plugins>
</build>
```

* плагин для запуска автотестов **maven-surefire-plugin**

```xml
<!-- maven-surefire-plugin -->
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-surefire-plugin</artifactId>
<version>${maven-surefire-plugin}</version>
</plugin>
```

* плагин для компиляции **Java** программ **maven-compiler-plugin**

```xml
<!-- maven-compiler-plugin -->
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-compiler-plugin</artifactId>
<version>${maven-compiler-plugin}</version>
<configuration>
    <source>${source}</source>
    <target>${target}</target>
</configuration>
</plugin>
```

## 1.2. Полный код POM.xml

[POM.xml](_Sample_01/POM.xml)

## 1.3. Файл .gitignore

Шаги:

1. Создать файл **.gitignore** в корне проекта.

2. Настроить файл.
   
Использовать онлайн генератор [gitignore.io](https://docs.gitignore.io/).

В репозитории **GitHub** не должно быть: 

* файлов *IntelliJ IDEA*
* файлов *VS Code*
* файлов компиляции *Java*

## 1.4. Файл log4j2.xml

Шаги:

1. Создать конфиг файл для логгирования **log4j2.xml** в **./src/main/resources**.

![New Maven Project - log4j2.xml](./_Files/2.%20New%20Project/01.jpg "New Project - log4j2.xml")

2. Настроить конфиг файл **log4j2.xml**.

```xml
<Configuration monitorInterval="30">
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%highlight{[%d{HH:mm:ss.SSS}] | %-5p | %-32.42t | %-32.42c{1} | %m%n}{FATAL=red blink, ERROR=red blink, WARN=yellow bold, INFO=black, DEBUG=green bold, TRACE=blue}"/>
        </Console>
        <File name="MyFile" fileName="logs.log">
            <PatternLayout>
                <Pattern>%d %p %c{1.} [%t] %m%n</Pattern>
            </PatternLayout>
        </File>
    </Appenders>
    <Loggers>
        <Root level="info">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="MyFile"/>
        </Root>
    </Loggers>
</Configuration>
```

## 1.5. Полный код log4j2.xml

[log4j2.xml]()

## 1.6. Коммит и пуш проекта

Шаги:

1. Проверить, что шаги с **1.1.** по **1.3.** выполнены.

2. Закоммитить и запушить проект в удаленный репозиторий (**GitHub**).

***

# 2. Классы-помощники (Helpers)

## 2.1. Класс WaitFor

***WaitFor*** - класс для настройки и выполнения явных ожиданий событий.
Содержит статические методы для установки ожиданий.

Шаги:

1. Создать пакет Java **helpers** в папке **./src/test/java**.

![New Maven Project - helpers](./_Files/2.%20New%20Project/02.jpg "New Project - helpers")

2. Создать файл **WaitFor.java** в **./src/test/java/helpers**.

![New Maven Project - WaitFor.java](./_Files/2.%20New%20Project/03.jpg "New Project - WaitFor.java")

3. Добавить в файл **WaitFor.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(WaitFor.class);
```

* объявление ожидания драйвера браузера

```java
// Ожидание драйвера браузера
protected static WebDriverWait wait;
```

* метод **initWait** - инициализация ожидания драйвера браузера

```java
// Инициализация ожидания драйвера браузера
// Установка таймаута ожидания и интервала опроса
public static void initWait(WebDriver driver, Duration timeOut, Duration sleep) {
    wait = new WebDriverWait(driver, timeOut, sleep);
}
```

* метод **presenceOfElementLocated** - ожидание наличия элемента по локатору

```java
// Ожидание наличия элемента по локатору
public static void presenceOfElementLocated(By webElement) {
    wait.until(ExpectedConditions.presenceOfElementLocated(webElement));
}
```

* метод **presenceOfTextInElement** - ожидание появления текста в элементе

```java
// Ожидание появления текста в элементе
public static void presenceOfTextInElement(WebElement webElement, String text) {
    wait.until(ExpectedConditions.textToBePresentInElement(webElement, text));
}
```

* метод **clickabilityOfElement** - ожидание кликабельности элемента

```java
// Ожидание кликабельности элемента
public static void clickabilityOfElement(WebElement webElement) {
    wait.until(ExpectedConditions.elementToBeClickable(webElement));
}
```    

* метод **clickabilityOfElementLocated** - ожидание кликабельности элемента по локатору

```java
// Ожидание кликабельности элемента по локатору
public static void clickabilityOfElementLocated(By webElement) {
    wait.until(ExpectedConditions.elementToBeClickable(webElement));
}
```

* метод **visibilityOfElement** - ожидание видимости элемента

```java
// Ожидание видимости элемента
public static void visibilityOfElement(WebElement webElement) {
    wait.until(ExpectedConditions.visibilityOf(webElement));
}
```

* метод **visibilityOfElementLocated** - ожидание видимости элемента по локатору

 ```java
// Ожидание видимости элемента по локатору
public static void visibilityOfElementLocated(By webElement) {
    wait.until(ExpectedConditions.visibilityOfElementLocated(webElement));
}
```

* метод **firstProductMustBe** - ожидание появления в списке продуктов в первой позиции заданного продукта

 ```java
// Ожидание появления в списке продуктов в первой позиции заданного продукта
public static void firstProductMustBe(By webElement, String product) {
    wait.until((ExpectedCondition<Boolean>) webDriver ->
        webDriver.findElement(webElement).getText().contains(product));
}
```

## 2.2. Полный код WaitFor.java

[WaitFor.java]()

## 2.3. Класс JSExec

***JSExec*** - класс для выполнения скриптов на **JavaScript**.
Содержит статические методы для выполнения скриптов, решающих задачи, 
которые нельзя решить стандартными возможностями **Selenium WebDriver**.

Шаги:

1. Создать файл **JSExec.java** в **./src/test/java/helpers**.

![New Maven Project - JSExec.java](./_Files/2.%20New%20Project/04.jpg "New Project - JSExec.java")

2. Добавить в файл **JSExec.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(JSExec.class);
```

* объявление исполнителя JS скриптов **JavascriptExecutor**

```java
// Исполнитель JS скриптов
protected static JavascriptExecutor js;
```

* метод **initWait** - инициализация исполнителя JS скриптов

```java
// Инициализация исполнителя JS скриптов
public static void initJS(WebDriver driver) {
    js = (JavascriptExecutor) driver;
}
```

* метод **scrollBy** - скролл страницы на заданное расстояние в пикселях по X и по Y

```java
// Скролл страницы на заданное расстояние в пикселях по X и по Y
public static void scrollBy(int x, int y) {
    String script = "window.scrollBy(" + x + "," + y + ");";
    js.executeScript(script);
}
```

* метод **displayNone** - установка невидимости веб элемента

```java
// Установка невидимости веб элемента
public static void displayNone(WebElement element) {
    String script = "arguments[0].style.display='none';";
    js.executeScript(script, element);
}
```

## 2.4. Полный код JSExec.java

[JSExec.java]()

***

# 3. Тесты

## 3.1. Класс BaseTest 

***BaseTest*** - базовый класс для всех классов с тестами.
Содержит ссылку на экземпляр драйвера и общие для всех тестов методы, которые выполняются до и после каждого теста.

От данного класса наследуются все классы с тестами.

Шаги:

1. Создать пакет Java **tests** в папке **./src/test/java**.

![New Maven Project - tests](./_Files/2.%20New%20Project/05.jpg "New Project - tests")

2. Создать файл **BaseTest.java** в **./src/test/java/tests**.

![New Maven Project - BaseTest.java](./_Files/2.%20New%20Project/06.jpg "New Project - BaseTest.java")

3. Добавить в файл **BaseTest.java** код.

* объявление драйвера

```java
// Драйвер браузера
protected static WebDriver driver;
```

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(BaseTest.class);
```

* **setUp** - действия перед каждым тестом (аннотация **@BeforeEach**)

В данном уроке пока не будем применять паттерн **Фабрика (Factory Method)**.
Покажем в следующей практике плюсы от применения фабрик.

```java
// Перед каждым тестом
@BeforeEach
public void setUp() {
    // Получаем параметр запуска тестов через Maven -Dbrowser
    String browser = System
        .getProperty("browser", "chrome")
        .toLowerCase();
    // Получаем экземпляр драйвера браузера
    // Настройка исполняемого файла драйвера
    WebDriverManager.chromedriver().setup();
    // Опции драйвера:
    ChromeOptions options = new ChromeOptions();
    // - поведение при появлении алертов "Игнорирование"
    options.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.IGNORE);
    // - стратегия загрузки страницы "NORMAL"
    options.setCapability(CapabilityType.PAGE_LOAD_STRATEGY, PageLoadStrategy.NORMAL);
    // - режим "Инкогнито"
    options.addArguments("--incognito");
    // - режим "Полный экран"
    options.addArguments("--start-fullscreen");
    driver = new ChromeDriver(options);
    logger.info("Драйвер стартовал!");
}
```

* **setDown** - действия после каждого теста (аннотация **@AfterEach**)

```java
// После каждого теста
@AfterEach
public void setDown() {
    // Если драйвер еще существует
    if(driver != null) {
        // Закрываем его
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 3.2. Полный код BaseTest.java

[BaseTest.java]()

***

# 4. Паттерн Объект страницы / Объектная модель страницы (Page Object / Page Object Model (POM))

## 4.1. Класс Base Page (Базовый объект страниц)

***Base Page*** - базовый класс для всех страниц.
Содержит ссылку на экземпляр драйвера и базовый конструктор.
В базовый конструктор передается ссылка на экземпляр драйвера.  
В базовом конструкторе инициализируются явное ожидание и исполнитель JS скриптов.

От данного класса наследуются все классы моделирующие конкретные страницы.

Шаги:

1. Создать пакет Java **pages** в папке **./src/test/java**.

![New Maven Project - pages](./_Files/2.%20New%20Project/07.jpg "New Project - pages")

2. Создать файл **BasePage.java** в **./src/test/java/pages**.

![New Maven Project - BasePage.java](./_Files/2.%20New%20Project/08.jpg "New Project - BasePage.java")

3. Добавить в файл **BasePage.java** код.

* объявление драйвера

```java
// Драйвер браузера
protected static WebDriver driver;
```

* конструктор базового класса

```java
// Конструктор базового класса 
public BasePage(WebDriver driver) {
    BasePage.driver = driver;
    // Инициализация ожидания - 10 секунд
    WaitFor.initWait(driver, Duration.ofSeconds(10), Duration.ofMillis(100));
    // Инициализация исполнителя JS скриптов
    JSExec.initJS(driver);
}
```

## 4.2. Полный код BasePage.java

[BasePage.java]()

## 4.3. Класс StartPage (Стартовая страница)

***StartPage*** - класс моделирующий объекты **Стартовой страницы** сайта [dns-shop.ru](https://www.dns-shop.ru/).

Класс **StartPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **StartPage.java** в **./src/test/java/pages**.

![New Maven Project - StartPage.java](./_Files/2.%20New%20Project/09.jpg "New Project - StartPage.java")

2. Добавить в файл **StartPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(StartPage.class);
```

* объявление константы хранящей URL **Стартовой страницы** сайта [DNS](https://www.dns-shop.ru/)

```java
// URL страницы
private final String URL = "https://www.dns-shop.ru/";
```

* объявление списка локаторов веб элементов

```java
// ***** Локаторы *****
// Кнопка "Да" на всплывашке
String linkYesXpath = "//a[contains(text(),\"Да\")]";
// Ссылка "Смартфоны и гаджеты"
String linkSmartsAndGadgetsXpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[1]";
// Ссылка "Смартфоны"
String linkSmartsXpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[2]/following::div/a";
```

* конструктор класса

```java
// Конструктор класса
public StartPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* метод **getURL** - получение URL страницы

```java
// Получение URL страницы
public String getURL() {
    return this.URL;
}
```

* метод **openPage** - открытие страницы

```java
// Открытие страницы
public void openPage() {
    driver.get(this.URL);
    logger.info("Открыта страница https://www.dns-shop.ru/");
}
```

* метод **linkYesClick** - нажатие на кнопку **Да**

```java
// Нажатие на кнопку "Да"
public void linkYesClick() {
    WaitFor.presenceOfElementLocated(By.xpath(linkYesXpath));
    WebElement linkYes = driver.findElement(By.xpath(linkYesXpath));
    WaitFor.clickabilityOfElement(linkYes);
    linkYes.click();
    logger.info("Нажата кнопка \"Да\"");
}
```

* метод **linkSmartsAndGadgetsMove** - наведение курсора мыши на ссылку **Смартфоны и гаджеты**

```java
// Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
public void linkSmartsAndGadgetsMove() {
    WaitFor.presenceOfElementLocated(By.xpath(linkSmartsAndGadgetsXpath));
    WebElement linkSmartsAndGadgets = driver.findElement(By.xpath(linkSmartsAndGadgetsXpath));
    Actions actions = new Actions(driver);
    actions.moveToElement(linkSmartsAndGadgets).perform();
        logger.info("Курсор мыши наведен на ссылку \"Смартфоны\"");
}
```

* метод **linkSmartsClick** - нажатие на ссылку **Смартфоны**

```java
// Нажатие на ссылку "Смартфоны"
public void linkSmartsClick() {
    WaitFor.visibilityOfElementLocated(By.xpath(linkSmartsXpath));
    WebElement linkSmarts = driver.findElement(By.xpath(linkSmartsXpath));
    WaitFor.clickabilityOfElement(linkSmarts);
    linkSmarts.click();
    logger.info("Нажата ссылка \"Смартфоны\"");
}
```

## 4.4. Полный код StartPage.java

[StartPage.java]()

## 4.5. Класс SmartphonesPage

***SmartphonesPage*** - класс моделирующий объекты страницы **Смартфоны**.

Класс **SmartphonesPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphonesPage.java** в **./src/test/java/pages**.

![New Maven Project - SmartphonesPage.java](./_Files/2.%20New%20Project/10.jpg "New Project - SmartphonesPage.java")

2. Добавить в файл **SmartphonesPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphonesPage.class);
```

* конструктор класса

```java
// Конструктор класса
public SmartphonesPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* объявление списка локаторов веб элементов

```java
// ***** Локаторы *****
// Шапка
String mainBlockXpath = "//header";
// Фильтры
// - Фильтр "Производитель"
String chbxCompanyXpath = "//span[contains(text(), \"company\")]";
// - Фильтр "Объем оперативной памяти"
String showRAMXpath = "//div[@class=\"ui-list-controls ui-collapse ui-collapse_list\"]//span[contains(text(), \"Объем оперативной памяти\")]";
String chbxRAMXpath = "//span[contains(text(), \"ram\")]";
// Кнопка Применить
String btnApplyXpath = "//button[contains(text(), \"Применить\")]";
// Сортировка
// - Выпадашка "Сортировка"        
String showSortXpath = "//span[contains(text(), \"Сортировка:\")]/following::a";
// - Переключатель "Сначала дорогие"
String rbtnExpensiveXpath = "//span[contains(text(), \"Сначала дорогие\")]";
// Смартфоны
// - Ссылка на первый продукт в списке
String linkFirstProductXpath = "(//a[contains(@class, \"catalog-product__name\")])[1]";
```

* метод **hideHeader** - скрытие шапки

```java
// Скрытие шапки
public void hideHeader() {
    WebElement header = driver.findElement(By.xpath(headerXpath));
    JSExec.displayNone(header);
}
```

* метод **showSortClick** - нажатие на выпадашку **Сортировка**

```java
// Нажатие на выпадашку "Сортировка"
public void showSortClick() {
    WaitFor.visibilityOfElementLocated(By.xpath(showSortXpath));
    WebElement showSort = driver.findElement(By.xpath(showSortXpath));
    WaitFor.clickabilityOfElement(showSort);
    showSort.click();
    logger.info("Нажата выпадашка \"Сортировка\"");
}
```

* метод **rbtnExpensiveClick** - установка сортировки **Сначала дорогие**

```java
// Установка сортировки "Сначала дорогие"
public void rbtnExpensiveClick() {
    WaitFor.visibilityOfElementLocated(By.xpath(rbtnExpensiveXpath));
    WebElement rbtnExpensive = driver.findElement(By.xpath(rbtnExpensiveXpath));
    WaitFor.clickabilityOfElement(rbtnExpensive);
    rbtnExpensive.click();
    logger.info("Установлена сортировка - \"Сначала дорогие\"");
}
```

* метод **chbxProductClick** - установка фильтра **Производитель**

```java
// Установка фильтра "Производитель"
public void chbxProductClick(String company) {
    chbxCompanyXpath = chbxCompanyXpath.replace("company", company);
    WaitFor.visibilityOfElementLocated(By.xpath(chbxCompanyXpath));
    WebElement chbxCompany = driver.findElement(By.xpath(chbxCompanyXpath));
    WaitFor.clickabilityOfElement(chbxCompany);
    chbxCompany.click();
    logger.info("Установлен фильтр \"Производитель\" - " + company);
}
```

* метод **showRAMClick** - нажатие на гармошку **Объем оперативной памяти**

```java
// Нажатие на гармошку "Объем оперативной памяти"
public void showRAMClick() {
    WaitFor.visibilityOfElementLocated(By.xpath(showRAMXpath));
    WebElement showRAM = driver.findElement(By.xpath(showRAMXpath));
    WaitFor.clickabilityOfElement(showRAM);
    showRAM.click();
    logger.info("Отображены значения фильтра \"Объем оперативной памяти\"");
}
```

* метод **chbxRAMClick** - установка фильтра **Объем оперативной памяти**

```java
// Установка фильтра "Объем оперативной памяти"
public void chbxRAMClick(String ram) {
    chbxRAMXpath = chbxRAMXpath.replace("ram", ram);
    WaitFor.visibilityOfElementLocated(By.xpath(chbxRAMXpath));
    WebElement chbxRAM = driver.findElement(By.xpath(chbxRAMXpath));
    WaitFor.clickabilityOfElement(chbxRAM);
    chbxRAM.click();
    logger.info("Установлен фильтр \"Объем оперативной памяти\" - " + ram);
}
```

* метод **btnApplyClick** - нажатие на кнопку **Применить**

```java
// Нажатие на кнопку "Применить"
public void btnApplyClick() {
    WaitFor.visibilityOfElementLocated(By.xpath(btnApplyXpath));
    WebElement btnApply = driver.findElement(By.xpath(btnApplyXpath));
    WaitFor.clickabilityOfElement(btnApply);
    btnApply.click();
    logger.info("Нажата кнопка \"Применить\"");
}
```

* метод **linkProductClick** - нажатие на ссылку первого продукта в списке

```java
// Нажатие на ссылку первого продукта в списке
public void linkProductClick(String product) {
    WaitFor.firstProductMustBe(By.xpath(linkFirstProductXpath), product);
    WebElement linkProduct = driver.findElement(By.xpath(linkFirstProductXpath));
    String URL = linkProduct.getAttribute("href");
    driver.switchTo().newWindow(WindowType.WINDOW);
    driver.manage().window().maximize();
    driver.navigate().to(URL);
    logger.info("Нажата ссылка первого продукта в списке");
}
```

## 4.6. Полный код SmartphonesPage.java

[SmartphonesPage.java]()

## 4.7. Класс SmartphoneProductPage (Страница "Продукт. Смартфон")

***SmartphoneProductPage*** - класс моделирующий объекты страницы **Продукт. Смартфон**.

Класс **SmartphoneProductPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphoneProductPage.java** в **./src/test/java/pages**.

![New Maven Project - SmartphoneProductPage.java](./_Files/2.%20New%20Project/11.jpg "New Project - SmartphoneProductPage.java")

2. Добавить в файл **SmartphoneProductPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphoneProductPage.class);
```

* конструктор класса

```java
// Конструктор класса
public SmartphoneProductPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* метод **getPageTitle** - получение заголовка текущей страницы

```java
// Получение заголовка текущей страницы
public String getPageTitle() {
    String title = driver.getTitle();
    logger.info("Заголовок страницы: " + title);
    return title;
}
```

## 4.8. Полный код SmartphoneProductPage.java

[SmartphoneProductPage.java]()

## 4.9. Класс SmartphonesProductPage1_Test

***SmartphonesProductPage1_Test*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**.
с применением паттерна **Page Object Model**

Класс **SmartphonesProductPage1_Test** расширяет класс **BaseTest**.

Шаги:

1. Создать пакет Java **smartphones** в папке **./src/test/java/tests**.

![New Maven Project - smartphones](./_Files/2.%20New%20Project/12.jpg "New Project - smartphones")

2. Создать файл **SmartphonesProductPage1_Test.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphonesProductPage1_Test.java](./_Files/2.%20New%20Project/13.jpg "New Project - SmartphonesProductPage1_Test.java")

3. Добавить в файл **SmartphonesProductPage1_Test.java** код.

* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест 

```java
@Test
// Проверка 
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");

    // ***** Стартовая страница сайта DNS *****
    StartPage startPage = new StartPage(driver);
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Нажатие на выпадашку "Сортировка"
    smartphonesPage.showSortClick();
    // Установка сортировки "Сначала дорогие"
    smartphonesPage.rbtnExpensiveClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Производитель"
    String product = "Samsung"; // производитель
    smartphonesPage.chbxProductClick(product);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на гармошку "Объем оперативной памяти"
    smartphonesPage.showRAMClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Объем оперативной памяти"
    String ram = "8 Гб"; // объем ОП
    smartphonesPage.chbxRAMClick(ram);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на кнопку "Применить"
    smartphonesPage.btnApplyClick();
    // Прокрутка страницы вверх
    JSExec.scrollBy(0, -500);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый");
    SmartphoneProductPage smartphoneProductPage = new SmartphoneProductPage(driver);
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.7\" Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Z Flip3 | 4845670";
    String actual = smartphoneProductPage.getPageTitle();
    Assertions.assertEquals(expected, actual);
}
```

## 4.10. Полный код SmartphoneProductPage.java

[SmartphoneProductPage.java]()

## 4.11. Запуск автотеста

Шаги:

1. Запустить тест командой **mvn clean test** с параметрами **-Dtest=SmartphonesProductPage1_Test**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/14.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/15.jpg "New Maven Project - Лог запуска")

***

# 5. Паттерн Подготовка, Действие, Проверка (Arrange Act Assert)

## 5.1. Класс SmartphonesProductPage2_Test

***SmartphonesProductPage2_Test*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**
с применением паттернов:

* **Page Object Model**
* **Arrange Act Assert**

Класс **SmartphonesProductPage2_Test** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **SmartphonesProductPage2_Test.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphonesProductPage2_Test.java](./_Files/2.%20New%20Project/16.jpg "New Project - SmartphonesProductPage2_Test.java")

2. Добавить в файл **SmartphonesProductPage2_Test.java** код.

* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест

Код метода из файла **SmartphonesProductPage1_Test.java**.

```java
@Test
// Проверка 
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");

    // ***** Стартовая страница сайта DNS *****
    StartPage startPage = new StartPage(driver);
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Нажатие на выпадашку "Сортировка"
    smartphonesPage.showSortClick();
    // Установка сортировки "Сначала дорогие"
    smartphonesPage.rbtnExpensiveClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Производитель"
    String product = "Samsung"; // производитель
    smartphonesPage.chbxProductClick(product);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на гармошку "Объем оперативной памяти"
    smartphonesPage.showRAMClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Объем оперативной памяти"
    String ram = "8 Гб"; // объем ОП
    smartphonesPage.chbxRAMClick(ram);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на кнопку "Применить"
    smartphonesPage.btnApplyClick();
    // Прокрутка страницы вверх
    JSExec.scrollBy(0, -500);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый");
    SmartphoneProductPage smartphoneProductPage = new SmartphoneProductPage(driver);
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.7\" Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Z Flip3 | 4845670";
    String actual = smartphoneProductPage.getPageTitle();
    Assertions.assertEquals(expected, actual);
}
```

## 5.2. Секции Arrange Act Assert

Шаги:

1. Открыть файл **SmartphonesProductPage2_Test.java** в **./src/test/java/tests/smartphones**.

2. Отредактировать код разделив его на секции в соответствии с паттерном **Arrange Act Assert**. 
   
* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест

```java
@Test
// Проверка 
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // 1. Arrange
    String product = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");
        
    // ***** Стартовая страница сайта DNS *****
    StartPage startPage = new StartPage(driver);
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Нажатие на выпадашку "Сортировка"
    smartphonesPage.showSortClick();
    // Установка сортировки "Сначала дорогие"
    smartphonesPage.rbtnExpensiveClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Производитель"
    smartphonesPage.chbxProductClick(product);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на гармошку "Объем оперативной памяти"
    smartphonesPage.showRAMClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.chbxRAMClick(ram);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на кнопку "Применить"
    smartphonesPage.btnApplyClick();
    // Прокрутка страницы вверх
    JSExec.scrollBy(0, -500);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkProductClick("Смартфон Samsung Galaxy Note 20 Ultra 256 ГБ белый");
    SmartphoneProductPage smartphoneProductPage = new SmartphoneProductPage(driver);
    String actual = smartphoneProductPage.getPageTitle();
    
    // 3. Assert
    String expected = "Купить 6.7\" Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Z Flip3 | 4845670";
    Assertions.assertEquals(expected, actual);
}
```

3. Выделить действия секции **Act** в отдельный метод **getProductPage**.

* метод **getProductPage** - получение страницы с продуктом

```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPage getProductPage(String product, String ram) {
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");
    // ***** Стартовая страница сайта DNS *****
    StartPage startPage = new StartPage(driver);
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Нажатие на выпадашку "Сортировка"
    smartphonesPage.showSortClick();
    // Установка сортировки "Сначала дорогие"
    smartphonesPage.rbtnExpensiveClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Производитель"
    smartphonesPage.chbxProductClick(product);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на гармошку "Объем оперативной памяти"
    smartphonesPage.showRAMClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.chbxRAMClick(ram);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на кнопку "Применить"
    smartphonesPage.btnApplyClick();
    // Прокрутка страницы вверх
    JSExec.scrollBy(0, -500);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый");
    return new SmartphoneProductPage(driver);
}
```

* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест

```java
@Test
// Проверка
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // 1. Arrange
    String product = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPage smartphoneProductPage = getProductPage(product, ram);
    String actual = smartphoneProductPage.getPageTitle();

    // 3. Assert
    String expected = "Купить 6.7\" Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Z Flip3 | 4845670";
    Assertions.assertEquals(expected, actual);
}
```

## 5.3. Полный код SmartphonesProductPage2_Test.java

[SmartphonesProductPage2_Test.java]()

## 5.4. Запуск автотеста

Шаги:

1. Запустить тест командой **mvn clean test** с параметром **-Dtest=SmartphonesProductPage2_Test**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/17.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/18.jpg "New Maven Project - Лог запуска")

***

# 6. Паттерн Матчеры (Assert Objects / Matchers)

## 6.1. Класс SmartphonesProductPage3_Test

***SmartphonesProductPage3_Test*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**
с применением паттернов:

* **Page Object Model**
* **Arrange Act Assert** 
* **Assert Objects / Matchers**

Класс **SmartphonesProductPage3_Test** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **SmartphonesProductPage3_Test.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphonesProductPage3_Test.java](./_Files/2.%20New%20Project/19.jpg "New Project - SmartphonesProductPage3_Test.java")

2. Добавить в файл **SmartphonesProductPage3_Test.java** код.

* метод **getProductPage** - получение страницы с продуктом

Код метода из файла **SmartphonesProductPage2_Test.java**.

```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPage getProductPage(String product, String ram) {
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");
    // ***** Стартовая страница сайта DNS *****
    StartPage startPage = new StartPage(driver);
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Нажатие на выпадашку "Сортировка"
    smartphonesPage.showSortClick();
    // Установка сортировки "Сначала дорогие"
    smartphonesPage.rbtnExpensiveClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Производитель"
    smartphonesPage.chbxProductClick(product);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на гармошку "Объем оперативной памяти"
    smartphonesPage.showRAMClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.chbxRAMClick(ram);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на кнопку "Применить"
    smartphonesPage.btnApplyClick();
    // Прокрутка страницы вверх
    JSExec.scrollBy(0, -500);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый");
    return new SmartphoneProductPage(driver);
}
```

* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест

Код метода из файла **SmartphonesProductPage2_Test.java**.

```java
@Test
// Проверка
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // 1. Arrange
    String product = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPage smartphoneProductPage = getProductPage(product, ram);
    String actual = smartphoneProductPage.getPageTitle();

    // 3. Assert
    String expected = "Купить 6.7\" Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Z Flip3 | 4845670";
    Assertions.assertEquals(expected, actual);
}
```

## 6.2. Класс SmartphoneProductPageAssert

***SmartphoneProductPageAssert*** - класс матчер.

Шаги:

1. Создать файл **SmartphoneProductPageAssert.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphonesAssert.java](./_Files/2.%20New%20Project/20.jpg "New Project - SmartphoneProductPageAssert.java")

2. Добавить в файл **SmartphoneProductPageAssert.java** код.

* объявление ссылки на страницу с продуктом 

```java
// Страница "Продукт. Смартфон"
SmartphoneProductPage page;
```

* конструктор

```java
// Конструктор
public SmartphoneProductPageAssert(SmartphoneProductPage page) {
    this.page = page;
}
```

* метод **pageTitleEquals** - проверка (матчер) соответствия заголовка страницы

```java
// Проверка / Утверждение (Матчер)
public void pageTitleEquals(String expected) {
    String actual = page.getPageTitle();
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

3. Открыть файл **SmartphonesProductPage3_Test.java** в **./src/test/java/tests/smartphones**.

4. Отредактировать код использовав матчер для проверки в соответствии с паттерном **Assert Objects / Matchers**.

* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест

```java
@Test
// Проверка
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // 1. Arrange
    String product = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPage smartphoneProductPage = getProductPage(product, ram);

    // 3. Assert
    String expected = "Купить 6.9\" Смартфон Samsung Galaxy Note 20 Ultra 256 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Note 20 Ultra | 1685908";
    SmartphoneProductPageAssert smartphoneProductAssert = new SmartphoneProductPageAssert(smartphoneProductPage);
    smartphoneProductAssert.pageTitleEquals(expected);
}
```

## 6.3. Полный код SmartphoneProductPageAssert.java

[SmartphoneProductPageAssert.java]()

## 6.4. Полный код SmartphonesProductPage3_Test.java

[SmartphonesProductPage3_Test.java]()

## 6.5. Запуск теста

Шаги:

1. Запустить тест командой **mvn clean test** с параметром **-Dtest=SmartphonesProductPage3_Test**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/21.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/22.jpg "New Maven Project - Лог запуска")

***

# 7. Паттерн Элементы страницы (Page Elements)

## 7.1. Класс BaseElement

***BaseElement*** - базовый класс для всех элементов интерфейса страниц.
Содержит ссылку на экземпляр **WebElement** и базовый конструктор.
В базовый конструктор передается ссылка на экземпляр драйвера, выполняется поиск элемента.  

От данного класса наследуются все классы моделирующие конкретные типы элементов интерфейса страницы.

Шаги:

1. Создать пакет Java **elements** в папке **./src/test/java**.

![New Maven Project - elements](./_Files/2.%20New%20Project/23.jpg "New Project - elements")

2. Создать файл **BaseElement.java** в **./src/test/java/elements**.

![New Maven Project - BaseElement.java](./_Files/2.%20New%20Project/24.jpg "New Project - BaseElement.java")

3. Добавить в файл **BaseElement.java** код.

* объявление ссылки на экземпляр **WebElement**

```java
// Элемент страницы
protected WebElement webElement;
```

* конструктор базового класса

```java
// Конструктор базового класса 
public BaseElement(WebDriver driver, By by) {
    // Ожидание появления элемента перед поиском элемента
    WaitFor.initWait(driver, Duration.ofMillis(3000), Duration.ofMillis(300));
    WaitFor.presenceOfElementLocated(by);
    // Поиск элемента
    webElement = driver.findElement(by);
}
```

* метод **getWebElement** - получение оборачиваемого экземпляра класса **WebElement**

```java
// Получение оборачиваемого элемента
// Получив оборачиваемый элемент, можно вызвать его методы
// Например, getText()
public WebElement getWebElement() {
    return webElement;
}
```

## 7.2. Полный код BaseElement.java

[BaseElement.java]()

## 7.3. Класс Button

***Button*** - класс моделирующий элемент интерфейса **Кнопка**.

Класс **Button** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Button.java** в **./src/test/java/elements**.

![New Maven Project - Button.java](./_Files/2.%20New%20Project/25.jpg "New Project - Button.java")

2. Добавить в файл **Button.java** код.

* конструктор класса

```java
// Конструктор
public Button(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **click** - нажатие на кнопку

```java
// Нажатие на кнопку
public void click() {
    WaitFor.visibilityOfElementLocated(by);
    WaitFor.clickabilityOfElement(webElement);
    webElement.click();
}
```

## 7.4. Полный код Button.java

[Button.java]()

## 7.5. Класс TextBox

***TextBox*** - класс моделирующий элемент интерфейса **Текстовое поле ввода**.

Класс **TextBox** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **TextBox.java** в **./src/test/java/elements**.

![New Maven Project - TextBox.java](./_Files/2.%20New%20Project/26.jpg "New Project - TextBox.java")

2. Добавить в файл **TextBox.java** код.

* конструктор класса

```java
// Конструктор
public TextBox(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **click** - нажатие на текстовое поле ввода

```java
// Нажатие на текстовое поле ввода
public void click() {
    WaitFor.visibilityOfElementLocated(by);
    WaitFor.clickabilityOfElement(webElement);
    webElement.click();
}
```

* метод **setValue** - ввод значения в текстовое поле ввода

```java
// Ввод значения в текстовое поле ввода
public void setValue(String value) {
    WaitFor.visibilityOfElementLocated(by);
    webElement.sendKeys(value);
}
```

## 7.6. Полный код TextBox.java

[TextBox.java]()

## 7.7. Класс CheckBox

***CheckBox*** - класс моделирующий элемент интерфейса **Флажок**.

Класс **CheckBox** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **CheckBox.java** в **./src/test/java/elements**.

![New Maven Project - CheckBox.java](./_Files/2.%20New%20Project/27.jpg "New Project - CheckBox.java")

2. Добавить в файл **CheckBox.java** код.

* конструктор класса

```java
// Конструктор
public CheckBox(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **setChecked** - установка флажка

```java
// Установка флажка
public void setChecked(boolean value) {
    if (value != isChecked()) {
        WaitFor.clickabilityOfElement(webElement);
        webElement.click();
    }
}
```

* метод **isChecked** - проверка, что флажок установлен

```java
// Проверка, что флажок установлен
public boolean isChecked() {
    WaitFor.visibilityOfElementLocated(by);
    return webElement.isSelected();
}
```

## 7.8. Полный код CheckBox.java

[CheckBox.java]()

## 7.9. Класс RadioButton

***RadioButton*** - класс моделирующий элемент интерфейса **Переключатель**.

Класс **RadioButton** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **RadioButton.java** в **./src/test/java/elements**.

![New Maven Project - RadioButton.java](./_Files/2.%20New%20Project/28.jpg "New Project - RadioButton.java")

2. Добавить в файл **RadioButton.java** код.

* конструктор класса

```java
// Конструктор
public RadioButton(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **setSelected** - установка переключателя

```java
// Установка переключателя
public void setSelected(boolean value) {
    if (value != isSelected()) {
        WaitFor.clickabilityOfElement(webElement);
        webElement.click();
    }
}
```

* метод **isSelected** - проверка, что переключатель установлен

```java
// Проверка, что переключатель установлен
public boolean isSelected() {
    WaitFor.visibilityOfElementLocated(by);
    return webElement.isSelected();
}
```

## 7.10. Полный код RadioButton.java

[RadioButton.java]()

## 7.11. Класс Link

***Link*** - класс моделирующий элемент интерфейса **Ссылка**.

Класс **Link** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Link.java** в **./src/test/java/elements**.

![New Maven Project - Link.java](./_Files/2.%20New%20Project/29.jpg "New Project - Link.java")

2. Добавить в файл **Link.java** код.

* конструктор класса

```java
// Конструктор
public Link(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **click** - нажатие на ссылку

```java
// Нажатие на ссылку
public void click() {
    WaitFor.visibilityOfElementLocated(by);
    WaitFor.clickabilityOfElement(webElement);
    webElement.click();
}
```

* метод **focusOnLink** - наведение курсора мыши на ссылку

```java
// Наведение курсора мыши на ссылку 
public void focusOnLink() {
    WaitFor.visibilityOfElementLocated(by);
    Actions actions = new Actions(driver);
    actions.moveToElement(webElement).perform();
}
```

* метод **openInNewWindow** - открытие ссылки в новом окне

```java
// Открытие ссылки в новом окне
public void openInNewWindow() {
    String URL = this.getURL();
    driver.switchTo().newWindow(WindowType.WINDOW);
    driver.manage().window().maximize();
    driver.navigate().to(URL);
}
```

* метод **getURL** - получение URL ссылки

```java
// Получение URL ссылки
public String getURL() {
    return webElement.getAttribute("href");
}
```

* метод **getText** - получение текста ссылки

```java
// Получение текста ссылки
public String getText() {
    WaitFor.visibilityOfElementLocated(by);
    return webElement.getText();
}
```

## 7.12. Полный код Link.java

[Link.java]()

## 7.13. Класс Accordeon

***Accordeon*** - класс моделирующий элемент интерфейса **Гармошка**.

Класс **Accordeon** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Accordeon.java** в **./src/test/java/elements**.

![New Maven Project - Accordeon.java](./_Files/2.%20New%20Project/30.jpg "New Project - Accordeon.java")

2. Добавить в файл **Accordeon.java** код.

* конструктор класса

```java
// Конструктор
public Accordeon(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **show** - раскрытие гармошки

```java
// Раскрытие гармошки
public void show() {
    WaitFor.visibilityOfElementLocated(by);
    WaitFor.clickabilityOfElement(webElement);    
    webElement.click();
}
```

## 7.14. Полный код Accordeon.java

[Accordeon.java]()

## 7.15. Класс MainBlock

***MainBlock*** - класс моделирующий элемент интерфейса **Главный блок**.

Класс **MainBlock** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **MainBlock.java** в **./src/test/java/elements**.

![New Maven Project - MainBlock.java](./_Files/2.%20New%20Project/31.jpg "New Project - MainBlock.java")

2. Добавить в файл **MainBlock.java** код.

* конструктор класса

```java
// Конструктор
public MainBlock(WebDriver driver, By by) {
    super(driver, by);
}
```

* метод **hide** - скрытие блока

```java
// Скрытие блока
public void hide() {
    WaitFor.visibilityOfElementLocated(by);
    JSExec.displayNone(webElement);
}
```

## 7.16. Полный код MainBlock.java

[MainBlock.java]()

## 7.17. Класс StartPageWithElements

Теперь применим паттерн в наших страницах.
Для того чтобы увидеть разницу, создадим отдельные классы страниц с элементами.

***StartPageWithElements*** - класс моделирующий объекты **Стартовой страницы** сайта [dns-shop.ru](https://www.dns-shop.ru/).

Класс **StartPageWithElements** расширяет класс **BasePage**.

Шаги:

1. Создать файл **StartPage.java** в **./src/test/java/pages**.

![New Maven Project - StartPage.java](./_Files/2.%20New%20Project/32.jpg "New Project - StartPage.java")

2. Добавить в файл **StartPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(StartPage.class);
```

* объявление константы хранящей URL **Стартовой страницы** сайта [DNS](https://www.dns-shop.ru/)

```java
// URL страницы
private final String URL = "https://www.dns-shop.ru/";
```

* объявление списка локаторов веб элементов

```java
// ***** Локаторы *****
// Кнопка "Да" на всплывашке
String linkYesXpath = "//a[contains(text(),\"Да\")]";
// Ссылка "Смартфоны и гаджеты"
String linkSmartsAndGadgetsXpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[1]";
// Ссылка "Смартфоны"
String linkSmartsXpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[2]/following::div/a";
```

* конструктор класса

```java
// Конструктор класса
public StartPageWithElements(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* метод **getURL** - получение URL страницы

```java
// Получение URL страницы
public String getURL() {
    return this.URL;
}
```

* метод **openPage** - открытие страницы

```java
// Открытие страницы
public void openPage() {
    driver.get(this.URL);
    logger.info("Открыта страница https://www.dns-shop.ru/");
}
```

* метод **linkYesClick** - нажатие на кнопку **Да**

```java
// Нажатие на кнопку "Да"
public void linkYesClick() {
    Link linkYes = new Link(driver, By.xpath(linkYesXpath));
    linkYes.click();
    logger.info("Нажата кнопка \"Да\"");
}
```

* метод **linkSmartsAndGadgetsMove** - наведение курсора мыши на ссылку **Смартфоны и гаджеты**

```java
// Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
public void linkSmartsAndGadgetsMove() {
    Link linkSmartsAndGadgets = new Link(driver, By.xpath(linkSmartsAndGadgetsXpath));
    linkSmartsAndGadgets.focusOnLink();
    logger.info("Курсор мыши наведен на ссылку \"Смартфоны\"");
}
```

* метод **linkSmartsClick** - нажатие на ссылку **Смартфоны**

```java
// Нажатие на ссылку "Смартфоны"
public void linkSmartsClick() {
    Link linkSmarts = new Link(driver, By.xpath(linkSmartsXpath));
    linkSmarts.click();
    logger.info("Нажата ссылка \"Смартфоны\"");
}
```

## 7.18. Полный код StartPageWithElements.java

[StartPageWithElements.java]()

## 7.19. Класс SmartphonesPageWithElements

***SmartphonesPageWithElements*** - класс моделирующий объекты страницы **Смартфоны**.

Класс **SmartphonesPageWithElements** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphonesPageWithElements.java** в **./src/test/java/pages**.

![New Maven Project - SmartphonesPageWithElements.java](./_Files/2.%20New%20Project/33.jpg "New Project - SmartphonesPageWithElements.java")

2. Добавить в файл **SmartphonesPageWithElements.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphonesPage.class);
```

* конструктор класса

```java
// Конструктор класса
public SmartphonesPageWithElements(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* объявление списка локаторов веб элементов

```java
// ***** Локаторы *****
// Шапка
String mainBlockXpath = "//header";
// Фильтры
// - Фильтр "Производитель"
String chbxCompanyXpath = "//span[contains(text(), \"company\")]";
// - Фильтр "Объем оперативной памяти"
String accordeonRAMXpath = "//div[@class=\"ui-list-controls ui-collapse ui-collapse_list\"]//span[contains(text(), \"Объем оперативной памяти\")]";
String chbxRAMXpath = "//span[contains(text(), \"ram\")]";
// Кнопка Применить
String btnApplyXpath = "//button[contains(text(), \"Применить\")]";
// Сортировка
// - Выпадашка "Сортировка"        
String accordeonSortXpath = "//span[contains(text(), \"Сортировка:\")]/following::a";
// - Переключатель "Сначала дорогие"
String rbtnExpensiveXpath = "//span[contains(text(), \"Сначала дорогие\")]";
// Смартфоны
// - Ссылка на первый продукт в списке
String linkFirstProductXpath = "(//a[contains(@class, \"catalog-product__name\")])[1]";
```

* метод **mainBlockHide** - скрытие шапки

```java
// Скрытие шапки
public void mainBlockHide() {
    WebElement header = driver.findElement(By.xpath(headerXpath));
    JSExec.displayNone(header);
}
```

* метод **accordeonSortClick** - нажатие на выпадашку **Сортировка**

```java
// Нажатие на выпадашку "Сортировка"
public void accordeonSortClick() {
    Accordeon accordeonSort = new Accordeon(driver, By.xpath(accordeonSortXpath));
    accordeonSort.show();
    logger.info("Нажата выпадашка \"Сортировка\"");
}
```

* метод **rbtnExpensiveClick** - установка сортировки **Сначала дорогие**

```java
// Установка сортировки "Сначала дорогие"
public void rbtnExpensiveClick() {
    RadioButton rbtnExpensive = new RadioButton(driver, By.xpath(rbtnExpensiveXpath));
    rbtnExpensive.setSelected(true);
    logger.info("Установлена сортировка - \"Сначала дорогие\"");
}
```

* метод **chbxProductClick** - установка фильтра **Производитель**

```java
// Установка фильтра "Производитель"
public void chbxCompanyClick(String company) {
    chbxCompanyXpath = chbxCompanyXpath.replace("company", company);
    CheckBox chbxCompany = new CheckBox(driver, By.xpath(chbxCompanyXpath));
    chbxCompany.setChecked(true);
    logger.info("Установлен фильтр \"Производитель\" - " + company);
}
```

* метод **showRAMClick** - нажатие на гармошку **Объем оперативной памяти**

```java
// Нажатие на гармошку "Объем оперативной памяти"
public void accordeonRAMClick() {
    Accordeon accordeonRAM = new Accordeon(driver, By.xpath(accordeonRAMXpath));
    accordeonRAM.show();
    logger.info("Отображены значения фильтра \"Объем оперативной памяти\"");
}
```

* метод **chbxRAMClick** - установка фильтра **Объем оперативной памяти**

```java
// Установка фильтра "Объем оперативной памяти"
public void chbxRAMClick(String ram) {
    chbxRAMXpath = chbxRAMXpath.replace("ram", ram);
    CheckBox chbxRAM = new CheckBox(driver, By.xpath(chbxRAMXpath));
    chbxRAM.setChecked(true);
    logger.info("Установлен фильтр \"Объем оперативной памяти\" - " + ram);
}
```

* метод **btnApplyClick** - нажатие на кнопку **Применить**

```java
// Нажатие на кнопку "Применить"
public void btnApplyClick() {
    Button btnApply = new Button(driver, By.xpath(btnApplyXpath));
    btnApply.click();
    logger.info("Нажата кнопка \"Применить\"");
}
```

* метод **linkProductClick** - нажатие на ссылку первого продукта в списке

```java
// Нажатие на ссылку первого продукта в списке
public void linkFirstProductClick(String product) {
    WaitFor.firstProductMustBe(By.xpath(linkFirstProductXpath), product);
    Link linkProduct = new Link(driver, By.xpath(linkFirstProductXpath));
    linkProduct.openInNewWindow();
    logger.info("Нажата ссылка первого продукта в списке");
}
```

## 7.20. Полный код SmartphonesPageWithElements.java

[SmartphonesPageWithElements.java]()

## 7.21. Класс SmartphonesProductPage4_Test

***SmartphonesProductPage4_Test*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**
с применением паттернов:

* **Page Object Model**
* **Page Elements**
* **Arrange Act Assert**
* **Assert Objects / Matchers**

Класс **SmartphonesProductPage4_Test** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **SmartphonesProductPage3_Test.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphonesProductPage3_Test.java](./_Files/2.%20New%20Project/34.jpg "New Project - SmartphonesProductPage3_Test.java")

2. Добавить в файл **SmartphonesProductPage3_Test.java** код.

* метод **selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite** - тест

```java
@Test
// Проверка
public void selectedProduct_Is_SamsungGalaxyNote20Ultra256GBWhite() {
    // 1. Arrange
    String product = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPage smartphoneProductPage = getProductPage(product, ram);

    // 3. Assert
    String expected = "Купить 6.7\" Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый в интернет магазине DNS. Характеристики, цена Samsung Galaxy Z Flip3 | 4845670";
    SmartphoneProductPageAssert smartphoneProductAssert = new SmartphoneProductPageAssert(smartphoneProductPage);
    smartphoneProductAssert.pageTitleEquals(expected);
}
```

* метод **getProductPage** - получение страницы с продуктом


```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPage getProductPage(String product, String ram) {
    // Открыть страницу https://www.dns-shop.ru/
    driver.get("https://www.dns-shop.ru/");
    // ***** Стартовая страница сайта DNS *****
    StartPageWithElements startPage = new StartPageWithElements(driver);
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPageWithElements smartphonesPage = new SmartphonesPageWithElements(driver);
    // Нажатие на выпадашку "Сортировка"
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    smartphonesPage.rbtnExpensiveClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Производитель"
    smartphonesPage.chbxCompanyClick(product);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на гармошку "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.chbxRAMClick(ram);
    // Прокрутка страницы вниз
    JSExec.scrollBy(0, 300);
    // Нажатие на кнопку "Применить"
    smartphonesPage.btnApplyClick();
    // Прокрутка страницы вверх
    JSExec.scrollBy(0, -500);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkProductClick("Смартфон Samsung Galaxy Z Flip3 256 ГБ бежевый");
    return new SmartphoneProductPage(driver);
    }
```

## 7.22. Полный код SmartphonesProductPage4_Test.java

[SmartphonesProductPage4_Test.java]()

## 7.23. Запуск теста

Шаги:

1. Запустить тест командой **mvn clean test** с параметром **-Dtest=SmartphonesProductPage4_Test**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/35.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/36.jpg "New Maven Project - Лог запуска")

***

# 8. Декораторы (Decorator). Декораторы WebElement 

## 8.1. Паттерн Декоратор (Decorator)

Шаги:

1. Создать пакет Java **smartphones** в папке **./src/test/java/tests**.

![New Maven Project - tests](./_Files/2.%20New%20Project/18.jpg "New Project - tests")

2. Создать файл **SmartphonesProductPage1_Test.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphonesProductPage1_Test.java](./_Files/2.%20New%20Project/19.jpg "New Project - SmartphonesProductPage1_Test.java")

3. Добавить в файл **SmartphonesProductPage1_Test.java** код.

***

Задание [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](3.%20Задание.md)