Java_QA / 10. Паттерны

[![Лекция](https://img.shields.io/badge/-Лекция-ee99ff)](1.%20Лекция.md)
[![Главная](https://img.shields.io/badge/-Главная-aaccee)](README.md)
[![Задание](https://img.shields.io/badge/-Задание-99ffee)](3.%20Задание.md)

***

# Содержание

* [1. Создание и настройка нового проекта](#1-создание-и-настройка-нового-проекта)
  * [1.1. Файл POM](#11-файл-pom)
    * [1.1.1. Раздел <properties>](#111-раздел-properties)
    * [1.1.2. Раздел <dependencies>](#112-раздел-dependencies)
    * [1.1.3. Раздел <build><plugins>](#113-раздел-buildplugins)
  * [1.2. Полный код POM.xml](#12-полный-код-pomxml)
  * [1.3. Файл .gitignore](#13-файл-gitignore)
  * [1.4. Файл log4j2.xml](#14-файл-log4j2xml)
  * [1.5. Полный код log4j2.xml](#15-полный-код-log4j2xml)
  * [1.6. Коммит и пуш проекта](#16-коммит-и-пуш-проекта)
* [2. Классы-помощники (Helpers)](#2-классы-помощники-helpers)
  * [2.1. Класс WaitHelper](#21-класс-waitHelper)
  * [2.2. Полный код WaitHelper.java](#22-полный-код-waithelperjava)
  * [2.3. Класс JavaScriptHelper](#23-класс-javascripthelper)
  * [2.4. Полный код JavaScriptHelper.java](#24-полный-код-javascripthelperjava)
  * [2.5. Класс ActionHelper](#25-класс-actionhelper)
  * [2.6. Полный код ActionHelper.java](#26-полный-код-actionhelperjava)
  * [2.7. Класс NavigationHelper](#27-класс-navigationhelper)
  * [2.8. Полный код NavigationHelper.java](#28-полный-код-navigationhelperjava)
  * [2.9. Класс WindowHelper](#29-класс-windowhelper)
  * [2.10. Полный код WindowHelper.java](#210-полный-код-windowhelperjava)
  * [2.11. Класс SwitchHelper](#211-класс-switchhelper)
  * [2.12. Полный код SwitchHelper.java](#212-полный-код-switchhelperjava)
* [3. Тесты](#3-тесты)
  * [3.1. Класс BaseTest](#31-класс-basetest)
  * [3.2. Полный код BaseTest.java](#32-полный-код-basetestjava)
* [4. Паттерн Объект страницы / Объектная модель страницы (Page Object / Page Object Model (POM))](#4-паттерн-объект-страницы--объектная-модель-страницы-page-object--page-object-model-pom)
  * [4.1. Класс Base Page (Базовый объект страниц)](#41-класс-base-page-базовый-объект-страниц)
  * [4.2. Полный код BasePage.java](#42-полный-код-basepagejava)
  * [4.3. Класс StartPage (Стартовая страница)](#43-класс-startpage-стартовая-страница)
  * [4.4. Полный код StartPage.java](#44-полный-код-startpagejava)
  * [4.5. Класс SmartphonesPage](#45-класс-smartphonespage)
  * [4.6. Полный код SmartphonesPage.java](#46-полный-код-smartphonespagejava)
  * [4.7. Класс SmartphoneProductPage (Страница "Продукт. Смартфон")](#47-класс-smartphoneproductpage-страница-продукт-смартфон)
  * [4.8. Полный код SmartphoneProductPage.java](#48-полный-код-smartphoneproductpagejava)
  * [4.9. Класс Pattern1POMTest](#49-класс-pattern1pomtest)
  * [4.10. Полный код Pattern1POMTest.java](#410-полный-код-pattern1pomtestjava)
  * [4.11. Запуск автотеста](#411-запуск-автотеста)
  * [4.12. Что изменилось и какая польза?](#412-что-изменилось-и-какая-польза)
* [5. Паттерн Объект страницы / Объектная модель страницы (Page Object / Page Object Model (POM)) с PageFactory](#5-паттерн-объект-страницы--объектная-модель-страницы-page-object--page-object-model-pom-с-pagefactory)
  * [5.1. Класс StartPagePF (Стартовая страница)](#51-класс-startpagepf-стартовая-страница)
  * [5.2. Полный код StartPagePF.java](#52-полный-код-startpagepfjava)
  * [5.3. Класс SmartphonesPagePF](#53-класс-smartphonespagepf)
  * [5.4. Полный код SmartphonesPagePF.java](#54-полный-код-smartphonespagepfjava)
  * [5.5. Класс SmartphoneProductPagePF (Страница "Продукт. Смартфон")](#55-класс-smartphoneproductpagepf-страница-продукт-смартфон)
  * [5.6. Полный код SmartphoneProductPagePF.java](#56-полный-код-smartphoneproductpagepfjava)
  * [5.7. Класс Pattern2PageFactoryTest](#57-класс-pattern2pagefactorytest)
  * [5.8. Полный код Pattern2PageFactoryTest.java](#58-полный-код-pattern2pagefactorytestjava)
  * [5.9. Запуск автотеста](#59-запуск-автотеста)
  * [5.10. Что изменилось и какая польза?](#510-что-изменилось-и-какая-польза)
* [6. Паттерн Подготовка, Действие, Проверка (Arrange Act Assert)](#6-паттерн-подготовка-действие-проверка-arrange-act-assert)
  * [6.1. Класс Pattern3AAATest](#61-класс-pattern3aaatest)
  * [6.2. Полный код Pattern3AAATest.java](#62-полный-код-pattern3aaatestjava)
  * [6.3. Запуск автотеста](#63-запуск-автотеста)
  * [6.4. Что изменилось и какая польза?](#64-что-изменилось-и-какая-польза)
* [7. Паттерн Матчеры (Assert Objects / Matchers)](#7-паттерн-матчеры-assert-objects--matchers)
  * [7.1. Класс SmartphoneProductPageMatcher](#71-класс-smartphoneproductpagematcher)
  * [7.2. Полный код SmartphoneProductPageMatcher.java](#72-полный-код-smartphoneproductpagematcherjavat)
  * [7.3. Класс Pattern4AOTest](#73-класс-pattern4aotest)
  * [7.4. Полный код Pattern4AOTest.java](#74-полный-код-pattern4aotestjava)
  * [7.5. Запуск теста](#75-запуск-теста)
  * [7.6. Что изменилось и какая польза?](#76-что-изменилось-и-какая-польза)
* [8. Паттерн Элементы страницы (Page Elements)](#8-паттерн-элементы-страницы-page-elements)
  * [8.1. Класс BaseElement](#81-класс-baseelement)
  * [8.2. Полный код BaseElement.java](#82-полный-код-baseelementjava)
  * [8.3. Класс Button](#83-класс-button)
  * [8.4. Полный код Button.java](#84-полный-код-buttonjava)
  * [8.5. Класс TextBox](#85-класс-textbox)
  * [8.6. Полный код TextBox.java](#86-полный-код-textboxjava)
  * [8.7. Класс CheckBox](#87-класс-checkbox)
  * [8.8. Полный код CheckBox.java](#88-полный-код-checkboxjava)
  * [8.9. Класс RadioButton](#89-класс-radiobutton)
  * [8.10. Полный код RadioButton.java](#810-полный-код-radiobuttonjava)
  * [8.11. Класс Link](#811-класс-link)
  * [8.12. Полный код Link.java](#812-полный-код-linkjava)
  * [8.13. Класс Accordeon](#813-класс-accordeon)
  * [8.14. Полный код Accordeon.java](#814-полный-код-accordeonjava)
  * [8.15. Класс Block](#815-класс-block)
  * [8.16. Полный код Block.java](#816-полный-код-blockjava)
  * [8.17. Класс StartPagePFPE](#817-класс-startpagepfpe)
  * [8.18. Полный код StartPagePFPE.java](#818-полный-код-startpagepfpejava)
  * [8.19. Класс SmartphonesPagePFPE](#819-класс-smartphonespagepfpe)
  * [8.20. Полный код SmartphonesPagePFPE.java](#820-полный-код-smartphonespagepfpejava)
  * [8.21. Класс SmartphoneProductPagePFPE (Страница "Продукт. Смартфон")](#821-класс-smartphoneproductpagepfpe-страница-продукт-смартфон)
  * [8.22. Полный код SmartphoneProductPagePFPE.java](#822-полный-код-smartphoneproductpagepfpejava)
  * [8.23. Класс SmartphoneProductPageMatcherPFPE](#823-класс-smartphoneproductpagematcherpfpe)
  * [8.24. Полный код SmartphoneProductPageMatcherPFPE.java](#824-полный-код-smartphoneproductpagematcherpfpejava)
  * [8.25. Класс Pattern5PETest](#825-класс-pattern5petest)
  * [8.26. Полный код Pattern5PETest.java](#826-полный-код-pattern5petestjava)
  * [8.27. Запуск теста](#827-запуск-теста)
  * [8.28. Что изменилось и какая польза?](#828-что-изменилось-и-какая-польза)

***

# 1. Создание и настройка нового проекта

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

## 1.1. Файл POM

Для начала нужно прописать необходимые зависимости.

![New Maven Project - POM.xml](./_Files/2.%20New%20Project/01.jpg "New Project - POM.xml")

### 1.1.1. Раздел \<properties\>

Раздел **<properties>**:

```xml
<!-- Параметры -->
<properties>
    Добавлять вот сюда
</properties>
```

Шаги:

1. Создать новый проект **Maven** в **IntelliJ IDEA**.

2. Открыть файл **POM.xml**.

3. Добавить в раздел **\<properties\>** кодировку проекта - **UTF-8**

```xml
<!-- Кодировка проекта - UTF-8 -->
<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
<project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
```

4. Добавить в раздел **\<properties\>** версию Java - **15** или на ваше усмотрение

```xml
<!-- Версия Java - 15 -->
<source>15</source>
<target>15</target>
```

5. Добавить в раздел **\<properties\>** версии библиотек / зависимостей (**dependencies**):

* фреймворк тестирования **JUnit**

```xml
<!-- Версии зависимостей: -->
<!-- JUnit -->
<junit-jupiter-engine>5.9.0</junit-jupiter-engine>
```

* драйвер браузера **Selenium WebDriver**

```xml
<!-- Selenium WebDriver -->
<selenium-java>4.5.0</selenium-java>
```

* менеджер драйверов **WebDriver Manager**

```xml
<!-- WebDriver Manager -->
<webdrivermanager>5.3.0</webdrivermanager>
```

* логгер **Log4J**

```xml
<!-- Log4J -->
<log4j-api>2.19.0</log4j-api>
<log4j-core>2.19.0</log4j-core>
```

* скриншотер **aShot**

```xml
<!-- aShot -->
<ashot>1.5.4</ashot>
```

6. Добавить в раздел **\<properties\>** версии плагинов (**plugins**):

```xml
<!-- Версии плагинов: -->
<!-- maven-surefire-plugin -->
<maven-surefire-plugin>2.22.2</maven-surefire-plugin>
<!-- maven-compiler-plugin -->
<maven-compiler-plugin>3.8.1</maven-compiler-plugin>
```

### 1.1.2. Раздел \<dependencies\>

Раздел **<dependencies>**:

```xml
<!-- Зависимости -->
<dependencies>
    Добавлять вот сюда
</dependencies>
```  

Шаги:

1. Открыть файл **POM.xml**.

2. Добавить в раздел **\<dependencies\>** зависимости / библиотеки:

* фреймворк тестирования **JUnit**

```xml
<!-- JUnit -->
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter-engine</artifactId>
    <version>${junit-jupiter-engine}</version>
    <scope>test</scope>
</dependency>
```    

* драйвер браузера **Selenium WebDriver**

```xml
<!-- Selenium WebDriver -->
<dependency>
    <groupId>org.seleniumhq.selenium</groupId>
    <artifactId>selenium-java</artifactId>
    <version>${selenium-java}</version>
    <scope>test</scope>
</dependency>
```

* менеджер драйверов **WebDriver Manager**

```xml
<!-- WebDriver Manager -->
<dependency>
    <groupId>io.github.bonigarcia</groupId>
    <artifactId>webdrivermanager</artifactId>
    <version>${webdrivermanager}</version>
    <scope>test</scope>
</dependency>
```

* логгер **Log4J**

```xml
<!-- Log4J -->
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-api</artifactId>
    <version>${log4j-api}</version>
    <scope>test</scope>
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-core</artifactId>
    <version>${log4j-core}</version>
    <scope>test</scope>
</dependency>
```

* скриншотер **aShot**

```xml
<!-- aShot -->
<dependency>
    <groupId>ru.yandex.qatools.ashot</groupId>
    <artifactId>ashot</artifactId>
    <version>${ashot}</version>
    <scope>test</scope>
</dependency>
```

### 1.1.3. Раздел \<build\>\<plugins\>

Раздел **<build><plugins>**:

```xml
<!-- Сборка -->
<build>
    <!-- Плагины -->
    <plugins>
        Добавлять сюда
    </plugins>
</build>
```

Шаги:

1. Открыть файл **POM.xml**.

2. Добавить в раздел **\<build\>\<plugins\>** плагины:

* плагин для запуска автотестов **maven-surefire-plugin**

```xml
<!-- maven-surefire-plugin -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>${maven-surefire-plugin}</version>
</plugin>
```

* плагин для компиляции **Java** программ **maven-compiler-plugin**

```xml
<!-- maven-compiler-plugin -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>${maven-compiler-plugin}</version>
    <configuration>
        <source>${source}</source>
        <target>${target}</target>
    </configuration>
</plugin>
```

## 1.2. Полный код POM.xml

[POM.xml](_Sample/pom.xml)

## 1.3. Файл .gitignore

Шаги:

1. Создать файл **.gitignore** в корне проекта.

![New Maven Project - log4j2.xml](./_Files/2.%20New%20Project/02.jpg "New Project - .gitignore")

2. Настроить файл.

Использовать онлайн генератор [gitignore.io](https://docs.gitignore.io/).

В репозитории **GitHub** не должно быть:

* файлов *IntelliJ IDEA*
* файлов *VS Code*
* файлов компиляции *Java*

## 1.4. Файл log4j2.xml

Шаги:

1. Создать конфиг файл для логгирования **log4j2.xml** в **./src/main/resources**.

![New Maven Project - log4j2.xml](./_Files/2.%20New%20Project/1.%20Logger/01.jpg "New Project - log4j2.xml")

2. Настроить конфиг файл **log4j2.xml**.

```xml
<Configuration monitorInterval="30">
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%highlight{[%d{HH:mm:ss.SSS}] | %-5p | %-32.42t | %-32.42c{1} | %m%n}{FATAL=red blink, ERROR=red blink, WARN=yellow bold, INFO=black, DEBUG=green bold, TRACE=blue}"/>
        </Console>
        <File name="MyFile" fileName="logs.log">
            <PatternLayout>
                <Pattern>%d %p %c{1.} [%t] %m%n</Pattern>
            </PatternLayout>
        </File>
    </Appenders>
    <Loggers>
        <Root level="info">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="MyFile"/>
        </Root>
    </Loggers>
</Configuration>
```

## 1.5. Полный код log4j2.xml

[log4j2.xml](_Sample/src/main/resources/log4j2.xml)

## 1.6. Коммит и пуш проекта

Шаги:

1. Проверить, что шаги с **1.1.** по **1.5.** выполнены.

2. Закоммитить и запушить проект в удаленный репозиторий (**GitHub**).

***

# 2. Классы-помощники (Helpers)

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать пакет Java **helpers** в папке **./src/test/java**.

В данном пакете будут находиться **.java** файлы для:

* настройки ожиданий 
* выполнения скриптов на JS
* выполнения сложных действий с веб элементами
* навигации по истории браузера
* настройки окна
* переключения на окна, фреймы, модалки и т д

![New Maven Project - helpers](./_Files/2.%20New%20Project/2.%20Helpers/01.jpg "New Project - helpers")

## 2.1. Класс WaitHelper

***WaitHelper*** - класс для настройки и выполнения явных ожиданий событий.
Содержит статические методы для настройки таймингов ожиданий и ожидания появления событий.

Шаги:

1. Создать файл **WaitHelper.java** в **./src/test/java/helpers**.

![New Maven Project - WaitHelper.java](./_Files/2.%20New%20Project/2.%20Helpers/02.jpg "New Project - WaitHelper.java")

2. Добавить в файл **WaitHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(WaitHelper.class);
```

* объявление ожидания драйвера браузера

```java
// Ожидание драйвера браузера
protected static WebDriverWait webDriverWait;
```

* метод **init** - инициализация ожидания драйвера браузера

```java
// Инициализация ожидания драйвера браузера
// Установка таймаута ожидания и интервала опроса
public static void init(WebDriver driver, Duration timeOut, Duration sleep) {
    webDriverWait = new WebDriverWait(driver, timeOut, sleep);
}
```

* метод **presenceOfElementLocated** - ожидание наличия элемента по локатору

```java
// Ожидание наличия элемента по локатору
public static void presenceOfElementLocated(By webElement) {
    webDriverWait.until(ExpectedConditions.presenceOfElementLocated(webElement));
}
```

* метод **presenceOfTextInElement** - ожидание появления текста в элементе

```java
// Ожидание появления текста в элементе
public static void presenceOfTextInElement(WebElement webElement, String text) {
    webDriverWait.until(ExpectedConditions.textToBePresentInElement(webElement, text));
}
```

* метод **clickabilityOfElement** - ожидание кликабельности элемента

```java
// Ожидание кликабельности элемента
public static void clickabilityOfElement(WebElement webElement) {
    webDriverWait.until(ExpectedConditions.elementToBeClickable(webElement));
}
```    

* метод **clickabilityOfElementLocated** - ожидание кликабельности элемента по локатору

```java
// Ожидание кликабельности элемента по локатору
public static void clickabilityOfElementLocated(By webElement) {
    webDriverWait.until(ExpectedConditions.elementToBeClickable(webElement));
}
```

* метод **visibilityOfElement** - ожидание видимости элемента

```java
// Ожидание видимости элемента
public static void visibilityOfElement(WebElement webElement) {
    webDriverWait.until(ExpectedConditions.visibilityOf(webElement));
}
```

* метод **visibilityOfElementLocated** - ожидание видимости элемента по локатору

 ```java
// Ожидание видимости элемента по локатору
public static void visibilityOfElementLocated(By webElement) {
    webDriverWait.until(ExpectedConditions.visibilityOfElementLocated(webElement));
}
```

* метод **firstProductMustBe** - ожидание появления в списке продуктов в первой позиции заданного продукта

 ```java
// Ожидание появления в списке продуктов в первой позиции заданного продукта
public static void firstProductMustBe(By webElement, String product) {
    webDriverWait.until((ExpectedCondition<Boolean>) webDriver ->
        webDriver.findElement(webElement).getText().contains(product));
}
```

## 2.2. Полный код WaitHelper.java

[WaitHelper.java](_Sample/src/test/java/helpers/WaitHelper.java)

## 2.3. Класс JavaScriptHelper

***JavaScriptHelper*** - класс для выполнения скриптов на **JavaScript**.
Содержит статические методы для выполнения скриптов, решающих задачи,
которые нельзя решить стандартными возможностями **Selenium WebDriver**.

Шаги:

1. Создать файл **JavaScriptHelper.java** в **./src/test/java/helpers**.

![New Maven Project - JavaScriptHelper.java](./_Files/2.%20New%20Project/2.%20Helpers/03.jpg "New Project - JavaScriptHelper.java")

2. Добавить в файл **JavaScriptHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(JavaScriptHelper.class);
```

* объявление исполнителя JavaScript скриптов **JavascriptExecutor**

```java
// Исполнитель JavaScript скриптов
protected static JavascriptExecutor javascriptExecutor;
```

* метод **init** - инициализация исполнителя JavaScript скриптов

```java
// Инициализация исполнителя JavaScript скриптов
public static void init(WebDriver driver) {
    javascriptExecutor = (JavascriptExecutor) driver;
}
```

* метод **scrollBy** - скролл страницы на заданное расстояние в пикселях по X и по Y

```java
// Скролл страницы на заданное расстояние в пикселях по X и по Y
public static void scrollBy(int x, int y) {
    String script = "window.scrollBy(" + x + "," + y + ");";
    javascriptExecutor.executeScript(script);
    // Добавление задержки
    try {
    	Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(2));
    } catch (InterruptedException e) {
    	throw new RuntimeException(e);
    }
}
```

* метод **displayNone** - установка невидимости веб элемента

```java
// Установка невидимости веб элемента
public static void displayNone(WebElement element) {
    String script = "arguments[0].style.display='none';";
    javascriptExecutor.executeScript(script, element);
    // Добавление задержки
    try {
    	Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(2));
    } catch (InterruptedException e) {
    	throw new RuntimeException(e);
    }
}
```

## 2.4. Полный код JavaScriptHelper.java

[JavaScriptHelper.java](_Sample/src/test/java/helpers/JavaScriptHelper.java)

## 2.5. Класс ActionHelper

***ActionHelper*** - класс выполнения сложных действий на страницах.
Содержит статические методы для выполнения сложных действий пользователя,
таких как наведение мыши на элемент, перетаскивание и т д.

Шаги:

1. Создать файл **ActionHelper.java** в **./src/test/java/helpers**.

![New Maven Project - ActionHelper.java](./_Files/2.%20New%20Project/2.%20Helpers/04.jpg "New Project - ActionHelper.java")

2. Добавить в файл **ActionHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(ActionHelper.class);
```

* объявление экшена

```java
// Экшен
protected static Actions actions;
```

* метод **init** - инициализация экшена

```java
// Инициализация экшена
public static void init(WebDriver driver) {
    actions = new Actions(driver);
}
```

* метод **moveToElement** - перемещение курсора мыши на элемент

```java
// Перемещение курсора мыши на элемент
public static void moveToElement(WebElement webElement) {
    actions.moveToElement(webElement).perform();
}
```

## 2.6. Полный код ActionHelper.java

[ActionHelper.java](_Sample_03/src/test/java/helpers/ActionHelper.java)

## 2.7. Класс NavigationHelper

***NavigationHelper*** - класс для навигации в браузере.
Содержит статические методы для навигации по истории браузера,
обновления страницы и загрузки новой страницы.

Шаги:

1. Создать файл **NavigationHelper.java** в **./src/test/java/helpers**.

![New Maven Project - NavigationHelper.java](./_Files/2.%20New%20Project/2.%20Helpers/05.jpg "New Project - NavigationHelper.java")

2. Добавить в файл **NavigationHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(NavigationHelper.class);
```

* объявление драйвера

```java
// Веб драйвер
private static WebDriver navigation;
```

* метод **init** - инициализация драйвера

```java
// Инициализация драйвера
public static void init(WebDriver driver) {
    navigation = driver;
}
```

* метод **navigateTo** - открытие новой страницы

```java
// Открытие новой страницы
public static void navigateTo(String URL) {
    navigation.navigate().to(URL);
}
```

* метод **back** - переход на предыдущую страницу

```java
// Переход на предыдущую страницу
public static void back() {
    navigation.navigate().back();
}
```

* метод **forward** - переход на следующую страницу

```java
// Переход на следующую страницу
public static void forward() {
    navigation.navigate().forward();
}
```

* метод **refresh** - обновление страницы

```java
// Обновление страницы
public static void refresh() {
    navigation.navigate().refresh();
} 
```

## 2.8. Полный код NavigationHelper.java

[NavigationHelper.java](_Sample_03/src/test/java/helpers/NavigationHelper.java)

## 2.9. Класс WindowHelper

***WindowHelper*** - класс для управления окнами браузера.
Содержит статические методы для изменения размеров и положения окна браузера.

Шаги:

1. Создать файл **WindowHelper.java** в **./src/test/java/helpers**.

![New Maven Project - WindowHelper.java](./_Files/2.%20New%20Project/2.%20Helpers/06.jpg "New Project - WindowHelper.java")

2. Добавить в файл **WindowHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(WindowHelper.class);
```

* объявление драйвера

```java
// Веб драйвер
private static WebDriver window;
```

* метод **init** - инициализация драйвера

```java
// Инициализация драйвера
public static void init(WebDriver driver) {
    window = driver;
}
```

* метод **maximizeWindow** - максимизация размеров окна

```java
// Максимизация размеров окна
public static void maximizeWindow() {
    window.manage().window().maximize();
}
```

* метод **minimizeWindow** - минимизация размеров окна

```java
// Минимизация размеров окна
public static void minimizeWindow() {
    window.manage().window().minimize();
}
```

* метод **fullscreenWindow** - отображение окна браузера в полноэкранном режиме

```java
// Отображение окна браузера в полноэкранном режиме
public static void fullscreenWindow() {
    window.manage().window().fullscreen();
}
```

* метод **getWindowPosition** - получение координат расположения окна

```java
// Получение координат расположения окна
public static Point getWindowPosition() {
    return window.manage().window().getPosition();
}
```

* метод **setWindowPosition** - установка координат расположения окна

```java
// Установка координат расположения окна
public static void setWindowPosition(Point point) {
    window.manage().window().setPosition(point);
}
```

* метод **getWindowSize** - получение размеров окна

```java
// Получение размеров окна
public static Dimension getWindowSize() {
    return window.manage().window().getSize();
}
```

* метод **setWindowSize** - установка размеров окна

```java
// Установка размеров окна
public static void setWindowSize(Dimension dimension) {
    window.manage().window().setSize(dimension);
}
```

## 2.10. Полный код WindowHelper.java

[WindowHelper.java](_Sample_03/src/test/java/helpers/WindowHelper.java)

## 2.11. Класс SwitchHelper

***SwitchHelper*** - класс для переключения на объекты.
Содержит статические методы для переключения на окна браузера, алерты, фреймы.

Шаги:

1. Создать файл **SwitchHelper.java** в **./src/test/java/helpers**.

![New Maven Project - SwitchHelper.java](./_Files/2.%20New%20Project/2.%20Helpers/07.jpg "New Project - SwitchHelper.java")

2. Добавить в файл **SwitchHelper.java** код.

* объявление логгера

```java
// Логгер
private static Logger logger = LogManager.getLogger(SwitchHelper.class);
```

* объявление драйвера

```java
// Веб драйвер
private static WebDriver switcher;
```

* метод **init** - инициализация драйвера

```java
// Инициализация драйвера
public static void init(WebDriver driver) {
    switcher = driver;
}
```

* метод **switchToExistWindow** - переключение на созданное окно

```java
// Переключение на созданное окно
public static void switchToExistWindow(String window) {
    switcher.switchTo().window(window);
}
```

* метод **switchToNewWindow** - переключение на создаваемое окно

```java
// Переключение на создаваемое окно
public static void switchToNewWindow() {
    switcher.switchTo().newWindow(WindowType.WINDOW);
}
```

* метод **switchToNewTab** - переключение на создаваемую вкладку

```java
// Переключение на создаваемую вкладку
public static void switchToNewTab() {
    switcher.switchTo().newWindow(WindowType.TAB);
}
```

* метод **switchToAlert** - переключение на алерт

```java
// Переключение на алерт
public static void switchToAlert() {
    switcher.switchTo().alert();
}
```

* метод **switchToFrameByIndex** - переключение на фрейм по его индексу

```java
// Переключение на фрейм по его индексу
public static void switchToFrameByIndex(int index) {
    switcher.switchTo().frame(index);
}
```

* метод **switchToFrameByNameOrId** - переключение на фрейм по его атрибуту name или id

```java
// Переключение на фрейм по его атрибуту name или id
public static void switchToFrameByNameOrId(String nameOrId) {
    switcher.switchTo().frame(nameOrId);
}
```

* метод **switchToFrameByFrameWebElement** - переключение на фрейм по веб элементу

```java
// Переключение на фрейм по веб элементу
public static void switchToFrameByFrameWebElement(WebElement webElement) {
    switcher.switchTo().frame(webElement);
}
```

* метод **switchToParentFrame** - переключение на родительский фрейм

```java
// Переключение на родительский фрейм
public static void switchToParentFrame() {
    switcher.switchTo().parentFrame();
}
```

* метод **switchToDefaultContent** - переключение на основной документ

```java
// Переключение на основной документ 
public static void switchToDefaultContent() {
    switcher.switchTo().defaultContent();
}
```

* метод **switchToActiveWebElement** - переключение на активный веб элемент

```java
// Переключение на активный веб элемент
public static void switchToActiveWebElement() {
    switcher.switchTo().activeElement();
}
```

## 2.12. Полный код SwitchHelper.java

[SwitchHelper.java](_Sample_03/src/test/java/helpers/SwitchHelper.java)

***

# 3. Тесты

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать пакет Java **tests** в папке **./src/test/java**.

![New Maven Project - tests](./_Files/2.%20New%20Project/3.%20Tests/01.jpg "New Project - tests")

## 3.1. Класс BaseTest

***BaseTest*** - базовый класс для всех классов с тестами.
Содержит ссылку на экземпляр драйвера и общие для всех тестов методы, которые выполняются до и после каждого теста.

От данного класса наследуются все классы с тестами.

Шаги:

1. Создать файл **BaseTest.java** в **./src/test/java/tests**.

![New Maven Project - BaseTest.java](./_Files/2.%20New%20Project/3.%20Tests/02.jpg "New Project - BaseTest.java")

2. Добавить в файл **BaseTest.java** код.

* объявление драйвера

```java
// Драйвер браузера
protected static WebDriver driver;
```

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(BaseTest.class);
```

* метод **setUp** - действия перед каждым тестом (аннотация **@BeforeEach**)

В данном уроке пока не будем применять паттерн **Фабрика (Factory Method)**.
Покажем в следующей практике плюсы от применения фабрики.

```java
// Перед каждым тестом
@BeforeEach
public void setUp() {
    // Получаем параметр запуска тестов через Maven -Dbrowser
    String browser = System
        .getProperty("browser", "chrome")
        .toLowerCase();
    // Получаем экземпляр драйвера браузера
    // Настройка исполняемого файла драйвера
    WebDriverManager.chromedriver().setup();
    // Опции драйвера:
    ChromeOptions options = new ChromeOptions();
    // - поведение при появлении алертов "Игнорирование"
    options.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.IGNORE);
    // - стратегия загрузки страницы "NORMAL"
    options.setCapability(CapabilityType.PAGE_LOAD_STRATEGY, PageLoadStrategy.NORMAL);
    // - режим "Инкогнито"
    options.addArguments("--incognito");
    // - режим "Полный экран"
    options.addArguments("--start-fullscreen");
    driver = new ChromeDriver(options);
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown** - действия после каждого теста (аннотация **@AfterEach**)

```java
// После каждого теста
@AfterEach
public void setDown() {
    // Если драйвер еще существует
    if(driver != null) {
        // Закрываем его
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 3.2. Полный код BaseTest.java

[BaseTest.java](_Sample/src/test/java/tests/BaseTest.java)

***

# 4. Паттерн Объект страницы / Объектная модель страницы (Page Object / Page Object Model (POM))

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать пакет Java **pages** в папке **./src/test/java**.

![New Maven Project - pages](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/01.jpg "New Project - pages")

## 4.1. Класс Base Page (Базовый объект страниц)

***Base Page*** - базовый класс для всех страниц.
Содержит ссылку на экземпляр драйвера и базовый конструктор.
В базовый конструктор передается ссылка на экземпляр драйвера.  
В базовом конструкторе инициализируются явное ожидание и исполнитель JS скриптов.

От данного класса наследуются все классы моделирующие конкретные страницы.

Шаги:

1. Создать файл **BasePage.java** в **./src/test/java/pages**.

![New Maven Project - BasePage.java](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/02.jpg "New Project - BasePage.java")

2. Добавить в файл **BasePage.java** код.

* объявление драйвера

```java
// Драйвер браузера
protected static WebDriver driver;
```

* конструктор базового класса

```java
// Конструктор базового класса 
public BasePage(WebDriver driver) {
    BasePage.driver = driver;
    // Инициализация ожиданий событий на странице
    WaitHelper.init(driver, Duration.ofSeconds(10), Duration.ofMillis(100));
    // Инициализация выполнения скриптов на JavaScript
    JavaScriptHelper.init(driver);
    // Инициализация выполнения сложных действий
    ActionHelper.init(driver);
    // Инициализация навигации в браузере
    NavigationHelper.init(driver);
    // Инициализация управления окнами
    WindowHelper.init(driver);
    // Инициализация переключения на объекты
    SwitchHelper.init(driver);
}
```

* метод **getPageTitle** - получение заголовка текущей страницы

```java
// Получение заголовка текущей страницы
public String getPageTitle() {
    String title = driver.getTitle();
    //logger.info("Заголовок страницы: " + title);
    return title;
}
```

## 4.2. Полный код BasePage.java

[BasePage.java](_Sample/src/test/java/pages/BasePage.java)

## 4.3. Класс StartPage (Стартовая страница)

***StartPage*** - класс моделирующий объекты **Стартовой страницы** сайта 
[dns-shop.ru](https://www.dns-shop.ru/).

Класс **StartPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **StartPage.java** в **./src/test/java/pages**.

![New Maven Project - StartPage.java](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/03.jpg "New Project - StartPage.java")

2. Наследоваться от класса **BasePage**

```java
public class StartPage extends BasePage {
    
}
```

3. Добавить в файл **StartPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(StartPage.class);
```

* объявление константы хранящей URL **Стартовой страницы** сайта [DNS](https://www.dns-shop.ru/)

```java
// URL страницы
private final String URL = "https://www.dns-shop.ru/";
```

* объявление списка локаторов веб элементов

```java
// ***** Локаторы *****
// Кнопка "Всё верно" на всплывашке
String buttonYesXpath = "(//span[text()=\"Всё верно\"]/parent::button)[1]";
// Ссылка "Смартфоны и гаджеты"
String linkSmartsAndGadgetsXpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[1]";
// Ссылка "Смартфоны"
String linkSmartsXpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[2]/following::div/a";
```

* конструктор класса

```java
// Конструктор класса
public StartPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* метод **getURL** - получение URL страницы

```java
// Получение URL страницы
public String getURL() {
    return this.URL;
}
```

* метод **openPage** - открытие страницы

```java
// Открытие страницы
public void openPage() {
    driver.get(this.URL);
    logger.info("Открыта страница https://www.dns-shop.ru/");
}
```

* метод **buttonYesClick** - нажатие на кнопку **Всё верно**

```java
// Нажатие на кнопку "Всё верно" на всплывашке
public void buttonYesClick() {
    WaitHelper.presenceOfElementLocated(By.xpath(buttonYesXpath));
    WebElement linkYes = driver.findElement(By.xpath(buttonYesXpath));
    WaitHelper.clickabilityOfElement(linkYes);
    linkYes.click();
    logger.info("Нажата кнопка \"Всё верно\"");
}
```

* метод **linkSmartsAndGadgetsMove** - наведение курсора мыши на ссылку **Смартфоны и гаджеты**

```java
// Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
public void linkSmartsAndGadgetsMove() {
    WaitHelper.presenceOfElementLocated(By.xpath(linkSmartsAndGadgetsXpath));
    WebElement linkSmartsAndGadgets = driver.findElement(By.xpath(linkSmartsAndGadgetsXpath));
    ActionHelper.moveToElement(linkSmartsAndGadgets);
    logger.info("Курсор мыши наведен на ссылку \"Смартфоны\"");
}
```

* метод **linkSmartsClick** - нажатие на ссылку **Смартфоны**

```java
// Нажатие на ссылку "Смартфоны"
public void linkSmartsClick() {
    WaitHelper.visibilityOfElementLocated(By.xpath(linkSmartsXpath));
    WebElement linkSmarts = driver.findElement(By.xpath(linkSmartsXpath));
    WaitHelper.clickabilityOfElement(linkSmarts);
    linkSmarts.click();
    logger.info("Нажата ссылка \"Смартфоны\"");
}
```

## 4.4. Полный код StartPage.java

[StartPage.java](_Sample/src/test/java/pages/StartPage.java)

## 4.5. Класс SmartphonesPage

***SmartphonesPage*** - класс моделирующий объекты страницы **Смартфоны**.

Класс **SmartphonesPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphonesPage.java** в **./src/test/java/pages**.

![New Maven Project - SmartphonesPage.java](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/04.jpg "New Project - SmartphonesPage.java")

2. Наследоваться от класса **BasePage**

```java
public class SmartphonesPage extends BasePage {
    
}
```

3. Добавить в файл **SmartphonesPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphonesPage.class);
```

* объявление списка локаторов веб элементов

```java
// ***** Локаторы *****
// 1. Блоки
// Шапка
String blockHeaderXpath = "//header";
// 2. Фильтры и сортировка
// 2.1. Сортировка
// Аккордеон "Сортировка"
String accordeonSortXpath = "//span[contains(text(), \"Сортировка:\")]/following::a";
// Переключатель "Сортировка"
String radiobuttonSortXpath = "//span[contains(text(), \"type\")]";
// 2.2. Фильтр "Производитель"
// Аккордеон "Производитель"
String accordeonCompanyXpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Производитель\"]";
// Чекбокс "Производитель"
String checkboxCompanyXpath = "//span[contains(text(), \"company\")]";
// 2.3. Фильтр "Объем оперативной памяти"
// Аккордеон "Объем оперативной памяти"
String accordeonRAMXpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Объем оперативной памяти\"]";
// Чекбокс "Объем оперативной памяти"
String checkboxRAMXpath = "//span[contains(text(), \"ram\")]";
// Кнопка "Применить"
String buttonApplyXpath = "//button[contains(text(), \"Применить\")]";
// 3. Список смартфонов
// Ссылка на первый продукт в списке
String linkFirstProductXpath = "(//a[contains(@class, \"catalog-product__name\")])[1]";
```

* конструктор класса

```java
// Конструктор класса
public SmartphonesPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

* метод **hideHeaderBlock** - скрытие шапки

```java
// Скрытие шапки
public void blockHeaderHide() {
    WebElement blockHeader = driver.findElement(By.xpath(blockHeaderXpath));
    JavaScriptHelper.displayNone(blockHeader);
}
```

* метод **accordeonSortClick** - отображение сортировки

```java
// Отображение сортировки
public void accordeonSortClick() {
    WaitHelper.visibilityOfElementLocated(By.xpath(accordeonSortXpath));
    WebElement accordeonSort = driver.findElement(By.xpath(accordeonSortXpath));
    WaitHelper.clickabilityOfElement(accordeonSort);
    accordeonSort.click();
    logger.info("Отображена сортировка");
}
```

* метод **radiobuttonSortClick** - установка сортировки

```java
// Установка сортировки
public void radiobuttonSortClick(String type) {
    radiobuttonSortXpath = radiobuttonSortXpath.replace("type", type);
    WaitHelper.visibilityOfElementLocated(By.xpath(radiobuttonSortXpath));
    WebElement radiobuttonSort = driver.findElement(By.xpath(radiobuttonSortXpath));
    WaitHelper.clickabilityOfElement(radiobuttonSort);
    radiobuttonSort.click();
    logger.info("Установлена сортировка - \"" + type + "\"");
}
```

* метод **accordeonCompanyClick** - отображение фильтра **Производитель**

```java
// Отображение фильтра "Производитель"
public void accordeonCompanyClick() {
    WaitHelper.visibilityOfElementLocated(By.xpath(accordeonCompanyXpath));
    WebElement accordeonCompany = driver.findElement(By.xpath(accordeonCompanyXpath));
    WaitHelper.clickabilityOfElement(accordeonCompany);
    accordeonCompany.click();
    logger.info("Отображен фильтр \"Производитель\"");
}
```
		
* метод **checkboxCompanyClick** - установка фильтра **Производитель**

```java
// Установка фильтра "Производитель"
public void checkboxCompanyClick(String company) {
    checkboxCompanyXpath = checkboxCompanyXpath.replace("company", company);
    WaitHelper.visibilityOfElementLocated(By.xpath(checkboxCompanyXpath));
    WebElement checkboxCompany = driver.findElement(By.xpath(checkboxCompanyXpath));
    WaitHelper.clickabilityOfElement(checkboxCompany);
    checkboxCompany.click();
    logger.info("Установлен фильтр \"Производитель\" - " + company);
}
```

* метод **accordeonRAMClick** - отображение фильтра **Объем оперативной памяти**

```java
// Отображение фильтра "Объем оперативной памяти"
public void accordeonRAMClick() {
    WaitHelper.visibilityOfElementLocated(By.xpath(accordeonRAMXpath));
    WebElement accordeonRAM = driver.findElement(By.xpath(accordeonRAMXpath));
    WaitHelper.clickabilityOfElement(accordeonRAM);
    accordeonRAM.click();
    logger.info("Отображен фильтр \"Объем оперативной памяти\"");
}
```

* метод **checkboxRAMClick** - установка фильтра **Объем оперативной памяти**

```java
// Установка фильтра "Объем оперативной памяти"
public void checkboxRAMClick(String ram) {
    checkboxRAMXpath = checkboxRAMXpath.replace("ram", ram);
    WaitHelper.visibilityOfElementLocated(By.xpath(checkboxRAMXpath));
    WebElement checkboxRAM = driver.findElement(By.xpath(checkboxRAMXpath));
    WaitHelper.clickabilityOfElement(checkboxRAM);
    checkboxRAM.click();
    logger.info("Установлен фильтр \"Объем оперативной памяти\" - " + ram);
}
```

* метод **buttonApplyClick** - нажатие на кнопку **Применить**

```java
// Нажатие на кнопку "Применить"
public void buttonApplyClick() {
    WaitHelper.visibilityOfElementLocated(By.xpath(buttonApplyXpath));
    WebElement buttonApply = driver.findElement(By.xpath(buttonApplyXpath));
    WaitHelper.clickabilityOfElement(buttonApply);
    buttonApply.click();
    logger.info("Нажата кнопка \"Применить\"");
}
```

* метод **linkFirstProductClick** - нажатие на ссылку первого продукта в списке

```java
// Нажатие на ссылку первого продукта в списке
public void linkFirstProductClick(String product) {
    WaitHelper.firstProductMustBe(By.xpath(linkFirstProductXpath), product);
    WebElement linkFirstProduct = driver.findElement(By.xpath(linkFirstProductXpath));
    String URL = linkFirstProduct.getAttribute("href");
    SwitchHelper.switchToNewWindow();
    WindowHelper.maximizeWindow();
    NavigationHelper.navigateTo(URL);
    logger.info("Нажата ссылка первого продукта в списке");
}
```

## 4.6. Полный код SmartphonesPage.java

[SmartphonesPage.java](_Sample/src/test/java/pages/SmartphonesPage.java)

## 4.7. Класс SmartphoneProductPage (Страница "Продукт. Смартфон")

***SmartphoneProductPage*** - класс моделирующий объекты страницы **Продукт. Смартфон**.

Класс **SmartphoneProductPage** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphoneProductPage.java** в **./src/test/java/pages**.

![New Maven Project - SmartphoneProductPage.java](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/05.jpg "New Project - SmartphoneProductPage.java")

2. Наследоваться от класса **BasePage**

```java
public class SmartphoneProductPage extends BasePage {
    
}
```

3. Добавить в файл **SmartphoneProductPage.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphoneProductPage.class);
```

* конструктор класса

```java
// Конструктор класса
public SmartphoneProductPage(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
}
```

## 4.8. Полный код SmartphoneProductPage.java

[SmartphoneProductPage.java](_Sample/src/test/java/pages/SmartphoneProductPage.java)

## 4.9. Класс Pattern1POMTest

***Pattern1POMTest*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**.
с применением паттерна **Page Object Model**

Класс **Pattern1POMTest** расширяет класс **BaseTest**.

Шаги:

1. Создать пакет Java **smartphones** в папке **./src/test/java/tests**.

![New Maven Project - smartphones](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/06.jpg "New Project - smartphones")

2. Создать файл **Pattern1POMTest.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - Pattern1POMTest.java](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/07.jpg "New Project - Pattern1POMTest.java")

3. Наследоваться от класса **BaseTest**

```java
public class Pattern1POMTest extends BaseTest {
    
}
```

4. Добавить в файл **Pattern1POMTest.java** код.

* метод **dnsTest** - тест

```java
@Test
public void dnsTest() {
    // ***** Стартовая страница сайта DNS *****
    StartPage startPage = new StartPage(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPage smartphonesPage = new SmartphonesPage(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    String company = "Samsung"; // производитель
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    String ram = "8 Гб"; // объем ОП
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон"*****
    SmartphoneProductPage smartphoneProductPage = new SmartphoneProductPage(driver);
    String actual = smartphoneProductPage.getPageTitle();

    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

## 4.10. Полный код Pattern1POMTest.java

[Pattern1POMTest.java](_Sample/src/test/java/tests/smartphones/Pattern1POMTest.java)

## 4.11. Запуск автотеста

Шаги:

1. Запустить тест командой **mvn clean test** с параметрами **-Dtest=Pattern1POMTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/08.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/09.jpg "New Maven Project - Запуск теста")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/4.%20Page%20Object%20Model/10.jpg "New Maven Project - Лог запуска")

## 4.12. Что изменилось и какая польза?

В результате применения паттерна удалось отделить технические детали реализации шагов теста от логики проверок теста.
Также описание и действия по работе с конкретной страницей объединены в одном классе, что существенно улучшает поддержку кода.

***

# 5. Паттерн Объект страницы / Объектная модель страницы (Page Object / Page Object Model (POM)) с PageFactory

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

## 5.1. Класс StartPagePF (Стартовая страница)

***StartPagePF*** - класс моделирующий объекты **Стартовой страницы** сайта 
[dns-shop.ru](https://www.dns-shop.ru/).

Класс **StartPagePF** расширяет класс **BasePage**.

Шаги:

1. Создать файл **StartPagePF.java** в **./src/test/java/pages**.

![New Maven Project - StartPagePF.java](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/01.jpg "New Project - StartPagePF.java")

2. Наследоваться от класса **BasePage**

```java
public class StartPagePF extends BasePage {
    
}
```

3. Добавить в файл **StartPagePF.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(StartPagePF.class);
```

* объявление константы хранящей URL **Стартовой страницы** сайта [DNS](https://www.dns-shop.ru/)

```java
// URL страницы
private final String URL = "https://www.dns-shop.ru/";
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// Кнопка "Всё верно" на всплывашке
@FindBy(xpath = "(//span[text()=\"Всё верно\"]/parent::button)[1]")
private WebElement linkYes;
// Ссылка "Смартфоны и гаджеты"
@FindBy(xpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[1]")
private WebElement linkSmartsAndGadgets;
// Ссылка "Смартфоны"
@FindBy(xpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[2]/following::div/a")
private WebElement linkSmarts;
```

* конструктор класса

```java
// Конструктор класса
public StartPagePF(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* метод **getURL** - получение URL страницы

```java
// Получение URL страницы
public String getURL() {
    return this.URL;
}
```

* метод **openPage** - открытие страницы

```java
// Открытие страницы
public void openPage() {
    driver.get(this.URL);
    logger.info("Открыта страница https://www.dns-shop.ru/");
}
```

* метод **buttonYesClick** - нажатие на кнопку **Всё верно**

```java
// Нажатие на кнопку "Всё верно" на всплывашке
public void buttonYesClick() {
    WaitHelper.clickabilityOfElement(buttonYes);
    buttonYes.click();
    logger.info("Нажата кнопка \"Всё верно\"");
}
```

* метод **linkSmartsAndGadgetsMove** - наведение курсора мыши на ссылку **Смартфоны и гаджеты**

```java
// Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
public void linkSmartsAndGadgetsMove() {
    ActionHelper.moveToElement(linkSmartsAndGadgets);
    logger.info("Курсор мыши наведен на ссылку \"Смартфоны\"");
}
```

* метод **linkSmartsClick** - нажатие на ссылку **Смартфоны**

```java
// Нажатие на ссылку "Смартфоны"
public void linkSmartsClick() {
    WaitHelper.clickabilityOfElement(linkSmarts);
    linkSmarts.click();
    logger.info("Нажата ссылка \"Смартфоны\"");
}
```

## 5.2. Полный код StartPagePF.java

[StartPagePF.java](_Sample/src/test/java/pages/StartPagePF.java)

## 5.3. Класс SmartphonesPagePF

***SmartphonesPagePF*** - класс моделирующий объекты страницы **Смартфоны**.

Класс **SmartphonesPagePF** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphonesPagePF.java** в **./src/test/java/pages**.

![New Maven Project - SmartphonesPagePF.java](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/02.jpg "New Project - SmartphonesPagePF.java")

2. Наследоваться от класса **BasePage**

```java
public class SmartphonesPagePF extends BasePage {
    
}
```

3. Добавить в файл **SmartphonesPagePF.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphonesPagePF.class);
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// 1. Блоки
// Шапка
@FindBy(xpath = "//header")
private WebElement blockHeader;
// 2. Фильтры и сортировка
// 2.1. Сортировка
// Аккордеон "Сортировка"
@FindBy(xpath = "//span[contains(text(), \"Сортировка:\")]/following::a")
private WebElement accordeonSort;
// Переключатели "Сортировка"
@FindBy(xpath = "(//div[@class=\"top-filter__radio-list ui-radio top-filter__popover\"])[1]//span")
private List<WebElement> radiobuttonSort;
// 2.2. Фильтр "Производитель"
// Аккордеон "Производитель"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Производитель\"]")
private WebElement accordeonCompany;
// Чекбоксы "Производитель"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Производитель\"]/../../div//label/span[1]")
private List<WebElement> checkboxCompany;
// 2.3. Фильтр "Объем оперативной памяти"
// Аккордеон "Объем оперативной памяти"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Объем оперативной памяти\"]")
private WebElement accordeonRAM;
// Чекбоксы "Объем оперативной памяти"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Объем оперативной памяти\"]/../../div//label/span[1]")
private List<WebElement> checkboxRAM;
// Кнопка "Применить"
@FindBy(xpath = "//button[contains(text(), \"Применить\")]")
private WebElement buttonApply;
// 3. Список смартфонов
// Ссылка на первый продукт в списке
@FindBy(xpath = "(//a[contains(@class, \"catalog-product__name\")])[1]")
private WebElement linkFirstProduct;
```

* конструктор класса

```java
// Конструктор класса
public SmartphonesPagePF(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* метод **blockHeaderHide** - скрытие шапки

```java
// Скрытие шапки
public void blockHeaderHide() {
    JavaScriptHelper.displayNone(blockHeader);
}
```

* метод **accordeonSortClick** - отображение сортировки

```java
// Отображение сортировки
public void accordeonSortClick() {
    WaitHelper.clickabilityOfElement(accordeonSort);
    accordeonSort.click();
    logger.info("Отображена сортировка");
}
```

* метод **radiobuttonSortClick** - установка сортировки

```java
// Установка сортировки
public void radiobuttonSortClick(String type) {
    for (WebElement webElement : radiobuttonSort) {
	    if(webElement.getText().contains(type)) {
		    WaitHelper.clickabilityOfElement(webElement);
		    webElement.click();
		    break;
    	}
    }
    logger.info("Установлена сортировка - \"" + type + "\"");
}
```

* метод **accordeonCompanyClick** - отображение фильтра **Производитель**

```java
// Отображение фильтра "Производитель"
public void accordeonCompanyClick() {
    WaitHelper.clickabilityOfElement(accordeonCompany);
    accordeonCompany.click();
    logger.info("Отображен фильтр \"Производитель\"");
}
```

* метод **checkboxCompanyClick** - установка фильтра **Производитель**

```java
// Установка фильтра "Производитель"
public void checkboxCompanyClick(String company) {
    for (WebElement webElement : checkboxCompany) {
	    if(webElement.getText().contains(company)) {
		    WaitHelper.clickabilityOfElement(webElement);
		    webElement.click();
		    break;
	    }
    }
    logger.info("Установлен фильтр \"Производитель\" - " + company);
}
```

* метод **accordeonRAMClick** - отображение фильтра **Объем оперативной памяти**

```java
// Отображение фильтра "Объем оперативной памяти"
public void accordeonRAMClick() {
    WaitHelper.clickabilityOfElement(accordeonRAM);
    accordeonRAM.click();
    logger.info("Отображен фильтр \"Объем оперативной памяти\"");
}
```

* метод **checkboxRAMClick** - установка фильтра **Объем оперативной памяти**

```java
// Установка фильтра "Объем оперативной памяти"
public void checkboxRAMClick(String ram) {
    for (WebElement webElement : checkboxRAM) {
	    if(webElement.getText().contains(ram)) {
		    WaitHelper.clickabilityOfElement(webElement);
		    webElement.click();
		    break;
	    }
    }
    logger.info("Установлен фильтр \"Объем оперативной памяти\" - " + ram);
}
```

* метод **buttonApplyClick** - нажатие на кнопку **Применить**

```java
// Нажатие на кнопку "Применить"
public void buttonApplyClick() {
    WaitHelper.clickabilityOfElement(buttonApply);
    buttonApply.click();
    logger.info("Нажата кнопка \"Применить\"");
}
```

* метод **linkFirstProductClick** - нажатие на ссылку первого продукта в списке

```java
// Нажатие на ссылку первого продукта в списке
public void linkFirstProductClick(String product) {
    String URL = linkFirstProduct.getAttribute("href");
    SwitchHelper.switchToNewWindow();
    WindowHelper.maximizeWindow();
    NavigationHelper.navigateTo(URL);
    logger.info("Нажата ссылка первого продукта в списке");
}
```

## 5.4. Полный код SmartphonesPagePF.java

[SmartphonesPagePF.java](_Sample/src/test/java/pages/SmartphonesPagePF.java)

## 5.5. Класс SmartphoneProductPagePF (Страница "Продукт. Смартфон")

***SmartphoneProductPagePF*** - класс моделирующий объекты страницы **Продукт. Смартфон**.

Класс **SmartphoneProductPagePF** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphoneProductPagePF.java** в **./src/test/java/pages**.

![New Maven Project - SmartphoneProductPagePF.java](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/03.jpg "New Project - SmartphoneProductPagePF.java")

2. Наследоваться от класса **BasePage**

```java
public class SmartphoneProductPage extends BasePage {
    
}
```

3. Добавить в файл **SmartphoneProductPagePF.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphoneProductPagePF.class);
```

* конструктор класса

```java
// Конструктор класса
public SmartphoneProductPagePF(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

## 5.6. Полный код SmartphoneProductPagePF.java

[SmartphoneProductPagePF.java](_Sample/src/test/java/pages/SmartphoneProductPagePF.java)

## 5.7. Класс Pattern2PageFactoryTest

***Pattern2PageFactoryTest*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**.
с применением паттерна **Page Object Model** и **PageFactory**.

Класс **Pattern2PageFactoryTest** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **Pattern2PageFactoryTest.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - Pattern2PageFactoryTest.java](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/04.jpg "New Project - Pattern2PageFactoryTest.java")

2. Наследоваться от класса **BaseTest**

```java
public class Pattern2PageFactoryTest extends BaseTest {
    
}
```

4. Добавить в файл **Pattern2PageFactoryTest.java** код.

* метод **dnsTest** - тест

```java
@Test
public void dnsTest() {
    // ***** Стартовая страница сайта DNS *****
    StartPagePF startPage = new StartPagePF(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPagePF smartphonesPage = new SmartphonesPagePF(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    String company = "Samsung"; // производитель
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    String ram = "8 Гб"; // объем ОП
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон" *****
    SmartphoneProductPagePF smartphoneProductPage = new SmartphoneProductPagePF(driver);
    String actual = smartphoneProductPage.getPageTitle();

    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

## 5.8. Полный код Pattern2PageFactoryTest.java

[Pattern2PageFactoryTest.java](_Sample/src/test/java/tests/smartphones/Pattern2PageFactoryTest.java)

## 5.9. Запуск автотеста

Шаги:

1. Запустить тест командой **mvn clean test** с параметрами **-Dtest=Pattern2PageFactoryTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/05.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/06.jpg "New Maven Project - Запуск теста")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/5.%20POM%20With%20PageFactory/07.jpg "New Maven Project - Лог запуска")

## 5.10. Что изменилось и какая польза?

**Page Factory** инициализирует элементы класса страницы, не используя **findElement(s)**.
Вместо этого применяется аннотация **@FindBy**, служащая для поиска веб элементов.
То есть выполняется так называемая ленивая инициализация веб элементов при каждом обращении к ним через действия.
Таким образом нам не надо каждый раз писать **findElement(s)**.

***

# 6. Паттерн Подготовка, Действие, Проверка (Arrange Act Assert)

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

## 6.1. Класс Pattern3AAATest

***Pattern3AAATest*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**
с применением паттернов:

* **Page Object Model**
* **PageFactory**
* **Arrange Act Assert**

Класс **Pattern3AAATest** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **Pattern3AAATest.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - Pattern3AAATest.java](./_Files/2.%20New%20Project/6.%20Arrange%20Act%20Assert/01.jpg "New Project - Pattern3AAATest.java")

2. Добавить в файл **Pattern3AAATest.java** код.

* метод **dnsTest** - тест

Код метода из файла **Pattern2PageFactoryTest.java**.

```java
@Test
public void dnsTest() {
    // ***** Стартовая страница сайта DNS *****
    StartPagePF startPage = new StartPagePF(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPagePF smartphonesPage = new SmartphonesPagePF(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    String company = "Samsung"; // производитель
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    String ram = "8 Гб"; // объем ОП
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон" *****
    SmartphoneProductPagePF smartphoneProductPage = new SmartphoneProductPagePF(driver);
    String actual = smartphoneProductPage.getPageTitle();

    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

3. Изменить код разделив его на секции в соответствии с паттерном **Arrange Act Assert**.

* метод **dnsTest** - тест

```java
@Test
public void dnsTest() {
    // 1. Arrange
    String company = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
	// ***** Стартовая страница сайта DNS *****
    StartPagePF startPage = new StartPagePF(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

	// ***** Страница "Смартфоны" *****
    SmartphonesPagePF smartphonesPage = new SmartphonesPagePF(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон" *****
    SmartphoneProductPagePF smartphoneProductPage = new SmartphoneProductPagePF(driver);
    String actual = smartphoneProductPage.getPageTitle();

    // 3. Assert
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

4. Выделить действия секции **Act** в отдельный метод **getProductPage**.

* метод **dnsTest** - тест

```java
@Test
public void dnsTest() {
    // 1. Arrange
    String company = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPagePF smartphoneProductPage = getProductPage(company, ram);
    String actual = smartphoneProductPage.getPageTitle();

    // 3. Assert
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

* метод **getProductPage** - получение страницы с продуктом

```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPagePF getProductPage(String company, String ram) {
    // ***** Стартовая страница сайта DNS *****
    StartPagePF startPage = new StartPagePF(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPagePF smartphonesPage = new SmartphonesPagePF(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон" *****
    return new SmartphoneProductPagePF(driver);
}
```

## 6.2. Полный код Pattern3AAATest.java

[Pattern3AAATest.java](_Sample/src/test/java/tests/smartphones/Pattern3AAATest.java)

## 6.3. Запуск автотеста

Шаги:

1. Запустить тест командой **mvn clean test** с параметром **-Dtest=Pattern3AAATest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Arrange%20Act%20Assert/02.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Arrange%20Act%20Assert/03.jpg "New Maven Project - Запуск теста")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Arrange%20Act%20Assert/04.jpg "New Maven Project - Лог запуска")

## 6.4. Что изменилось и какая польза?

Применив данный паттерн удалось добиться:

* разделение действий по настройке от основных действий и действий проверки
* обеспечение определенного порядка (стандарта) при написании тестов
* упрощение рефакторинга и ревью кода

***

# 7. Паттерн Матчеры (Assert Objects / Matchers)

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать пакет Java **matchers** в папке **./src/test/java/tests/smartphones**.

![New Maven Project - pages](./_Files/2.%20New%20Project/7.%20Assert%20Objects%20-%20Matchers/01.jpg "New Project - pages")

## 7.1. Класс SmartphoneProductPageMatcher

***SmartphoneProductPageMatcher*** - класс матчер.

Шаги:

1. Создать файл **SmartphoneProductPageMatcher.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - SmartphoneProductPageMatcher.java](./_Files/2.%20New%20Project/7.%20Assert%20Objects%20-%20Matchers/02.jpg "New Project - SmartphoneProductPageMatcher.java")

2. Добавить в файл **SmartphoneProductPageMatcher.java** код.

* объявление ссылки на страницу с продуктом

```java
// Страница "Продукт. Смартфон"
SmartphoneProductPagePF page;
```

* конструктор

```java
// Конструктор
public SmartphoneProductPageMatcher(SmartphoneProductPagePF page) {
    this.page = page;
}
```

* метод **pageTitleEquals** - проверка (матчер) соответствия заголовка страницы

```java
// Проверка / Утверждение (Матчер)
public void pageTitleEquals(String expected) {
    String actual = page.getPageTitle();
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

## 7.2. Полный код SmartphoneProductPageMatcher.java

[SmartphoneProductPageMatcher.java](_Sample/src/test/java/tests/smartphones/SmartphoneProductPageMatcher.java)

## 7.3. Класс Pattern4AOTest

***Pattern4AOTest*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**
с применением паттернов:

* **Page Object Model**
* **PageFactory**
* **Arrange Act Assert**
* **Assert Objects / Matchers**

Класс **Pattern4AOTest** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **Pattern4AOTest.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - Pattern4AOTest.java](./_Files/2.%20New%20Project/7.%20Assert%20Objects%20-%20Matchers/03.jpg "New Project - Pattern4AOTest.java")

2. Добавить в файл **Pattern4AOTest.java** код.

* метод **dnsTest** - тест

Код метода из файла **Pattern3AAATest.java**.

```java
@Test
public void dnsTest() {
    // 1. Arrange
    String company = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPagePF smartphoneProductPage = getProductPage(company, ram);
    String actual = smartphoneProductPage.getPageTitle();

    // 3. Assert
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

* метод **getProductPage** - получение страницы с продуктом

Код метода из файла **Pattern3AAATest.java**.

```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPagePF getProductPage(String company, String ram) {
    // ***** Стартовая страница сайта DNS *****
    StartPagePF startPage = new StartPagePF(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPagePF smartphonesPage = new SmartphonesPagePF(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон" *****
    return new SmartphoneProductPagePF(driver);
}
```

3. Изменить код использовав матчер **SmartphoneProductPageMatcher** для проверки в соответствии с паттерном **Assert Objects / Matchers**.

* метод **dnsTest** - тест

```java
@Test
public void dnsTest() {
    // 1. Arrange
    String company = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPagePF smartphoneProductPage = getProductPage(company, ram);

    // 3. Assert
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    SmartphoneProductPageMatcher smartphoneProductPageMatcher = new SmartphoneProductPageMatcher(smartphoneProductPage);
    smartphoneProductPageMatcher.pageTitleEquals(expected);
}
```

## 7.4. Полный код Pattern4AOTest.java

[Pattern4AOTest.java](_Sample/src/test/java/tests/smartphones/Pattern4AOTest.java)

## 7.5. Запуск теста

Шаги:

1. Запустить тест командой **mvn clean test** с параметром **-Dtest=Pattern4AOTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20Assert%20Objects%20-%20Matchers/04.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20Assert%20Objects%20-%20Matchers/05.jpg "New Maven Project - Запуск теста")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20Assert%20Objects%20-%20Matchers/06.jpg "New Maven Project - Лог запуска")

## 7.6. Что изменилось и какая польза?

Применение паттерна улучшает понимание проверок.

***

# 8. Паттерн Элементы страницы (Page Elements)

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать пакет Java **elements** в папке **./src/test/java**.

![New Maven Project - elements](./_Files/2.%20New%20Project/8.%20Page%20Elements/01.jpg "New Project - elements")

## 8.1. Класс BaseElement

***BaseElement*** - базовый класс для всех элементов интерфейса страниц.
Содержит ссылку на экземпляр **WebElement** и базовый конструктор.
В базовый конструктор передается ссылка на экземпляр драйвера, выполняется поиск элемента.

От данного класса наследуются все классы моделирующие конкретные типы элементов интерфейса страницы.

Шаги:

1. Создать файл **BaseElement.java** в **./src/test/java/elements**.

![New Maven Project - BaseElement.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/02.jpg "New Project - BaseElement.java")

2. Добавить в файл **BaseElement.java** код.

* объявление ссылки на экземпляр **WebElement**

```java
// Веб элемент
protected WebElement webElement;
```

* конструктор базового класса

```java
// Конструктор класса
public BaseElement(WebElement webElement) {
    this.webElement = webElement;
}
```

* метод **getWebElement** - получение оборачиваемого экземпляра класса **WebElement**

```java
// Получение оборачиваемого веб элемента
// Получив оборачиваемый веб элемент, можно вызвать его методы
// Например, getText()
public WebElement getWebElement() {
    return webElement;
}
```

## 8.2. Полный код BaseElement.java

[BaseElement.java](_Sample/src/test/java/elements/BaseElement.java)

## 8.3. Класс Button

***Button*** - класс моделирующий элемент интерфейса **Кнопка**.

Класс **Button** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Button.java** в **./src/test/java/elements**.

![New Maven Project - Button.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/03.jpg "New Project - Button.java")

2. Наследоваться от класса **BaseElement**

```java
public class Button extends BaseElement {
    
}
```

3. Добавить в файл **Button.java** код.

* конструктор класса

```java
// Конструктор
public Button(WebElement webElement) {
    super(webElement);
}
```

* метод **click** - нажатие на кнопку

```java
// Нажатие на кнопку
public void click() {
    // Ожидание кликабельности кнопки
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

## 8.4. Полный код Button.java

[Button.java](_Sample/src/test/java/elements/Button.java)

## 8.5. Класс TextBox

***TextBox*** - класс моделирующий элемент интерфейса **Текстовое поле ввода**.

Класс **TextBox** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **TextBox.java** в **./src/test/java/elements**.

![New Maven Project - TextBox.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/04.jpg "New Project - TextBox.java")

2. Наследоваться от класса **BaseElement**

```java
public class TextBox extends BaseElement {
    
}
```

3. Добавить в файл **TextBox.java** код.

* конструктор класса

```java
// Конструктор
public TextBox(WebElement webElement) {
    super(webElement);
}
```

* метод **click** - нажатие на текстовое поле ввода

```java
// Нажатие на текстовое поле ввода
public void click() {
    // Ожидание кликабельности флажка текстового поля ввода
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

* метод **setValue** - ввод значения в текстовое поле ввода

```java
// Ввод значения в текстовое поле ввода
public void setValue(String value) {
    // Ожидание кликабельности флажка текстового поля ввода
    WaitHelper.clickabilityOfElement(webElement);
    webElement.sendKeys(value);
}
```

## 8.6. Полный код TextBox.java

[TextBox.java](_Sample/src/test/java/elements/TextBox.java)

## 8.7. Класс CheckBox

***CheckBox*** - класс моделирующий элемент интерфейса **Флажок**.

Класс **CheckBox** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **CheckBox.java** в **./src/test/java/elements**.

![New Maven Project - CheckBox.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/05.jpg "New Project - CheckBox.java")

2. Наследоваться от класса **BaseElement**

```java
public class CheckBox extends BaseElement {
    
}
```

3. Добавить в файл **CheckBox.java** код.

* конструктор класса

```java
// Конструктор
public CheckBox(WebElement webElement) {
    super(webElement);
}
```

* метод **setChecked** - установка флажка

```java
// Установка флажка
public void setChecked(boolean value) {
    if (value != isChecked()) {
	    // Ожидание кликабельности флажка
	    WaitHelper.clickabilityOfElement(webElement);
	    webElement.click();
    }
}
```

* метод **isChecked** - проверка, что флажок установлен

```java
// Проверка, что флажок установлен
public boolean isChecked() {
    return webElement.isSelected();
}
```

## 8.8. Полный код CheckBox.java

[CheckBox.java](_Sample/src/test/java/elements/CheckBox.java)

## 8.9. Класс RadioButton

***RadioButton*** - класс моделирующий элемент интерфейса **Переключатель**.

Класс **RadioButton** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **RadioButton.java** в **./src/test/java/elements**.

![New Maven Project - RadioButton.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/06.jpg "New Project - RadioButton.java")

2. Наследоваться от класса **BaseElement**

```java
public class RadioButton extends BaseElement {
    
}
```

3. Добавить в файл **RadioButton.java** код.

* конструктор класса

```java
// Конструктор
public RadioButton(WebElement webElement) {
    super(webElement);
}
```

* метод **setSelected** - установка переключателя

```java
// Установка переключателя
public void setSelected(boolean value) {
    if (value != isSelected()) {
	    // Ожидание кликабельности переключателя
	    WaitHelper.clickabilityOfElement(webElement);
	    webElement.click();
    }
}
```

* метод **isSelected** - проверка, что переключатель установлен

```java
// Проверка, что переключатель установлен
public boolean isSelected() {
    return webElement.isSelected();
}
```

## 8.10. Полный код RadioButton.java

[RadioButton.java](_Sample/src/test/java/elements/RadioButton.java)

## 8.11. Класс Link

***Link*** - класс моделирующий элемент интерфейса **Ссылка**.

Класс **Link** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Link.java** в **./src/test/java/elements**.

![New Maven Project - Link.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/07.jpg "New Project - Link.java")

2. Наследоваться от класса **BaseElement**

```java
public class Link extends BaseElement {
    
}
```

3. Добавить в файл **Link.java** код.

* конструктор класса

```java
// Конструктор
public Link(WebElement webElement) {
    super(webElement);
}
```

* метод **click** - нажатие на ссылку

```java
// Нажатие на ссылку
public void click() {
    // Ожидание кликабельности ссылки
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

* метод **focusOnLink** - наведение курсора мыши на ссылку

```java
// Наведение курсора мыши на ссылку 
public void focusOnLink() {
    ActionHelper.moveToElement(webElement);
}
```

* метод **openInNewWindow** - открытие ссылки в новом окне

```java
// Открытие ссылки в новом окне
public void openInNewWindow() {
    // Получение URL ссылки
    String URL = this.getURL();
    // Создание нового окна и переключение на него
    SwitchHelper.switchToNewWindow();
    // Максимизация размеров окна
    WindowHelper.maximizeWindow();
    // Переход по ссылке в новом окне
    NavigationHelper.navigateTo(URL);
}
```

* метод **getURL** - получение URL ссылки

```java
// Получение URL ссылки
public String getURL() {
    return webElement.getAttribute("href");
}
```

* метод **getText** - получение текста ссылки

```java
// Получение текста ссылки
public String getText() {
    return webElement.getText();
}
```

## 8.12. Полный код Link.java

[Link.java](_Sample/src/test/java/elements/Link.java)

## 8.13. Класс Accordeon

***Accordeon*** - класс моделирующий элемент интерфейса **Гармошка**.

Класс **Accordeon** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Accordeon.java** в **./src/test/java/elements**.

![New Maven Project - Accordeon.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/08.jpg "New Project - Accordeon.java")

2. Наследоваться от класса **BaseElement**

```java
public class Accordeon extends BaseElement {
    
}
```

3. Добавить в файл **Accordeon.java** код.

* конструктор класса

```java
// Конструктор
public Accordeon(WebElement webElement) {
    super(webElement);
}
```

* метод **show** - раскрытие гармошки

```java
// Раскрытие гармошки
public void show() {
    // Ожидание кликабельности гармошки
    WaitHelper.clickabilityOfElement(webElement);
    webElement.click();
}
```

## 8.14. Полный код Accordeon.java

[Accordeon.java](_Sample/src/test/java/elements/Accordeon.java)

## 8.15. Класс Block

***Block*** - класс моделирующий элемент интерфейса **Блок**.

Класс **Block** расширяет класс **BaseElement**.

Шаги:

1. Создать файл **Block.java** в **./src/test/java/elements**.

![New Maven Project - Block.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/09.jpg "New Project - Block.java")

2. Наследоваться от класса **BaseElement**

```java
public class Block extends BaseElement {
    
}
```

3. Добавить в файл **Block.java** код.

* конструктор класса

```java
// Конструктор
public Block(WebElement webElement) {
    super(webElement);
}
```

* метод **hide** - скрытие блока

```java
// Скрытие блока
public void hide() {
    JavaScriptHelper.displayNone(webElement);
}
```

## 8.16. Полный код Block.java

[MainBlock.java](_Sample/src/test/java/elements/Block.java)

## 8.17. Класс StartPagePFPE

Теперь применим паттерн в наших страницах.
Для того чтобы увидеть разницу, создадим отдельные классы страниц с элементами.

***StartPagePFPE*** - класс моделирующий объекты **Стартовой страницы** сайта 
[dns-shop.ru](https://www.dns-shop.ru/).

Класс **StartPagePFPE** расширяет класс **BasePage**.

Шаги:

1. Создать файл **StartPagePFPE.java** в **./src/test/java/pages**.

![New Maven Project - StartPagePFPE.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/10.jpg "New Project - StartPagePFPE.java")

2. Наследоваться от класса **BasePage**

```java
public class StartPagePFPE extends BasePage {
    
}
```

3. Добавить в файл **StartPagePFPE.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(StartPagePFPE.class);
```

* объявление константы хранящей URL **Стартовой страницы** сайта [DNS](https://www.dns-shop.ru/)

```java
// URL страницы
private final String URL = "https://www.dns-shop.ru/";
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// Кнопка "Всё верно" на всплывашке
@FindBy(xpath = "(//span[text()=\"Всё верно\"]/parent::button)[1]")
private WebElement buttonYes;
// Ссылка "Смартфоны и гаджеты"
@FindBy(xpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[1]")
private WebElement linkSmartsAndGadgets;
// Ссылка "Смартфоны"
@FindBy(xpath = "(//a[contains(text(), \"Смартфоны и гаджеты\")])[2]/following::div/a")
private WebElement linkSmarts;
```

* конструктор класса

```java
// Конструктор класса
public StartPagePFPE(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* метод **getURL** - получение URL страницы

```java
// Получение URL страницы
public String getURL() {
    return this.URL;
}
```

* метод **openPage** - открытие страницы

```java
// Открытие страницы
public void openPage() {
    driver.get(this.URL);
    logger.info("Открыта страница https://www.dns-shop.ru/");
}
```

* метод **buttonYes** - кнопка **Всё верно**

```java
// Кнопка "Всё верно" на всплывашке
public Button buttonYes() {
    return new Button(buttonYes);
}
```

* метод **linkSmartsAndGadgets** - ссылка **Смартфоны и гаджеты**

```java
// Ссылка "Смартфоны и гаджеты"
public Link linkSmartsAndGadgets() {
    return new Link(linkSmartsAndGadgets);
}
```

* метод **linkSmarts** - ссылка **Смартфоны**

```java
// Ссылка "Смартфоны"
public Link linkSmarts() {
    return new Link(linkSmarts);
}
```

## 8.18. Полный код StartPagePFPE.java

[StartPagePFPE.java](_Sample/src/test/java/pages/StartPagePFPE.java)

## 8.19. Класс SmartphonesPagePFPE

***SmartphonesPagePFPE*** - класс моделирующий объекты страницы **Смартфоны**.

Класс **SmartphonesPagePFPE** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphonesPagePFPE.java** в **./src/test/java/pages**.

![New Maven Project - SmartphonesPagePFPE.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/11.jpg "New Project - SmartphonesPagePFPE.java")

2. Наследоваться от класса **BasePage**

```java
public class SmartphonesPagePFPE extends BasePage {
    
}
```

3. Добавить в файл **SmartphonesPagePFPE.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphonesPagePFPE.class);
```

* объявление списка веб элементов

```java
// ***** Веб элементы *****
// 1. Блоки
// Шапка
@FindBy(xpath = "//header")
private WebElement blockHeader;
// 2. Фильтры и сортировка
// 2.1. Сортировка
// Аккордеон "Сортировка"
@FindBy(xpath = "//span[contains(text(), \"Сортировка:\")]/following::a")
private WebElement accordeonSort;
// Переключатели "Сортировка"
@FindBy(xpath = "(//div[@class=\"top-filter__radio-list ui-radio top-filter__popover\"])[1]//span")
private List<WebElement> radiobuttonSort;
// 2.2. Фильтр "Производитель"
// Аккордеон "Производитель"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Производитель\"]")
private WebElement accordeonCompany;
// Чекбоксы "Производитель"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Производитель\"]/../../div//label/span[1]")
private List<WebElement> checkboxCompany;
// 2.3. Фильтр "Объем оперативной памяти"
// Аккордеон "Объем оперативной памяти"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Объем оперативной памяти\"]")
private WebElement accordeonRAM;
// Чекбоксы "Объем оперативной памяти"
@FindBy(xpath = "//span[@class=\"ui-collapse__link-text\" and text()=\"Объем оперативной памяти\"]/../../div//label/span[1]")
private List<WebElement> checkboxRAM;
// Кнопка "Применить"
@FindBy(xpath = "//button[contains(text(), \"Применить\")]")
private WebElement buttonApply;
// 3. Список смартфонов
// Ссылка на первый продукт в списке
@FindBy(xpath = "(//a[contains(@class, \"catalog-product__name\")])[1]")
private WebElement linkFirstProduct;
```

* конструктор класса

```java
// Конструктор класса
public SmartphonesPagePFPE(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

* метод **blockHeader** - шапка

```java
// Шапка
public Block blockHeader() {
    return new Block(blockHeader);
}
```

* метод **accordeonSort** - аккордеон **Сортировка**

```java
// Аккордеон "Сортировка"
public Accordeon accordeonSort() {
    return new Accordeon(accordeonSort);
}
```

* метод **radiobuttonSort** - переключатели **Сортировка**

```java
// Переключатели "Сортировка"
public RadioButton radiobuttonSort(String type) {
    for (WebElement webElement : radiobuttonSort) {
	    if(webElement.getText().contains(type)) {
	    	return new RadioButton(webElement);
	    }
    }
    return null;
}
```

* метод **accordeonCompany** - аккордеон "Производитель"

```java
// Аккордеон "Производитель"
public Accordeon accordeonCompany() {
    return new Accordeon(accordeonCompany);
}
```

* метод **checkboxCompany** - чекбоксы "Производитель"

```java
// Чекбоксы "Производитель"
public CheckBox checkboxCompany(String company) {
    for (WebElement webElement : checkboxCompany) {
	    if(webElement.getText().contains(company)) {
	    	return new CheckBox(webElement);
	    }
    }
    return null;
}
```

* метод **accordeonRAM** - аккордеон "Объем оперативной памяти"

```java
// Аккордеон "Объем оперативной памяти"
public Accordeon accordeonRAM() {
    return new Accordeon(accordeonRAM);
}
```

* метод **checkboxRAM** - чекбоксы "Объем оперативной памяти"

```java
// Чекбоксы "Объем оперативной памяти"
public CheckBox checkboxRAM(String ram) {
    for (WebElement webElement : checkboxRAM) {
	    if(webElement.getText().contains(ram)) {
	    	return new CheckBox(webElement);
	    }
    }
    return null;
}
```

* метод **buttonApply** - кнопка **Применить**

```java
// Кнопка "Применить"
public Button buttonApply() {
    return new Button(buttonApply);
}
```

* метод **linkFirstProductClick** - ссылка на первый продукт в списке

```java
// Ссылка на первый продукт в списке
public Link linkFirstProduct() {
    return new Link(linkFirstProduct);
}
```

## 8.20. Полный код SmartphonesPagePFPE.java

[SmartphonesPagePFPE.java](_Sample/src/test/java/pages/SmartphonesPagePFPE.java)

## 8.21. Класс SmartphoneProductPagePFPE (Страница "Продукт. Смартфон")

***SmartphoneProductPagePFPE*** - класс моделирующий объекты страницы **Продукт. Смартфон**.

Класс **SmartphoneProductPagePFPE** расширяет класс **BasePage**.

Шаги:

1. Создать файл **SmartphoneProductPagePFPE.java** в **./src/test/java/pages**.

![New Maven Project - SmartphoneProductPagePFPE.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/12.jpg "New Project - SmartphoneProductPagePFPE.java")

2. Наследоваться от класса **BasePage**

```java
public class SmartphoneProductPagePFPE extends BasePage {
    
}
```

3. Добавить в файл **SmartphoneProductPagePFPE.java** код.

* объявление логгера

```java
// Логгер
private Logger logger = LogManager.getLogger(SmartphoneProductPagePFPE.class);
```

* конструктор класса

```java
// Конструктор класса
public SmartphoneProductPagePFPE(WebDriver driver) {
    // Вызов родительского конструктора
    super(driver);
    // Инициализация веб элементов
    PageFactory.initElements(driver, this);
}
```

## 8.22. Полный код SmartphoneProductPagePFPE.java

[SmartphoneProductPagePFPE.java](_Sample/src/test/java/pages/SmartphoneProductPagePFPE.java)

## 8.23. Класс SmartphoneProductPageMatcherPFPE

***SmartphoneProductPageMatcherPFPE*** - класс матчер.

Шаги:

1. Создать файл **SmartphoneProductPageMatcherPFPE.java** в **./src/test/java/tests/smartphones/matchers**.

![New Maven Project - SmartphoneProductPageMatcherPFPE.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/13.jpg "New Project - SmartphoneProductPageMatcherPFPE.java")

2. Добавить в файл **SmartphoneProductPageMatcherPFPE.java** код.

* объявление ссылки на страницу с продуктом

```java
// Страница "Продукт. Смартфон"
SmartphoneProductPagePFPE page;
```

* конструктор

```java
// Конструктор
public SmartphoneProductPageMatcher(SmartphoneProductPagePFPE page) {
    this.page = page;
}
```

* метод **pageTitleEquals** - проверка (матчер) соответствия заголовка страницы

```java
// Проверка / Утверждение (Матчер)
public void pageTitleEquals(String expected) {
    String actual = page.getPageTitle();
    Assertions.assertEquals(expected, actual, "Ошибка! Заголовок страницы не соответствует ожидаемому!");
}
```

## 8.24. Полный код SmartphoneProductPageMatcherPFPE.java

[Pattern5PETest.java](_Sample/src/test/java/tests/smartphones/matchers/SmartphoneProductPageMatcherPFPE.java)

## 8.25. Класс Pattern5PETest

***Pattern5PETest*** - класс содержащий тесты с проверками страницы **Продукт. Смартфон**
с применением паттернов:

* **Page Object Model**
* **PageFactory**
* **Page Elements**
* **Arrange Act Assert**
* **Assert Objects / Matchers**

Класс **Pattern5PETest** расширяет класс **BaseTest**.

Шаги:

1. Создать файл **Pattern5PETest.java** в **./src/test/java/tests/smartphones**.

![New Maven Project - Pattern5PETest.java](./_Files/2.%20New%20Project/8.%20Page%20Elements/14.jpg "New Project - Pattern5PETest.java")

2. Наследоваться от класса **BaseElement**

```java
public class Pattern5PETest extends BaseTest {
    
}
```

3. Добавить в файл **Pattern5PETest.java** код.

*  метод **dnsTest** - тест

Код метода из файла **Pattern4AOTest.java**.

```java
@Test
public void dnsTest() {
    // 1. Arrange
    String company = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPagePF smartphoneProductPage = getProductPage(company, ram);

    // 3. Assert
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    SmartphoneProductPageMatcher smartphoneProductPageMatcher = new SmartphoneProductPageMatcher(smartphoneProductPage);
    smartphoneProductPageMatcher.pageTitleEquals(expected);
}
```

* метод **getProductPage** - получение страницы с продуктом

Код метода из файла **Pattern4AOTest.java**.

```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPagePF getProductPage(String company, String ram) {
    // ***** Стартовая страница сайта DNS *****
    StartPagePF startPage = new StartPagePF(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgetsMove();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmartsClick();

    // ***** Страница "Смартфоны" *****
    SmartphonesPagePF smartphonesPage = new SmartphonesPagePF(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSortClick();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSortClick(type);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    smartphonesPage.checkboxCompanyClick(company);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAMClick();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.checkboxRAMClick(ram);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApplyClick();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProductClick("Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый");

    // ***** Страница "Продукт. Смартфон" *****
    return new SmartphoneProductPagePF(driver);
}
```

4. Изменить код использовав матчер **SmartphoneProductPageMatcherPFPE** для проверки в соответствии с паттерном **Assert Objects / Matchers**.

*  метод **dnsTest** - тест

```java
@Test
public void dnsTest() {
    // 1. Arrange
    String company = "Samsung"; // производитель
    String ram = "8 Гб"; // объем ОП

    // 2. Act
    SmartphoneProductPagePFPE smartphoneProductPage = getProductPage(company, ram);

    // 3. Assert
    // Проверка заголовка открытой страницы
    String expected = "Купить 6.8\" Смартфон Samsung Galaxy S22 Ultra 128 ГБ белый в интернет магазине DNS. Характеристики, цена Samsung Galaxy S22 Ultra | 4900422";
    SmartphoneProductPageMatcherPFPE smartphoneProductPageMatcher = new SmartphoneProductPageMatcherPFPE(smartphoneProductPage);
    smartphoneProductPageMatcher.pageTitleEquals(expected);
}
```

* метод **getProductPage** - получение страницы с продуктом

```java
// Получение заголовка страницы с продуктом
public SmartphoneProductPagePFPE getProductPage(String company, String ram) {
    // ***** Стартовая страница сайта DNS *****
    StartPagePFPE startPage = new StartPagePFPE(driver);
    // Открыть страницу https://www.dns-shop.ru/
    startPage.openPage();
    // Наведение курсора мыши на ссылку "Смартфоны и гаджеты"
    startPage.linkSmartsAndGadgets().focusOnLink();
    // Нажатие на ссылку "Смартфоны"
    startPage.linkSmarts().click();

    // ***** Страница "Смартфоны" *****
    SmartphonesPagePFPE smartphonesPage = new SmartphonesPagePFPE(driver);
    // Отображение сортировки
    smartphonesPage.accordeonSort().show();
    // Установка сортировки "Сначала дорогие"
    String type = "Сначала дорогие";
    smartphonesPage.radiobuttonSort(type).setSelected(true);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Установка фильтра "Производитель"
    smartphonesPage.checkboxCompany(company).setChecked(true);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Отображение фильтра "Объем оперативной памяти"
    smartphonesPage.accordeonRAM().show();
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 400);
    // Установка фильтра "Объем оперативной памяти"
    smartphonesPage.checkboxRAM(ram).setChecked(true);
    // Прокрутка страницы вниз
    JavaScriptHelper.scrollBy(0, 600);
    // Нажатие на кнопку "Применить"
    smartphonesPage.buttonApply().click();
    // Прокрутка страницы вверх
    JavaScriptHelper.scrollBy(0, -2000);
    // Нажатие на ссылку первого продукта в списке
    smartphonesPage.linkFirstProduct().openInNewWindow();

    // ***** Страница "Продукт. Смартфон" *****
    return new SmartphoneProductPagePFPE(driver);
}
```

## 8.26. Полный код Pattern5PETest.java

[Pattern5PETest.java](_Sample/src/test/java/tests/smartphones/Pattern5PETest.java)

## 8.27. Запуск теста

Шаги:

1. Запустить тест командой **mvn clean test** с параметром **-Dtest=Pattern5PETest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/8.%20Page%20Elements/15.jpg "New Maven Project - Запуск теста")

2. Готово!

В результате будет выполнен тест.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/8.%20Page%20Elements/16.jpg "New Maven Project - Запуск теста")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/8.%20Page%20Elements/17.jpg "New Maven Project - Лог запуска")

## 8.28. Что изменилось и какая польза?

Применение паттерна обеспечивает четкое понимание того с каким 
типом веб элементов придется работать и какие действия с ним можно будет совершить.
Также уменьшается дублирование кода, так как повторяющиеся действия будут вынесены в отдельные классы.

***

[![Лекция](https://img.shields.io/badge/-Лекция-ee99ff)](1.%20Лекция.md)
[![Главная](https://img.shields.io/badge/-Главная-aaccee)](README.md)
[![Задание](https://img.shields.io/badge/-Задание-99ffee)](3.%20Задание.md)