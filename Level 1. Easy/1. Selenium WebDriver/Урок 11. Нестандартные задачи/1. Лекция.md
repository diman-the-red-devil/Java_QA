Java_QA / Level 1. Easy - Основы / 1.1. Selenium WebDriver / Урок 12. Нестандартные задачи

[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](2.%20Практика.md)

***

# Цвета

private final Color HEX_COLOUR = Color.fromString("#2F7ED8");
private final Color RGB_COLOUR = Color.fromString("rgb(255, 255, 255)");
private final Color RGB_COLOUR = Color.fromString("rgb(40%, 20%, 40%)");
private final Color RGBA_COLOUR = Color.fromString("rgba(255, 255, 255, 0.5)");
private final Color RGBA_COLOUR = Color.fromString("rgba(40%, 20%, 40%, 0.5)");
private final Color HSL_COLOUR = Color.fromString("hsl(100, 0%, 50%)");
private final Color HSLA_COLOUR = Color.fromString("hsla(100, 0%, 50%, 0.5)");
private final Color TRANSPARENT = Color.fromString("transparent");

# Выполнение JS

executeAsyncScript()
executeScript()
Скроллинг
Загрузка файлов
Видеоплеер
Веб сторадже
Select select = new Select(<WebElement object>);
selectByVisibleText()
selectByIndex()
selectByValue()

deselectByVisibleText()
deselectByIndex()
deselectByValue()
deselectAll()

getOptions()
getAllSelectedOptions()
getFirstSelectedOption()

***

# 4. BasicAuth


***

Иногда в тестировании появляется необходимость сравнивать изображения. Например, для для проверки загруженных иконок и изображений на сайте или для сравнения базового лэйаута на странице с текущим.

Webdriver обладает функционалом для снятия скриншотов, однако он не может сравнивать изображения. Для этого надо писать собственные расширения. В качестве примера рассмотрим следующий вспомогательный класс:

import java.awt.Image;
import java.awt.Toolkit;
import java.awt.image.PixelGrabber;

public class CompareUtil {
public enum Result { Matched, SizeMismatch, PixelMismatch };
static Result CompareImage(String baseFile, String actualFile) {
Result compareResult = Result.PixelMismatch;
Image baseImage = Toolkit.getDefaultToolkit().getImage(baseFile);
Image actualImage = Toolkit.getDefaultToolkit().
getImage(actualFile);
try {
PixelGrabber baseImageGrab = new PixelGrabber(baseImage, 0, 0, -1, -1, false);
PixelGrabber actualImageGrab = new PixelGrabber(actualImage, 0, 0, -1, -1, false);
int[] baseImageData = null;
int[] actualImageData = null;
if(baseImageGrab.grabPixels()) {
int width = baseImageGrab.getWidth();
int height = baseImageGrab.getHeight();
baseImageData = new int[width * height];
baseImageData = (int[])baseImageGrab.getPixels();
}
if(actualImageGrab.grabPixels()) {
int width = actualImageGrab.getWidth();
int height = actualImageGrab.getHeight();
actualImageData = new int[width * height];
actualImageData = (int[])actualImageGrab.getPixels();
}
System.out.println(baseImageGrab.getHeight() + "<>" +
actualImageGrab.getHeight());
System.out.println(baseImageGrab.getWidth() + "<>" +
actualImageGrab.getWidth());
if ((baseImageGrab.getHeight() != actualImageGrab.getHeight()) || (baseImageGrab.getWidth() != actualImageGrab.getWidth())){
compareResult = Result.SizeMismatch;
}
else if(java.util.Arrays.equals(baseImageData,actualImageData)){
compareResult = Result.Matched;
}
} catch (Exception e) {
e.printStackTrace();
}
return compareResult;
}
}
Пример теста с использованием этого класса:

import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.*;
import org.apache.commons.io.FileUtils;
import org.junit.*;
import static org.junit.Assert.*;
import java.io.File;

public class ScreenShotTest {
public WebDriver driver;
private StringBuffer verificationErrors = new StringBuffer();

    @Before
    public void setUp() throws Exception {
        // Create a new instance of the Firefox driver
        driver = new FirefoxDriver();
    }

    @Test
    public void imageCompareTest() throws Exception {
        String scrFile = "FILE_PATH";
        String baseScrFile = "BASE_FILE_PATH";
        // Заходим на страницу
        driver.get(URL);
        File screenshotFile = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
        FileUtils.copyFile(screenshotFile, new File(scrFile));
        try {
            //Сравниваем изображение с базовым
            assertEquals(CompareUtil.Result.Matched, CompareUtil.CompareImage(baseScrFile, scrFile));
        } catch (Error e) {
            // Сохраняем ошибки в переменную
            verificationErrors.append(e.toString());
        }
    }

    @After
    public void tearDown() throws Exception {
        //Закрываем браузер
        driver.quit();
        String verificationErrorString = verificationErrors.toString();
        if (!"".equals(verificationErrorString)) {
            fail(verificationErrorString);
        }
    }
}

***


Практика [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](2.%20Практика.md)

## Platform

**Platform** - перечисление определяющее типы платформ.

Константы перечисления *Platform*

| Тип           | Описание         | 
|---------------|------------------|
| ANDROID       | Android          |
| ANY           | Любая            |
| BIG_SUR       | macOS            |
| CATALINA      | macOS            |
| EL_CAPITAN    | macOS            |
| HIGH_SIERRA   | macOS            |
| IOS           | iOS              |
| LINUX         | Linux            |
| MAC           | macOS            |
| MAVERICKS     | macOS            |
| MOJAVE        | macOS            |
| MOUNTAIN_LION | macOS            |
| SIERRA        | macOS            |
| SNOW_LEOPARD  | macOS            |
| UNIX          | Unix             |
| VISTA         | Windows          |
| WIN10         | Windows          |
| WIN8          | Windows          |
| WIN8_1        | Windows          |
| WINDOWS       | Windows          |
| XP            | Windows          |
| YOSEMITE      | macOS            |

Методы перечисления *Platform*

| Тип      | Метод                                                   | Описание                                                 | 
|----------|---------------------------------------------------------|----------------------------------------------------------|
| Platform | extractFromSysProperty​(String osName)                   | извлечение платформы (ОС) на основе системной переменной |
| Platform | extractFromSysProperty​(String osName, String osVersion) | извлечение платформы (ОС) на основе системной переменной |
| Platform | family()                                                | получение семейства текущей платформы (ОС)               |
| Platform | fromString​(String name)                                 | получение платформы (ОС) по имени                        |
| Platform | getCurrent()                                            | получение текущей версии платформы (ОС)                  |
| int      | getMajorVersion()                                       | получение мажорной версии платформы (ОС)                 |
| int      | getMinorVersion()                                       | получение минорной версии платформы (ОС)                 |

[selenium/docs/api : Platform](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/Platform.html)

DevTools - 

| Тип         | Метод                          | Описание                      | 
|-------------|--------------------------------|-------------------------------|
| <X> void | addListener​(Event<X> event, Consumer<X> handler) |  |
| void        | clearListeners()             | |
| void        | close()    |     |
| void        | createSession() |       |
| void      |		createSessionIfThereIsNotOne()   |       |
| SessionID | getCdpSession()                 | получение геолокации           |
| Domains | getDomains()   | установка геолокации           |
| <X> X | 	send​(Command<X> command)  | установка геолокации           |

LocalStorage - интерфейс 

| Тип         | Метод                          | Описание                      | 
|-------------|--------------------------------|-------------------------------|
| void | 	clear() |  |
| String        | getItem​(String key)  | |
| Set<String>        | keySet()    |     |
| String        | removeItem​(String key) |       |
| void      |		setItem​(String key, String value)   |       |
| int | 	size()  |      |

[LocalStorage](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/html5/LocalStorage.html)

SessionStorage - интерфейс

| Тип         | Метод                          | Описание                      | 
|-------------|--------------------------------|-------------------------------|
| void | 	clear() |  |
| String        | getItem​(String key)  | |
| Set<String>        | keySet()    |     |
| String        | removeItem​(String key) |       |
| void      |		setItem​(String key, String value)   |       |
| int | 	size()  |      |

[SessionStorage](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/html5/SessionStorage.html)

Location

| Тип         | Метод                          | Описание                      | 
|-------------|--------------------------------|-------------------------------|
| double	|getAltitude()	 |
|  double	|getLatitude()	 |
|  double	|getLongitude()	 |
|  String	|toString()|

[Location](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/html5/Location.html)



##### Класс FirefoxBinary

**FirefoxBinary** - класс представляющий настройки для драйвера FirefoxDriver.

Методы класса *FirefoxBinary*

| Тип                     | Метод                                       | Описание                         | 
|--------------|------------------------------------------|------------------------------------------------|
| void         | addCommandLineOptions​(String... options) | параметры командной строки при запуске Firefox |
| List<String> | getExtraOptions()                        | получение дополнительных параметров            |
| File         | getFile()                                | получение файла                                |
| String       | getPath()                                | получение пути                                 |

[selenium/docs/api : FirefoxOptions](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/firefox/FirefoxOptions.html)

##### Класс FirefoxProfile

**FirefoxProfile** - класс представляющий профиль Firefox.

Методы класса *FirefoxProfile*

| Тип     | Метод                                                      | Описание                                 | 
|---------|------------------------------------------------------------|------------------------------------------|
| void    | addExtension​(File extensionToInstall)                      | установка расширений при запуске Firefox |
| void    | addExtension​(Class<?> loadResourcesUsing, String loadFrom) | установка расширений при запуске Firefox |
| void    | addExtension​(String key, Extension extension)              | установка расширений при запуске Firefox |
| void    | clean​(File profileDir)                                     | очистка директории                       |
| boolean | containsWebDriverExtension()                               | проверка на наличие расширений           |
| void    | deleteExtensionsCacheIfItExists​(File profileDir)           | удаление расширений кеша                 |
| void    | getAdditionalPreferences()                                 | получение дополнительных preferences     |
| void    | getBooleanPreference​(String key, boolean defaultValue)     | получение preferences                    |
| int     | getIntegerPreference​(String key, int defaultValue)         | получение preferences                    |
| String  | getStringPreference​(String key, String defaultValue)       | получение preferences                    |
| void    | installExtensions​(File parentDir)                          | установка расширений                     |
| void    | setPreference​(String key, Object value)                    | установка preferences                    |
| void    | updateUserPrefs​(File userPrefs)                            | обновление preferences                   |

[selenium/docs/api : FirefoxProfile](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/firefox/FirefoxProfile.html)

##### Перечисление FirefoxDriverLogLevel

**FirefoxDriverLogLevel** - перечисление представляющее уровень логгирования FirefoxDriver.

Константы перечисления *FirefoxDriverLogLevel*

| Тип     | Описание         | 
|---------|------------------|
| CONFIG  |                  |	 
| DEBUG	  |                  |
| ERROR	  |                  |
| FATAL	  |                  |
| INFO	  |                  |
| TRACE	  |                  |
| WARN    |                  |

Методы класса *FirefoxDriverLogLevel*

| Тип                   | Метод                   | Описание               | 
|-----------------------|-------------------------|------------------------|
| FirefoxDriverLogLevel | fromLevel​(Level level)  | из уровня логгирования |
| FirefoxDriverLogLevel | fromString​(String text) | из строки              |

[selenium/docs/api : FirefoxDriverLogLevel](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/firefox/FirefoxDriverLogLevel.html)