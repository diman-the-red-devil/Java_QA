# Java_QA / Level 1. Easy - Основы / 1.1. Selenium WebDriver / Урок 05. Конфигурация

[![Назад](https://img.shields.io/badge/-%D0%9D%D0%B0%D0%B7%D0%B0%D0%B4-brightgreen)](1.%20Лекция.md)
[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](3.%20Задание.md)

***

## 1. Открытие предыдущего проекта

Шаги:

1). Запустить IntelliJ IDEA.

2). Открыть проект прошлого урока в IntelliJ IDEA.

![New Maven Project - Open...](./_Files/2.%20New%20Project/01.jpg "New Maven Project - Open...")

***

## 2. Конфигурирование браузера при старте

### 2.1. Работа с куками

Шаги:

1). Создать файл **CookiesTest.java** в **./src/test/java**.

![New Maven Project - CookiesTest.java](./_Files/2.%20New%20Project/02.jpg "New Maven Project - CookiesTest.java")

2). Добавить в файл код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(CookiesTest.class);
```

* метод *setUp*

```java
@BeforeEach
public void setUp() {
    logger.info("env = " + env);
    driver = WebDriverFactory.getDriver(env.toLowerCase());
    logger.info("Драйвер стартовал!");
}
```

* метод *setDown*

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

* метод *cookiesTest*

```java
@Test
public void cookiesTest(){
    driver.get("https://yandex.ru/");
    logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

    // Добавляем задержку sleep чтобы увидеть результат
    try {
    Thread.sleep(10000);
    } catch (InterruptedException e) {
    e.printStackTrace();
    }
}
```

* создание куки *Cookie 1* и вывод информации по нему в методе *cookiesTest*

```java
logger.info("Куки, которое добавили мы");
driver.manage().addCookie(new Cookie("Cookie 1", "This Is Cookie 1"));
Cookie cookie1  = driver.manage().getCookieNamed("Cookie 1");
logger.info(String.format("Domain: %s", cookie1.getDomain()));
logger.info(String.format("Expiry: %s",cookie1.getExpiry()));
logger.info(String.format("Name: %s",cookie1.getName()));
logger.info(String.format("Path: %s",cookie1.getPath()));
logger.info(String.format("Value: %s",cookie1.getValue()));
logger.info("--------------------------------------");
```

* вывод информации по кукам yandex.ru в методе *cookiesTest*

```java
logger.info("Куки, которое добавил Yandex");
Set<Cookie> cookies = driver.manage().getCookies();
for(Cookie cookie : cookies) {
    logger.info(String.format("Domain: %s", cookie.getDomain()));
    logger.info(String.format("Expiry: %s", cookie.getExpiry()));
    logger.info(String.format("Name: %s", cookie.getName()));
    logger.info(String.format("Path: %s", cookie.getPath()));
    logger.info(String.format("Value: %s", cookie.getValue()));
    logger.info("--------------------------------------");
}
```

3). Запустить тест командой **mvn clean test** с параметром -Dtest=CookiesTest

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/02.jpg "New Maven Project - Запуск теста")

4). Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/04.jpg "New Maven Project - Лог запуска")

***

### 2.2. Итоговый код класса CookiesTest.java

```java
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.Cookie;
import org.openqa.selenium.WebDriver;

import java.util.Set;

public class CookiesTest {
    protected static WebDriver driver;
    private Logger logger = LogManager.getLogger(CookieTest.class);

    // Читаем передаваемый параметр browser (-Dbrowser)
    String env = System.getProperty("browser", "chrome");

    @BeforeEach
    public void setUp() {
        logger.info("env = " + env);
        driver = WebDriverFactory.getDriver(env.toLowerCase());
        logger.info("Драйвер стартовал!");
    }

    @Test
    public void cookiesTest() {
        driver.get("https://yandex.ru/");
        logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

        logger.info("Куки, которое добавили мы");
        driver.manage().addCookie(new Cookie("Cookie 1", "This Is Cookie 1"));
        Cookie cookie1  = driver.manage().getCookieNamed("Cookie 1");
        logger.info(String.format("Domain: %s", cookie1.getDomain()));
        logger.info(String.format("Expiry: %s",cookie1.getExpiry()));
        logger.info(String.format("Name: %s",cookie1.getName()));
        logger.info(String.format("Path: %s",cookie1.getPath()));
        logger.info(String.format("Value: %s",cookie1.getValue()));
        logger.info("--------------------------------------");

        logger.info("Куки, которое добавил Yandex");
        Set<Cookie> cookies = driver.manage().getCookies();
        for(Cookie cookie : cookies) {
            logger.info(String.format("Domain: %s", cookie.getDomain()));
            logger.info(String.format("Expiry: %s", cookie.getExpiry()));
            logger.info(String.format("Name: %s", cookie.getName()));
            logger.info(String.format("Path: %s", cookie.getPath()));
            logger.info(String.format("Value: %s", cookie.getValue()));
            logger.info("--------------------------------------");
        }

        // Добавляем задержку sleep чтобы увидеть результат
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @AfterEach
    public void setDown() {
        if(driver != null) {
            driver.quit();
            logger.info("Драйвер остановлен!");
        }
    }
}
```

***

### 2.3. Работа с логами

Шаги:

1). Создать файл **LogsTest.java** в **./src/test/java**.

![New Maven Project - LogsTest.java](./_Files/2.%20New%20Project/05.jpg "New Maven Project - LogsTest.java")

2). Добавить в файл код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(LogsTest.class);
```

* метод *setUp* аналогично *2. Работа с куками*

* метод *setDown* аналогично *2. Работа с куками*

* метод *logsTest* 

```java
@Test
public void logsTest() {
    driver.get("https://yandex.ru/");
    logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

    // Добавляем задержку sleep чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

* вывод логов в методе *logsTest*

```java
logger.info("Логи браузера");
Logs logs = driver.manage().logs();
LogEntries logEntries = logs.get(LogType.BROWSER);
for (LogEntry logEntry : logEntries) {
    logger.info(String.format("%s", logEntry.getMessage()));
}
logger.info("--------------------------------------");
```

3). Запустить тест командой **mvn clean test** с параметром -Dtest=LogsTest

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/06.jpg "New Maven Project - Запуск теста")

4). Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/07.jpg "New Maven Project - Лог запуска")

***

### 2.4. Итоговый код класса LogsTest.java

```java
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.logging.LogEntries;
import org.openqa.selenium.logging.LogEntry;
import org.openqa.selenium.logging.LogType;
import org.openqa.selenium.logging.Logs;

public class LogsTest {
    protected static WebDriver driver;
    private Logger logger = LogManager.getLogger(LogsTest.class);

    // Читаем передаваемый параметр browser (-Dbrowser)
    String env = System.getProperty("browser", "chrome");

    @BeforeEach
    public void setUp() {
        logger.info("env = " + env);
        driver = WebDriverFactory.getDriver(env.toLowerCase());
        logger.info("Драйвер стартовал!");
    }

    @Test
    public void logsTest() {
        driver.get("https://yandex.ru/");
        logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

        logger.info("Логи браузера");
        Logs logs = driver.manage().logs();
        LogEntries logEntries = logs.get(LogType.BROWSER);
        for (LogEntry logEntry : logEntries) {
            logger.info(String.format("%s", logEntry.getMessage()));
        }
        logger.info("--------------------------------------");

        // Добавляем задержку sleep чтобы увидеть результат
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @AfterEach
    public void setDown() {
        if(driver != null) {
            driver.quit();
            logger.info("Драйвер остановлен!");
        }
    }
}
```

***

### 2.5. Работа с ожиданиями

Шаги:

1). Создать файл **TimeOutsTest.java** в **./src/test/java**.

![New Maven Project - TimeOutsTest.java](./_Files/2.%20New%20Project/08.jpg "New Maven Project - TimeOutsTest.java")

2). Добавить в файл код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(LogsTest.class);
```

* метод *setUp* аналогично *2. Работа с куками*

* метод *setDown* аналогично *2. Работа с куками*

* метод *timeOutsTest1*

```java
@Test
public void timeOutsTest1() {
    driver.manage().timeouts().pageLoadTimeout(60, TimeUnit.SECONDS);
    driver.get("https://yandex.ru/");
    logger.info("Открыта страница Yandex - " + "https://yandex.ru/");
}
```

Ожидание загрузки страницы в 60 секунд

Страница успеет загрузиться, ошибки не возникнет.

3). Запустить тест командой **mvn clean test** с параметром -Dtest=TimeOutsTest#timeOutsTest1

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/09.jpg "New Maven Project - Запуск теста")

4). Готово!

В результате будет выполнен тест.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/10.jpg "New Maven Project - Лог запуска")

5). Добавить в файл код.

* метод *timeOutsTest2*

```java
@Test
public void timeOutsTest2() {
    driver.manage().timeouts().pageLoadTimeout(1, TimeUnit.MILLISECONDS);
    driver.get("https://yandex.ru/");
    logger.info("Открыта страница Yandex - " + "https://yandex.ru/");
}
```

Ожидание загрузки страницы в 1 миллисекунду.

Страница не успеет загрузиться, возникнет исключение **org.openqa.selenium.TimeoutException**.

6). Запустить тест командой **mvn clean test** с параметром -Dtest=TimeOutsTest#timeOutsTest2

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/11.jpg "New Maven Project - Запуск теста")

7). Готово!

В результате будет тест упадет с ошибкой - исключение TimeoutException.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/12.jpg "New Maven Project - Лог запуска")

### 2.6. Итоговый код класса TimeOutsTest.java

```java
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

import java.util.concurrent.TimeUnit;

public class TimeOutsTest {
    protected static WebDriver driver;
    private Logger logger = LogManager.getLogger(LogsTest.class);

    // Читаем передаваемый параметр browser (-Dbrowser)
    String env = System.getProperty("browser", "chrome");

    @BeforeEach
    public void setUp() {
        logger.info("env = " + env);
        driver = WebDriverFactory.getDriver(env.toLowerCase());
        logger.info("Драйвер стартовал!");
    }

    @Test
    public void timeOutsTest() {
        // driver.manage().timeouts().pageLoadTimeout(60, TimeUnit.SECONDS);
        driver.manage().timeouts().pageLoadTimeout(1, TimeUnit.MILLISECONDS);
        driver.get("https://yandex.ru/");
        logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

        String searchText = "Java";

        // Ввод текста для поиска
        String searchInputXpath = ".//input[@class='input__control input__input mini-suggest__input']";
        WebElement searchInput = driver.findElement(By.xpath(searchInputXpath));
        searchInput.sendKeys(searchText);
        logger.info(String.format("В поле поиска введен текст %s", searchText));

        // Нажатие кнопка "Найти"
        String searchButtonXpath = ".//button[@class='button mini-suggest__button button_theme_websearch button_size_ws-head i-bem button_js_inited']";
        WebElement searchButton = driver.findElement(By.xpath(searchButtonXpath));
        searchButton.click();
        logger.info("Нажата кнопка \"Найти\"");

        // Добавляем задержку sleep чтобы увидеть результат
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @AfterEach
    public void setDown() {
        if(driver != null) {
            driver.quit();
            logger.info("Драйвер остановлен!");
        }
    }
}
```

### 2.7. Настройка окон браузера

Шаги:

1). Создать файл **BrowserWindowsTest.java** в **./src/test/java**.

![New Maven Project - BrowserWindowsTest.java](./_Files/2.%20New%20Project/13.jpg "New Maven Project - BrowserWindowsTest.java")

2). Добавить в файл код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(LogsTest.class);
```

* метод *setUp* аналогично *2. Работа с куками*

* метод *setDown* аналогично *2. Работа с куками*

* метод *browserWindowsTest*

```java
@Test
public void browserWindowsTest() {
    driver.get("https://yandex.ru/");
    logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

    // Добавляем задержку sleep чтобы увидеть результат
    try {
    Thread.sleep(10000);
    } catch (InterruptedException e) {
    e.printStackTrace();
    }
}
```

* отображение окна браузера в полноэкранном режиме в методе *browserWindowsTest*

```java
driver.manage().window().fullscreen();
```

* отображение размеров окна браузера в методе *browserWindowsTest*

```java
logger.info(String.format("Browser Window Height: %d", driver.manage().window().getSize().getHeight()));
logger.info(String.format("Browser Window Width: %d", driver.manage().window().getSize().getWidth()));
```

3). Запустить тест командой **mvn clean test** с параметром -Dtest=BrowserWindowsTest

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/14.jpg "New Maven Project - Запуск теста")

4). Готово!

В результате будет выполнен тест.

Окно браузера отобразится в полноэкранном режиме.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/15.jpg "New Maven Project - Лог запуска")

### 2.8. Итоговый код класса TimeOutsTest.java

```java
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.WebDriver;

public class BrowserWindowsTest {
    protected static WebDriver driver;
    private Logger logger = LogManager.getLogger(CookieTest.class);

    // Читаем передаваемый параметр browser (-Dbrowser)
    String env = System.getProperty("browser", "chrome");

    @BeforeEach
    public void setUp() {
        logger.info("env = " + env);
        driver = WebDriverFactory.getDriver(env.toLowerCase());
        logger.info("Драйвер стартовал!");
    }

    @Test
    public void browserWindowsTest() {
        driver.manage().window().fullscreen();
        driver.get("https://yandex.ru/");
        logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

        logger.info(String.format("Browser Window Height: %d", driver.manage().window().getSize().getHeight()));
        logger.info(String.format("Browser Window Width: %d", driver.manage().window().getSize().getWidth()));

        // Добавляем задержку sleep чтобы увидеть результат
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @AfterEach
    public void setDown() {
        if(driver != null) {
            driver.quit();
            logger.info("Драйвер остановлен!");
        }
    }
}
```

## 3. Кофигурирование свойств браузера Google Chrome

Шаги:

1). Создать файл **BrowserOptionsTest.java** в **./src/test/java**.

![New Maven Project - BrowserOptionsTest.java](./_Files/2.%20New%20Project/16.jpg "New Maven Project - BrowserOptionsTest.java")

2). Добавить в файл код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(LogsTest.class);
```

* метод *setDown* аналогично *2. Работа с куками*

* метод *browserOptionsTest*

```java
@Test
public void browserOptionsTest() {
    driver.get("https://yandex.ru/");
    logger.info("Открыта страница Yandex - " + "https://yandex.ru/");

    // Ввод текста для поиска
    String searchInputXpath = 
        ".//input[@class='input__control input__input mini-suggest__input']";
    WebElement searchInput = driver.findElement(By.xpath(searchInputXpath));
    String searchText = "Java";
    searchInput.sendKeys(searchText);

    // Нажатие кнопка "Найти"
    String searchButtonXpath = 
        ".//button[@class='button mini-suggest__button button_theme_websearch button_size_ws-head i-bem button_js_inited']";
    WebElement searchButton = driver.findElement(By.xpath(searchButtonXpath));
    searchButton.click();

    // Добавляем задержку sleep чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3). Добавить метод *getDriver* в класс **BrowserOptionsTest.java**.

* добавить свойства браузера *Google Chrome* (настройки сессии)

Есть несколько способов:

1. с помощью класса **DesiredCapabilities** (устаревший способ)

```java
DesiredCapabilities capabilities = new DesiredCapabilities();
capabilities.setCapability("platform", "windows");
capabilities.setCapability("unexpectedAlertBehaviour", "dismiss");
capabilities.setCapability("javascriptEnabled", false);
capabilities.setCapability("acceptInsecureCerts", false);
capabilities.setCapability("pageLoadStrategy", "normal");
return new ChromeDriver(capabilities);
```

2. с помощью класса **ChromeOptions** (правильный способ)

```java
ChromeOptions options = new ChromeOptions();
options.setCapability(CapabilityType.PLATFORM_NAME, Platform.WINDOWS);
options.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.DISMISS);
options.setCapability(CapabilityType.SUPPORTS_JAVASCRIPT, false);
options.setAcceptInsecureCerts(false);
options.setPageLoadStrategy(PageLoadStrategy.NORMAL);
return new ChromeDriver(options);
```

При этом сами *capabilities* можно задавать также двумя способами:

1. с помощью строк

```java
capabilities.setCapability("platform", "windows");
```

2. с помощью констант перечисления **CapabilityType**

```java
options.setCapability(CapabilityType.PLATFORM_NAME, Platform.WINDOWS);
```

* добавить аргументы запуска *Google Chrome*

```java
options.addArguments("--start-maximized");
options.addArguments("--incognito");
```

4). Добавить метод *setUp* в класс **BrowserOptionsTest.java**.

```java
@BeforeEach
public void setUp() {
    driver = getDriver();
    logger.info("Драйвер стартовал!");
}
```

5). Запустить тест командой **mvn clean test** с параметром -Dtest=BrowserOptionsTest

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/17.jpg "New Maven Project - Запуск теста")

6). Готово!

В результате будет выполнен тест.

Окно браузера отобразится в полноэкранном режиме в режиме "инкогнито".

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/18.jpg "New Maven Project - Лог запуска")

***

Задание [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](3.%20Задание.md)