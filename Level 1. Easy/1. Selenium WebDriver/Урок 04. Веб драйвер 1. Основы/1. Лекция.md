# Java_QA / Level 1. Easy - Основы / 1.1. Selenium WebDriver / Урок 04. Веб драйвер 1. Основы

[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](2.%20Практика.md)

***

***Selenium Webdriver*** - инструмент для автоматизации реального браузера, как локально, так и удаленно, наиболее близко имитирующий действия пользователя.

Для работы с Webdriver необходимо 3 основных программных компонента:

* **браузер** (браузер, работу которого нужно автоматизировать) 

Это реальный браузер определенной версии, установленный на определенной ОС и имеющий свои настройки (по умолчанию или кастомные). 
На самом деле Webdriver может работать и с ненастоящими браузерами, но подробно о них позже.

* **драйвер браузера** (программа для управления браузером) 

Драйвер на самом деле является веб сервером, который запускает браузер и отправляет ему команды, а также закрывает его. 
У каждого браузера свой драйвер. Связано это с тем, что у каждого браузера свои отличные команды управления и реализованы они по-своему. 
Найти список доступных драйверов и ссылки для скачивания можно на официальном сайте Selenium проекта.

* **скрипт/тест** (набор команд на определенном языке программирования для драйвера браузера) 

Такие скрипты используют готовые клиентские библиотеки, которые доступны пользователям на различных языках.

***

### WebDriver

**WebDriver** - интерфейс для удаленного управления браузером.

### Основные команды веб драйвера

| Тип  | Метод           | Описание                                                                     | 
|------|-----------------|------------------------------------------------------------------------------|
| void | close()         | закрытие текущего окна, выход из браузера (если было открыто последнее окно) |
| void | get​(String url) | загрузка новой страницы в текущем окне браузера                              |
| void | quit()          | выход из драйвера, закрытие всех окон браузера                               |

### Команды веб драйвера для поиска веб элементов

| Тип              | Метод               | Описание                                                     | 
|------------------|---------------------|--------------------------------------------------------------|
| WebElement       | findElement​(By by)  | поиск элемента (возвращает первый найденный элемент)         |
| List<WebElement> | findElements​(By by) | поиск всех элементов (возвращает список найденных элементов) |

### Команды веб драйвера для получения свойств текущей страницы веб элементов

| Тип               | Метод           | Описание                          | 
|-------------------|-----------------|-----------------------------------|
| String            | getCurrentUrl() | получение строки URL страницы     |
| String            | getPageSource() | получение исходного кода страницы |
| String            | getTitle()      | получение заголовка страницы      |

### Команды веб драйвера для навигации

| Тип                     | Метод              | Описание                              | 
|-------------------------|--------------------|---------------------------------------|
| String                  | getWindowHandle()  | получение окна                        |
| Set<String>             | getWindowHandles() | получение всех окон                   |
| WebDriver.TargetLocator | switchTo()         | управление переключением между окнами |
| WebDriver.Navigation    | navigate()         | управление историей браузера          |

### Команды веб драйвера для управляения свойствами и настройками браузера

| WebDriver.Options | manage()        | управление свойствами и настройками браузера   |

***

## 2. Запуск разных браузеров

### 2.1. Драйверы браузеров

У каждого браузера есть свой драйвер, с которым данный браузер взаимодействует. Он представляет собой исполняемый файл. 
И для того чтобы WebDriver мог взаимодействовать с драйвером браузера, необходимо прописать путь до исполняемого файла.

```java
System.setProperty("webdriver.ie.driver", "src/test/resources/drivers/IEDriverServer.exe");
```

Если же используется WebDriverManager то делать этого не нужно.

Совместимость драйверов и браузеров:

* **Google Chrome**

    * драйвер от Google - **chromedriver**
    * только последняя версия 
    * поддержка предыдущих версий

* **Microsoft Intenet Explorer/Edge**

    * Edge драйвер от Microsoft - **edgedriver**
    * IE 9 - 11 драйвер от Selenium
    * IE 8- драйвер не поддерживается

* **Mozilla Firefox**

    * Firefox 49+ драйвер от Mozilla - **geckodriver**
    * Firefox 48 драйвер не поддерживается
    * Firefox 4 - 47 драйвер от Selenium
    * Firefox 3- драйвер не поддерживается
    
* **Apple Safari**

    * Safari 10 драйвер от Apple - **safaridriver**
    * Safari 6 - 9 драйвер от Selenium
    * Safari 5- драйвер не поддерживается

* **Opera**

    * Opera 15+ драйвер от Opera - **operchromiumdriver**
    * Opera 11 - 12 драйвер OperaPrestoDriver
    * Opera 10- драйвер не поддерживается

### 2.2. Инициализация WebDriver

Чтобы работать с каким то из драйверов нужно в коде инициализировать соответствующий WebDriver

#### ChromiumDriver

**ChromiumDriver** - класс для управления браузерами на основе Chromium.

Реализует интерфейс WebDriver.

Методы класса *ChromiumDriver*

| Тип         | Метод                          | Описание                      | 
|-------------|--------------------------------|-------------------------------|
| Map<String, Object> | executeCdpCommand​(String commandName, Map<String, Object> parameters)      | исполнение команды Chrome DevTools Protocol и получение результата |
| DevTools        | getDevTools()             | получение экземпляра класса DevTools|
| LocalStorage        | 	getLocalStorage()    | получение локального хранилища     |
| SessionStorage        | getSessionStorage() | получение хранилища сессии        |
| void      |	launchApp​(String id)   | запуск приложения Chrome      |
| Location | location()                  | получение геолокации           |
| void | setLocation​(Location location)                | установка геолокации           |

**Google Chrome**

```java
public class ChromeBrowser {
    public WebDriver getDriver() {
        WebDriverManager.chromedriver().setup();
        return new ChromeDriver();
    }
}
```

**Microsoft Edge**

```java
public class EdgeBrowser {
    public WebDriver getDriver() {
        WebDriverManager.edgedriver().setup();
        return new EdgeDriver();
    }
}
```

#### InternetExplorerDriver

InternetExplorerDriver

| Тип           | Метод                          | Описание                      | 
|---------------|--------------------------------|-------------------------------|
|void	        |setFileDetector​(FileDetector detector)	| Set the file detector to be used when sending keyboard input.|

[InternetExplorerDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/ie/InternetExplorerDriver.html)

**Microsoft Intenet Explorer** 

```java
public class ExplorerBrowser {
    public WebDriver getDriver() {
        WebDriverManager.iedriver().setup();
        return new InternetExplorerDriver();
    }
}
```

#### FirefoxDriver

FirefoxDriver

| Тип           | Метод                          | Описание                      | 
|---------------|--------------------------------|-------------------------------|
|<X> X	        |getFullPageScreenshotAs​(OutputType<X> outputType) |	 Capture the full page screenshot and store it in the specified location.|
|LocalStorage	|getLocalStorage()	 ||
|SessionStorage	|getSessionStorage()||	 
|String	        |installExtension​(Path path)|	Installs an extension.|
|void	        |setFileDetector​(FileDetector detector)	| Set the file detector to be used when sending keyboard input.|
|void	        |uninstallExtension​(String extensionId)|	 Uninstall the extension by the given identifier.|

[FirefoxDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/firefox/FirefoxDriver.html)

**Mozilla Firefox**

```java
public class FirefoxBrowser {
    public WebDriver getDriver() {
        WebDriverManager.firefoxdriver().setup();
        return new FirefoxDriver(options);
    }
}
```

#### OperaDriver

OperaDriver

| Тип           | Метод                          | Описание                      | 
|---------------|--------------------------------|-------------------------------|
|LocalStorage	|getLocalStorage()	 ||
|SessionStorage	|getSessionStorage()||	 
|String	        |installExtension​(Path path)|	Installs an extension.|
|void	        |setFileDetector​(FileDetector detector)	| Set the file detector to be used when sending keyboard input.|
|void	        |uninstallExtension​(String extensionId)|	 Uninstall the extension by the given identifier.|

[FirefoxDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/firefox/FirefoxDriver.html)

**Opera**

```java
public class FirefoxBrowser {
    public WebDriver getDriver() {
        WebDriverManager.operadriver().setup();
        return new OperaDriver();
    }
}
```

***

## WebDriverFactory



***

Практика [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](2.%20Практика.md)