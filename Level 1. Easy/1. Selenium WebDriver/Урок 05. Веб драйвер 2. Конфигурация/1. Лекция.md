# Java_QA / Level 1. Easy - Основы / 1.1. Selenium WebDriver / Урок 05. Веб драйвер 2. Конфигурация

[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](2.%20Практика.md)

***

## 1. Конфигурирование браузера при старте

### Зачем нужно конфигурировать браузер при старте?

Вот несколько типовых случаев когда нужно конфигурировать браузер:

* запуск в определенном разрешении (для отладки **резинового** дизайна)
* запуск в полноразмерном экране
* конфигурирование timeout (page load, execute javascript, implicity)
* работа с cookies
* специфические вещи (режим эмулятора, логи и т.д.)

### Интерфейс WebDriver.Options

**WebDriver.Options** - интерфейс для управления настройками браузера.

**WebDriver.manage()** - реализация интерфейса WebDriver.Options.

Данный интерфейс позволяет:

* работать с куками
* получать логи
* настраивать таймауты
* настраивать окно браузера

#### Куки (Cookie)

***Ку́ки*** (англ. cookie, буквально — печенье) — небольшой фрагмент данных, отправленный веб-сервером и хранимый на компьютере пользователя. 

Веб-клиент (обычно веб-браузер) всякий раз при попытке открыть страницу соответствующего сайта пересылает этот фрагмент данных веб-серверу в составе HTTP-запроса. 
Применяется для сохранения данных на стороне пользователя, на практике обычно используется для:

* аутентификации пользователя
* хранения персональных предпочтений и настроек пользователя
* отслеживания состояния сеанса доступа пользователя
* сведения статистики о пользователях

##### Интерфейс WebDriver.Options

Методы интерфейса *WebDriver.Options*

| Тип         | Метод                          | Описание                      | 
|-------------|--------------------------------|-------------------------------|
| void        | addCookie​(Cookie cookie)       | добавление куки браузеру      |
| void        | deleteAllCookies()             | удаление всех куки из браузера|
| void        | deleteCookie​(Cookie cookie)    | удаление куки из браузера     |
| void        | deleteCookieNamed​(String name) | удаление куки по имени        |
| Cookie      | getCookieNamed​(String name)    | получение куки по имени       |
| Set<Cookie> | getCookies()                   | получение всех куки           |

[selenium/docs/api : WebDriver.Options](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.Options.html)

##### Класс Cookie 

**Cookie** - класс, реализующий куки.

Методы класса *Cookie*

| Тип                 | Метод       | Описание                                     | 
|---------------------|-------------|----------------------------------------------|
| String              | getDomain() | получение домена куки                        |
| Date                | getExpiry() | получение даты окончания срока действия куки |
| String              | getName()   | получение имени куки                         |
| String              | getPath()   | получение URL адреса куки                    |
| String              | getValue()  | получение значения куки                      |
| Map<String,​ Object> | toJson()    | преобразование в JSON объект                 |

[selenium/docs/api : Cookie](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/Cookie.html)

##### Пример

```java
driver.manage().addCookie(new Cookie("key", "value")); 
driver.manage().getCookieNamed("foo") 
driver.manage().getCookies(); 
driver.manage().deleteCookieNamed("test1"); 
```

### Capabilities, DesiredCapabilities, MutableCapabilities и AbstractDriverOptions

Каждый браузер обладает какими либо свойствами, отличными от других браузеров. В тестах бывает полезно использовать эти свойства браузеров. 
Для настройки специфичных свойств существуют специальные интерфейсы и классы под каждый браузер. 

#### Интерфейс Capabilities

**MutableCapabilities** - интерфейс для получения свойств конкретного браузера.

Методы интерфейса *MutableCapabilities*

| Тип         | Метод                                 | Описание                       | 
|-------------|---------------------------------------|--------------------------------|
| String      | getBrowserName()                      | получение имени браузера       |
| String      | getBrowserVersion()                   | получение версии браузера      |
| Object      | getCapability​(String capabilityName)  | получение настройки по имени   |
| Set<String> | getCapabilityNames()                  | получение списка настроек      |
| Platform    | getPlatformName()                     | получение имени платформы (ОС) |

[selenium/docs/api : Capabilities](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/Capabilities.html)

#### Класс DesiredCapabilities

**DesiredCapabilities** - класс для установки свойств браузера.

Данный класс реализует интерфейс *Capabilities*.

Методы класса *DesiredCapabilities*

| Тип                 | Метод                                               | Описание                                     | 
|---------------------|-----------------------------------------------------|----------------------------------------------|
| boolean             | acceptInsecureCerts()                               | проверка просроченных сертификатов           |
| DesiredCapabilities | merge​(Capabilities extraCapabilities)               | мерж настройки                               |
| void                | setAcceptInsecureCerts​(boolean acceptInsecureCerts) | установка проверки просроченных сертификатов |
| void                | setBrowserName​(String browserName)                  | установка имени браузера                     |
| void                | setJavascriptEnabled​(boolean javascriptEnabled)     | установка исполнения скриптов JS             |
| void                | setPlatform​(Platform platform)                      | установка платформы                          |
| void                | setVersion​(String version)                          | установка версии браузера                    |

#### Класс MutableCapabilities

**MutableCapabilities** - класс для управления свойствами конкретного браузера.

Данный класс реализует интерфейс *Capabilities*.

Методы класса *MutableCapabilities*

| Тип                 | Метод                                                | Описание                     | 
|---------------------|------------------------------------------------------|------------------------------|
| Object              | getCapability​(String capabilityName)                 | получение настройки по имени |
| Set<String>         | getCapabilityNames()                                 | получение списка настроек    |
| MutableCapabilities | merge​(Capabilities extraCapabilities)                | мерж настройки               |
| void                | setCapability​(String capabilityName, boolean value)  | установка настройки          |
| void                | setCapability​(String key, Object value)              | установка настройки          |
| void                | setCapability​(String capabilityName, String value)   | установка настройки          |
| void                | setCapability​(String capabilityName, Platform value) | установка настройки          |
| Map<String, Object> | toJson()                                             | преобразование в JSON объект |

[selenium/docs/api : MutableCapabilities](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/MutableCapabilities.html)

#### Класс AbstractDriverOptions<DO extends AbstractDriverOptions>

**AbstractDriverOptions<DO extends AbstractDriverOptions>** - класс для установки дополнительных параметров браузера.

Данный класс наследует и расширяет класс *MutableCapabilities*.

Методы класса *AbstractDriverOptions*

| Тип | Метод                                                           | Описание                                | 
|-----|-----------------------------------------------------------------|-----------------------------------------|
| DO  | setAcceptInsecureCerts​(boolean acceptInsecureCerts)             | установка                               |
| DO  | setPageLoadStrategy​(PageLoadStrategy strategy)                  | установка стратегии загрузки страницы   |
| DO  | setProxy​(Proxy proxy)                                           | установка прокси                        |
| DO  | setStrictFileInteractability​(boolean strictFileInteractability) | установка                               |
| DO  | setUnhandledPromptBehaviour​(UnexpectedAlertBehaviour behaviour) | установка                               |

[selenium/docs/api : AbstractDriverOptions](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/remote/AbstractDriverOptions.html)

##### Перечисление PageLoadStrategy

**PageLoadStrategy** - перечисление определяющее стратегии загрузки страницы.

Константы перечисления *PageLoadStrategy*

| Тип    | Описание         | 
|--------|------------------|
| EAGER  |                  |
| NONE   |                  |
| NORMAL |                  |

[selenium/docs/api : PageLoadStrategy](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/PageLoadStrategy.html)

##### Перечисление UnexpectedAlertBehaviour

**UnexpectedAlertBehaviour** - перечисление определяющее поведение алертов.

Константы перечисления UnexpectedAlertBehaviour

| Тип                | Описание         | 
|--------------------|------------------|
| ACCEPT             |                  |
| ACCEPT_AND_NOTIFY  |                  |
| DISMISS            |                  |
| DISMISS_AND_NOTIFY |                  |
| IGNORE             |                  |

[selenium/docs/api : UnexpectedAlertBehaviour](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/UnexpectedAlertBehaviour.html)

DesiredCapabilities caps = new DesiredCapabilities()
DesiredCapabilities desiredCapabilities = DesiredCapabilities.firefox();
desiredCapabilities.setCapability(CapabilityType.LOGGING_PREFS, logs);
WebDriver driver = new FirefoxDriver(desiredCapabilities);

setCapability()
Shared capabilities
Driver specific capabilities

### 3.4. Option

Непосредственно от AbstractDriverOptions наследуются класс Options для управления различными свойствами драйвера конкретного браузера. 

#### Класс ChromiumOptions<T extends ChromiumOptions>

**ChromiumOptions** - класс представляющий настройки для драйвера ChromiumDriver.

Методы класса *ChromiumOptions*

| Тип | Метод                                            | Описание                                      | 
|-----|--------------------------------------------------|-----------------------------------------------|
| T   | addArguments​(String... arguments)                | добавление параметров при запуске Chrome      |
| T   | addArguments​(List<String> arguments)             | добавление параметров при запуске Chrome      |
| T   | addEncodedExtensions​(String... encoded)          | установка расширений при запуске Chrome       |
| T   | addEncodedExtensions​(List<String> encoded)       | установка расширений при запуске Chrome       |
| T   | addExtensions​(File... paths)                     | установка расширений при запуске Chrome       |
| T   | addExtensions​(List<File> paths)                  | установка расширений при запуске Chrome       |
| T   | setBinary​(File path)                             | установка пути до исполняемого файла Chrome   |
| T   | setBinary​(String path)                           | установка пути до исполняемого файла Chrome   |
| T   | setExperimentalOption​(String name, Object value) | включение экспериментальных функций           |
| T   | setHeadless​(boolean headless)                    | запуск в "безголовом режиме"                  |

[selenium/docs/api : ChromiumOptions](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/chromium/ChromiumOptions.html)

#### Класс ChromeOptions

**ChromeOptions** - класс представляющий настройки для драйвера ChromiumDriver.

Методы класса *ChromeOptions*

| Тип | Метод                                      | Описание                     | 
|-----|--------------------------------------------|------------------------------|
| T   | getLogLevel()                              | получение уровня логирования |
| T   | setLogLevel​(ChromeDriverLogLevel logLevel) | установка уровня логирования |

[selenium/docs/api : ChromeOptions](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/chrome/ChromeOptions.html)

Ниже приведен список доступных и наиболее часто используемых аргументов для класса ChromeOptions:

| Опция                  | Описание                                         |
|------------------------|--------------------------------------------------|
| start-maximized        | открытие Chrome в режиме максимизации            |
| incognito              | открытие Chrome в режиме инкогнито               |
| headless               | открытие Chrome в headless режиме                |
| disable-notifications  | отключение оповещений в Chrome                   |
| disable-extensions     | отключение существующие расширения в Chrome      |
| disable-popup-blocking | отключение отображения всплывающих окон в Chrome |
| disable-infobars       | отключение отображения уведомлений в Chrome      |
| make-default-browser   | делает браузер Chrome стандартным                |
| version                | печатает версию браузера Chrome                  |

[ChromeOptions](https://chromedriver.chromium.org/capabilities)

#### Класс FirefoxOptions

**FirefoxOptions** - класс представляющий настройки для драйвера FirefoxDriver.

Методы класса *FirefoxOptions*

| Тип                     | Метод                                       | Описание                                       | 
|-------------------------|---------------------------------------------|------------------------------------------------|
| FirefoxOptions          | addArguments​(String... arguments)           | добавление параметров при запуске Firefox      |
| FirefoxOptions          | addArguments​(List<String> arguments)        | добавление параметров при запуске Firefox      |
| FirefoxOptions          | addPreference​(String key, Object value)     | установка preferences при запуске Firefox      |
| FirefoxBinary           | getBinary()                                 | получение двоичных данных от Firefox           |
| Optional<FirefoxBinary> | getBinaryOrNull()                           | получение двоичных данных от Firefox           |
| FirefoxProfile          | getProfile()                                | получения профиля Firefox                      |
| FirefoxOptions          | setBinary​(String path)                      | установка пути до исполняемого файла           |
| FirefoxOptions          | setBinary​(Path path)                        | установка пути до исполняемого файла           |
| FirefoxOptions          | setBinary​(FirefoxBinary binary)             | установка пути до исполняемого файла           |
| void                    | setCapability​(String key, Object value)     | установка настройки                            |
| FirefoxOptions          | setHeadless​(boolean headless)               | запуск в "безголовом режиме"                   |
| FirefoxOptions          | setLogLevel​(FirefoxDriverLogLevel logLevel) | установка уровня логгирования                  |
| FirefoxOptions          | setProfile​(FirefoxProfile profile)          | установка профиля Firefox                      |

[selenium/docs/api : FirefoxOptions](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/firefox/FirefoxOptions.html)

#### Класс OperaOptions

**OperaOptions** - класс представляющий настройки для драйвера OperaDriver.

Методы класса *OperaOptions*

| Тип          | Метод                                            | Описание                                    | 
|--------------|--------------------------------------------------|---------------------------------------------|
| OperaOptions | addArguments​(String... arguments)                | добавление параметров при запуске Firefox   |
| OperaOptions | addArguments​(List<String> arguments)             | добавление параметров при запуске Firefox   |
| OperaOptions | addEncodedExtensions​(String... encoded)          | установка расширений при запуске Chrome     |
| OperaOptions | addEncodedExtensions​(List<String> encoded)       | установка расширений при запуске Chrome     |
| OperaOptions | addExtensions​(File... paths)                     | установка расширений при запуске Chrome     |
| OperaOptions | addExtensions​(List<File> paths)                  | установка расширений при запуске Chrome     |
| Object       | getExperimentalOption​(String name)               | получение экспериментальных функций         |
| OperaOptions | setBinary​(File path)                             | установка пути до исполняемого файла Chrome |
| OperaOptions | setBinary​(String path)                           | установка пути до исполняемого файла Chrome |
| OperaOptions | setExperimentalOption​(String name, Object value) | включение экспериментальных функций         |

[selenium/docs/api : OperaOptions](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/opera/OperaOptions.html)

***

Практика [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](2.%20Практика.md)