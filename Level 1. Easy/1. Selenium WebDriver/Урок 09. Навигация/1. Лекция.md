# Java_QA / Level 1. Easy - Основы / 1.1. Selenium WebDriver / Урок 09. Навигация

[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](2.%20Практика.md)

***

# 1. Навигация

## 1.1. Интерфейс WebDriver

Методы интерфейса **WebDriver**:

| Тип                  | Метод      | Описание  | 
|----------------------|------------|-----------|
| WebDriver.Navigation | navigate() | Навигация |

[selenium/docs/api : WebDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.html)

## 1.2. Интерфейс WebDriver.Navigation

***WebDriver.Navigation*** - интерфейс для управления навигацией.

***WebDriver.navigate()*** - реализация интерфейса **WebDriver.Navigation**.

Методы интерфейса **WebDriver.Navigation**:

| Тип  | Метод          | Описание                             | 
|------|----------------|--------------------------------------|
| void | back()         | Перейти Назад на предыдущую страницу |
| void | forward()      | Перейти Вперед на следующую страницу |
| void | refresh()      | Обновить страницу                    |
| void | to(String url) | Загрузить новую страницу             |
| void | to(URL url)    | Загрузить новую страницу             |

[selenium/docs/api : WebDriver.Navigation](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.Navigation.html)

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.navigate().to("https://devqa.io");
driver.navigate().to("https://devqa.io/1");
driver.navigate().back();
driver.navigate().forward();
```

***

# 2. Окно браузера

## 2.1. Интерфейс WebDriver

Методы интерфейса **WebDriver**:

| Тип               | Метод              | Описание                                     | 
|-------------------|--------------------|----------------------------------------------|
| WebDriver.Options | manage()           | Управление свойствами и настройками браузера |

[selenium/docs/api : WebDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.html)

## 2.2. Интерфейс WebDriver.Options

***WebDriver.Options*** - интерфейс для управления настройками браузера.

***WebDriver.manage()*** - реализация интерфейса **WebDriver.Options**.

Методы интерфейса **WebDriver.Options**:

| Тип              | Метод    | Описание                | 
|------------------|----------|-------------------------|
| WebDriver.Window | window() | Настройка окон браузера |

[selenium/docs/api : WebDriver.Options](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.Options.html)

## 2.3. Интерфейс WebDriver.Window

***WebDriver.Window*** - интерфейс представляющий настройки окна браузера.

***WebDriver.manage().window()*** - реализация интерфейса **WebDriver.Window**.

Методы интерфейса **WebDriver.Window**:

| Тип       | Метод                             | Описание                                                             | 
|-----------|-----------------------------------|----------------------------------------------------------------------|
| void      | fullscreen()                      | Перевод текущего окна в полноэкранный режим                          |
| void      | maximize()                        | Максимизировать размер текущего окна                                 |
| void      | minimize()                        | Минимизировать размер текущего окна                                  |
| Point     | getPosition()                     | Получение координат текущего окна отн-но верхнего левого угла экрана |
| Dimension | getSize()                         | Получение размеров текущего окна                                     |
| void      | setPosition(Point targetPosition) | Установить координаты текущего окна                                  |
| void      | setSize(Dimension targetSize)     | Установить размеры текущего окна                                     |

[selenium/docs/api : WebDriver.Window](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.Window.html)

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.manage().window().fullscreen();
```

### 2.3.1. Класс Point

***Point*** - класс представляющий точку с координатами x и y в пространстве.

Методы класса **Point**:

| Тип   | Метод                            | Описание                                 | 
|-------|----------------------------------|------------------------------------------|
| int   | getX()                           | Получение координаты x                   |
| int   | getY()                           | Получение координаты y                   |
| void  | move(int newX, int newY)         | Перемещение в точку с координатами x и y |
| Point | moveBy(int xOffset, int yOffset) | Перемещение в точку с отступами по x и y |

[selenium/docs/api : Point](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/Point.html)

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.manage().window().getPosition().getX();
driver.manage().window().getPosition().getY();
```

### 2.3.2. Класс Dimension

***Dimension*** - класс размеры окна по x и y.

Методы класса **Dimension**:

| Тип   | Метод       | Описание                        | 
|-------|-------------|---------------------------------|
| int   | getHeight() | получение размера по x (ширина) |
| int   | getWidth()  | получение размера по y (высота) |

[selenium/docs/api : Dimension](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/Dimension.html)

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.manage().window().getSize().getWidth();
driver.manage().window().getSize().getHeight();
```

***

# 3. Переключения (Switch)

## 3.1. Интерфейс WebDriver

Методы интерфейса **WebDriver**:

| Тип                     | Метод      | Описание                                     | 
|-------------------------|------------|----------------------------------------------|
| WebDriver.TargetLocator | switchTo() | Управление свойствами и настройками браузера |

[selenium/docs/api : WebDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.html)

## 3.2. Интерфейс WebDriver.TargetLocator

***WebDriver.TargetLocator*** - интерфейс для переключения.

***WebDriver.switchTo()*** - реализация интерфейса **WebDriver.TargetLocator**.

Методы интерфейса **WebDriver.TargetLocator**:

| Тип           | Метод                          | Описание                             | 
|---------------|--------------------------------|-----------------------------------------------------------------------------------------------------|
| WebElement	| activeElement()                | Переключение на текущий активный элемент (в фокусе)                                                 |
| Alert	        | alert()                        | Переключение на текущее активное модальное окно                                                     |
| WebDriver	    | defaultContent()               | Переключение на первый фрейм на странице или основной документ, если страница содержит фреймы       | 
| WebDriver	    | frame(int index)               | Переключение на фрейм по его индексу отчитываемому от нуля                                          |  
| WebDriver	    | frame(String nameOrId)         | Переключение на фрейм по его имени или айди                                                         |
| WebDriver	    | frame(WebElement frameElement) | Переключение на фрейм по элементу                                                                   |
| WebDriver	    | newWindow(WindowType typeHint) | Создание нового окна браузера и переключение на него (для выполнения всех последующих команд)       |
| WebDriver	    | parentFrame()                  | Переключение на родительский контекст                                                               |
| WebDriver	    | window(String nameOrHandle)    | Переключение на окно браузера по его имени или дескриптору (для выполнения всех последующих команд) |

[selenium/docs/api : WebDriver.TargetLocator](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.TargetLocator.html)

### 3.2.1. Активный элемент

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTO().activeElement();
```

### 3.2.2. Модалки (Alert, Prompt, Confirm)

#### 3.2.2.1. Что такое модальные окна (Alert, Prompt и Confirm)?

У браузеров есть возможность взаимодействия с пользователем, через диалоговые (модальные) окна на JS. 
Достигается это с помощью встроенных в браузер функций: **alert**, **prompt** и **confirm**.
Каждый из них вызывает модальное окно, но все они отличны и используются в различных ситуациях.

##### Alert

Функция **alert** предназначена для вывода в браузере модального 
диалогового окна с некоторым сообщением и кнопкой **ОК**.

Функция **alert** используется для предупреждения пользователя о чем-то важном. 
Например, чтобы он не покидал страницу, иначе, введенные им данные не будут сохранены.

##### Prompt

Функция **prompt** предназначен для вывода в браузере модального 
диалогового окна с сообщением, текстовым полем для ввода данных и кнопками **ОК** и **Отмена**.

Функция **prompt** используется для запроса данных, которые пользователю нужно ввести в текстовое поле.
Например, возраст.

##### Confirm

Функция **confirm** предназначен для вывода в браузере модального 
диалогового окна с сообщением и кнопками **ОК** и **Отмена**. 

Функция **confirm** используется для того, чтобы получить от пользователя ответ **ДА** или **НЕТ**. 
В зависимости от ответа команда confirm возвращает булевы значения **true** или **false**.
Например, подтверждения отправки данных.

Мы рассмотрели 3 функции браузера: **alert, prompt и confirm**. Они предназначены для взаимодействия с пользователем. 
Диалоговые окна создаваемые этими методами являются модальными. Это значит, что они блокируют доступ пользователя 
к остальной части страницы пока оно не будет закрыто. 
Кроме этого, они ещё приостанавливают загрузку дальнейшей части страницы.

#### 3.2.2.1. Интерфейс Alert

**Selenium** располагает встроенными средствами для работы с модальными диалоговыми окнами. 
Для этих целей существует интерфейс **Alert**.

***Alert*** - интерфейс для взаимодействия с модалками.

Методы интерфейса **Alert**:

| Тип    | Метод                       | Описание                         | 
|--------|-----------------------------|----------------------------------|
| void	 | accept()	                   | Нажатие кнопки "Ок"              |
| void	 | dismiss()	               | Нажатие кнопки "Отмена"          |
| String | getText()	               | Получение текста модалки         |
| void	 | sendKeys(String keysToSend) | Ввод текста в поле ввода модалки |

[selenium/docs/api : WebDriver.TargetLocator](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/Alert.html)

*Пример*

```java
WebDriver driver = new ChromeDriver();
Alert alert = driver.switchTO().alert()
alert.getText();
alert.sendKeys("Text");
alert.accept();
```

#### 3.2.2.2. Перечисление UnexpectedAlertBehaviour

***UnexpectedAlertBehaviour*** - перечисление определяющее поведение модалок.

Константы перечисления **UnexpectedAlertBehaviour**:

| Тип                | Описание         | 
|--------------------|------------------|
| ACCEPT             |                  |
| ACCEPT_AND_NOTIFY  |                  |
| DISMISS            |                  |
| DISMISS_AND_NOTIFY |                  |
| IGNORE             |                  |

[selenium/docs/api : UnexpectedAlertBehaviour](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/UnexpectedAlertBehaviour.html)

### 3.2.3. Фреймы

#### 3.2.3.1. Что такое фреймы (iframe)?

***Фрейм*** - отдельный законченный HTML-документ, содержащий свою собственную модель страницы (DOM).

***Плавающий фрейм (iframe, inline frame)***, или еще его ***называют встроенный фрейм***, 
может встраиваться в любое место HTML-страницы. 
Для каждого тега \<iframe\> в HTML документе создается **iFrame** объект и 
позволяет загружать в область заданных размеров любые другие независимые документы.

#### 3.2.3.2

Поиск элементов в **Selenium** осуществляется опираясь на **DOM** модель. По умолчанию это всегда **DOM** нашей страницы. 
Для того, чтобы начать работать с контентом фрейма нужно указать драйверу с какой **DOM** моделью необходимо работать. 
Для этого используется метод **switchTo().frame()**.

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().frame(0);
driver.switchTo().frame("frameName");
WebElement iframe = driver.findElement(By.id("theFrame"));
driver.switchTo().frame(iframe);
```

Все фреймы определяются относительно текущего выбранного фрейма.
Если вы переключились во фрейм, то из него можете переключиться:

* во вложенный фрейм используя метод **switchTo().frame()**

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().frame("frame01");
driver.switchTo().frame("frame12");
```

* в родительский фрейм используя метод **switchTo().parentFrame()**

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().frame("frame01");
driver.switchTo().frame("frame12");
driver.switchTo().parentFrame();
```

* в самый верхний уровень иерархии (к модели страницы браузера)

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().defaultContent();
```

Можно получить доступ к дочерним фреймам путем: 

* сцепления вызовов **switchTo()**

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().frame("frame")
      .switchTo().frame("subFrame")
      .switchTo().frame("subSubFrame");
```

* разделения пути точкой

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().frame("frame.subFrame.subSubFrame");
```

NoSuchFrameException - If the given element is neither an IFRAME nor a FRAME element.
StaleElementReferenceException - If the WebElement has gone stale.

### 3.2.4. Окна

#### 3.2.4.1. Что такое дескрипторы?

Для переключения между окнами браузера в **Selenium WebDriver** используется метод **switchTo**, 
как и при работе с алертами или фреймами. Только для окон нет родительского окна, 
в которое можно было бы переключиться по умолчанию. 

Для переключения всегда используется дескриптор окна, поэтому для того, 
чтобы переключиться в первоначально открытое окно, нужно сначала запомнить его дескриптор.

***Дескриптор окна*** - уникальный идентификатор окно, специальное значение, 
которое операционная система присваивает каждому создаваемому окну. 
Прикладная программа использует этот дескриптор в своих функциях, чтобы направить действие на это окно.

## 2.1. Интерфейс WebDriver

Методы интерфейса **WebDriver**:

| Тип               | Метод              | Описание                                     | 
|-------------------|--------------------|----------------------------------------------|
| String            | getWindowHandle()  | Получение дескриптора текущего открытого окна браузера          |
| Set<String>       | getWindowHandles() | Получение дескрипторов всех окон браузера    |

[selenium/docs/api : WebDriver](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WebDriver.html)

*Пример*

```java
WebDriver driver = new ChromeDriver();
Set<String> windows = driver.getWindowHandles();
```

#### 

*Пример*

```java
WebDriver driver = new ChromeDriver();
driver.switchTo().newWindow(WindowType.WINDOW);
```

#### 3.2.4.1. Перечисление WindowType

***WindowType*** - перечисление определяющее тип окна.

Константы перечисления **WindowType**:

| Тип    | Описание         | 
|--------|------------------|
| TAB    |                  |
| WINDOW |                  |

[selenium/docs/api : WindowType](https://www.selenium.dev/selenium/docs/api/java/org/openqa/selenium/WindowType.html)

***

# 5. Исключения

NoAlertPresentException - попытаетесь перехватить диалоговое окно, которого нет

Поэтому если вы не уверены в появлении алерта на странице, будьте готовы перехватить исключение:

protected void safeAlertDissmiss() {
try {
driver.switchTo().alert().dismiss();
} catch (NoAlertPresentException e) {
// ничего не делаем, алерта итак нет
}
}

Безопасно дождаться появления алерта на странице можно используя готовые функции класса ExpectedConditions:

import org.openqa.selenium.Alert;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

WebDriver driver = new FirefoxDriver();
Alert alert = (new WebDriverWait(driver, 10))
.until(ExpectedConditions.alertIsPresent());

NoSuchWindowException - If the window cannot be found

***

Практика [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](2.%20Практика.md)