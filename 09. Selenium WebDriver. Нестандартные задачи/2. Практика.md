Java_QA / 09. Selenium WebDriver. Нестандартные задачи

[![Лекция](https://img.shields.io/badge/-Лекция-ee99ff)](1.%20Лекция.md)
[![Главная](https://img.shields.io/badge/-Главная-aaccee)](README.md)
[![Задание](https://img.shields.io/badge/-Задание-99ffee)](3.%20Задание.md)

***

# Содержание

* [1. Открытие предыдущего проекта](#1-открытие-предыдущего-проекта)
* [2. Стандартные команды Selenium](#2-стандартные-команды-selenium)
  * [2.1. Авторизация Basic Auth](#21-авторизация-basic-auth)
  * [2.2. Отправка файла](#22-отправка-файла)
  * [2.3. Полный код SeleniumTest.java](#23-полный-код-seleniumtestjava)
* [3. Цвета](#3-цвета)
  * [3.1. Получение цвета элемента](#31-получение-цвета-элемента)
  * [3.2. Полный код ColorTest.java](#32-полный-код-colortestjava)
* [4. Печать страницы в PDF](#4-печать-страницы-в-pdf)
  * [4.1. Печать страницы в PDF в формате Base64](#41-печать-страницы-в-pdf-в-формате-base64)
  * [4.2. Печать страницы в PDF в файл](#42-печать-страницы-в-pdf-в-файл)
  * [4.3. Полный код PrintPageTest.java](#43-полный-код-printpagetestjava)
* [5. Веб хранилище](#5-веб-хранилище)
  * [5.1. Локальное хранилище](#51-локальное-хранилище)
  * [5.2. Сессионное хранилище](#52-сессионное-хранилище)
  * [5.3. Полный код WebStorageTest.java](#53-полный-код-webstoragetestjava)
* [6. Решение задач с помощью выполнения JavaScript](#6-решение-задач-с-помощью-выполнения-javascript)
  * [6.1. Клик на веб элемент](#61-клик-на-веб-элемент)
  * [6.2. Вывод текста элементов](#62-вывод-текста-элементов)
  * [6.3. Скроллинг вниз](#63-скроллинг-вниз)
  * [6.4. Изменение прозрачности элемента](#64-изменение-прозрачности-элемента)
  * [6.5. Изменение видимости элемента](#65-изменение-видимости-элемента)
  * [6.6. Изменение отображаемости элемента](#66-изменение-отображаемости-элемента)
  * [6.7. Изменение цвета элемента](#67-изменение-цвета-элемента)
  * [6.8. Полный код JavaScriptTest.java](#68-полный-код-javascripttestjava)
* [7. Решение задач с помощью DevTools](#7-решение-задач-с-помощью-devtools)
  * [7.1. Предоставление прав браузеру на выполнение операций](#71-предоставление-прав-браузеру-на-выполнение-операций)
  * [7.2. Получение данных о браузере](#72-получение-данных-о-браузере)
  * [7.3. Установка параметров эмулируемого устройства](#73-установка-параметров-эмулируемого-устройства)
  * [7.4. Установка геолокации](#74-установка-геолокации)
  * [7.5. Вывод логов](#75-вывод-логов)
  * [7.6. Сбор метрик](#76-сбор-метрик)
  * [7.7. Перехват и модификация запросов](#77-перехват-и-модификация-запросов)
  * [7.8. Эмуляция интернет соединения](#78-эмуляция-интернет-соединения)
  * [7.9. Добавление заголовков в запросы](#79-добавление-заголовков-в-запросы)
  * [7.10. Перехват HTTP запроса](#710-перехват-http-запроса)
  * [7.11. Авторизация Basic Authentication](#711-авторизация-basic-authentication)
  * [7.12. Полный код DevToolsTest.java](#712-полный-код-devtoolstestjava)
* [8. Решение задач с PDF](#8-решение-задач-с-pdf)
  * [8.1. Получение текста файла PDF с помощью библиотеки PdfBox](#81-получение-текста-файла-pdf-с-помощью-библиотеки-pdfbox)
  * [8.2. Получение текста файла PDF с помощью библиотеки iText](#82-получение-текста-файла-pdf-с-помощью-библиотеки-itext)
  * [8.3. Полный код PdfTest.java](#83-полный-код-pdftestjava)

***

# 1. Открытие предыдущего проекта

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Запустить **IntelliJ IDEA**.

2. Открыть проект прошлого урока в **IntelliJ IDEA**.

![New Maven Project - Open...](./_Files/2.%20New%20Project/1.%20Open%20Project/01.jpg "New Maven Project - Open...")

3. Удалить все файлы .java из папки **./src/test/java** кроме **WebDriverFactory.java**

***

# 2. Стандартные команды Selenium

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **SeleniumTest.java** в **./src/test/java**.

![New Maven Project - SeleniumTest.java](./_Files/2.%20New%20Project/2.%20Selenium/01.jpg "New Maven Project - SeleniumTest.java")

2. Добавить в файл **SeleniumTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(SeleniumTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 2.1. Авторизация Basic Auth

Шаги:

1. Открыть файл **SeleniumTest.java** в **./src/test/java**.

2. Добавить в файл **SeleniumTest.java** код.

* метод **basicAuthTest** - авторизация **Basic Auth**

```java
@Test
public void basicAuthTest() {
    // Открыть страницу the-internet.herokuapp.com
    driver.get("https://the-internet.herokuapp.com/basic_auth");
    logger.info("Открыта страница the-internet.herokuapp.com - https://the-internet.herokuapp.com/basic_auth");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Открыть страницу the-internet.herokuapp.com с авторизацией
    driver.get("http://admin:admin@the-internet.herokuapp.com/basic_auth");
    logger.info("Открыта страница the-internet.herokuapp.com - https://the-internet.herokuapp.com/basic_auth");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=SeleniumTest#basicAuthTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/2.%20Selenium/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет открыта страница с авторизацией.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/2.%20Selenium/03.jpg "New Maven Project - Лог запуска")

## 2.2. Отправка файла

Шаги:

1. Открыть файл **SeleniumTest.java** в **./src/test/java**.

2. Добавить в файл **SeleniumTest.java** код.

* метод **fileUploadTest** - отправка файла

```java
@Test
public void fileUploadTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/File-Upload/index.html");
    logger.info("Открыта страница webdriveruniversity.com - https://webdriveruniversity.com/File-Upload/index.html");
    // Приложить файл upload.txt
    String fileUploadXpath = "//input[@type=\"file\"]";
    WebElement fileUpload = driver.findElement(By.xpath(fileUploadXpath));
    // !!! Поменять путь на свой
    fileUpload.sendKeys("C:\\Users\\DKim\\Desktop\\_Sample\\upload\\upload.txt");
    logger.info("Файл приложен");
    // Отправить файл
    String btnSubmitXpath = "//input[@type=\"submit\"]";
    WebElement btnSubmit = driver.findElement(By.xpath(btnSubmitXpath));
    btnSubmit.click();
    logger.info("Файл отправлен!");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(3000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=SeleniumTest#fileUploadTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/2.%20Selenium/04.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет отправлен файл.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/2.%20Selenium/05.jpg "New Maven Project - Лог запуска")

## 2.3. Полный код SeleniumTest.java

[SeleniumTest.java](_Sample/src/test/java/SeleniumTest.java)

***

# 3. Цвета

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **ColorTest.java** в **./src/test/java**.

![New Maven Project - ColorTest.java](./_Files/2.%20New%20Project/3.%20Colors/01.jpg "New Maven Project - ColorTest.java")

2. Добавить в файл **ColorTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(ColorTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 3.1. Получение цвета элемента


* метод **colorTest** - получение цвета элемента

```java
@Test
public void colorTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Click-Buttons/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Click-Buttons/index.html");

    // Цвета
    String btnXpath = "//span[@id=\"button1\"]";
    WebElement btn = driver.findElement(By.xpath(btnXpath));
    Color btnColor = Color.fromString(btn.getCssValue("border-color"));
    Color btnBgColor = Color.fromString(btn.getCssValue("background-color"));
    logger.info("Цвет границы кнопки: ");
    logger.info("HEX - " + btnColor.asHex());
    logger.info("RGB - " + btnColor.asRgb());
    logger.info("RGBA - " + btnColor.asRgba());
    logger.info("Цвет фона кнопки: ");
    logger.info("HEX - " + btnBgColor.asHex());
    logger.info("RGB - " + btnBgColor.asRgb());
    logger.info("RGBA - " + btnBgColor.asRgba());
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=ColorTest#colorTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/3.%20Colors/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут получены цвета фона и границы кнопки.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/3.%20Colors/03.jpg "New Maven Project - Лог запуска")

## 3.2. Полный код ColorTest.java

[ColorTest.java](_Sample/src/test/java/ColorTest.java)

***

# 4. Печать страницы в PDF

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **PrintPageTest.java** в **./src/test/java**.

![New Maven Project - PrintPageTest.java](./_Files/2.%20New%20Project/4.%20Print%20Page/01.jpg "New Maven Project - PrintPageTest.java")

2. Добавить в файл **PrintPageTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(PrintPageTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 4.1. Печать страницы в PDF в формате Base64

Шаги:

1. Открыть файл **PrintPageTest.java** в **./src/test/java**.

2. Добавить в файл **PrintPageTest.java** код.

* метод **savePageToBase64TextTest** - сохранение страницы в PDF в формате Base64

```java
@Test
public void savePageToBase64TextTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Click-Buttons/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Click-Buttons/index.html");
    // Сохранение страницы в PDF
    PrintsPage printer = (PrintsPage) driver;
    PrintOptions printOptions = new PrintOptions();
    printOptions.setPageRanges("1-2");
    Pdf pdf = printer.print(printOptions);
    String content = pdf.getContent();
    logger.info(content);
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=PrintPageTest#savePageToBase64TextTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/4.%20Print%20Page/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате страница будет сохранена в виде текста формата **Base64**.
Данный текст можно с помощью декодирования превратить в файл формата **.pdf**.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/4.%20Print%20Page/03.jpg "New Maven Project - Лог запуска")


## 4.2. Печать страницы в PDF в файл

Шаги:

1. Открыть файл **PrintPageTest.java** в **./src/test/java**.

2. Добавить в файл **PrintPageTest.java** код.

* метод **savePageToBase64TextTest** - сохранение страницы в PDF в формате Base64

```java
@Test
public void savePageToFileTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Click-Buttons/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Click-Buttons/index.html");
    // Сохранение страницы в PDF
    PrintsPage printer = (PrintsPage) driver;
    PrintOptions printOptions = new PrintOptions();
    printOptions.setPageRanges("1-2");
    Pdf pdf = printer.print(printOptions);
    String content = pdf.getContent();
    byte[] decoded = java.util.Base64.getDecoder().decode(content);
    try {
        FileOutputStream fos = new FileOutputStream("pdf.pdf");
        fos.write(decoded);
        fos.flush();
        fos.close();
        logger.info("Страница сохранена в файл pdf.pdf");
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=PrintPageTest#savePageToFileTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/4.%20Print%20Page/04.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате страница будет сохранена в файл **pdf.pdf**.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/4.%20Print%20Page/05.jpg "New Maven Project - Лог запуска")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/4.%20Print%20Page/06.jpg "New Maven Project - Лог запуска")

## 4.3. Полный код PrintPageTest.java

[PrintPageTest.java](_Sample/src/test/java/PrintPageTest.java)

***

# 5. Веб хранилище

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **WebStorageTest.java** в **./src/test/java**.

![New Maven Project - WebStorageTest.java](./_Files/2.%20New%20Project/5.%20WebStorage/01.jpg "New Maven Project - WebStorageTest.java")

2. Добавить в файл **WebStorageTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(WebStorageTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 5.1. Локальное хранилище

Шаги:

1. Открыть файл **WebStorageTest.java** в **./src/test/java**.

2. Добавить в файл **WebStorageTest.java** код.

* метод **localStorageTest** - работа с локальным хранилищем

```java
@Test
public void localStorageTest() {
    // Открыть страницу dns-shop.ru
    driver.get("https://www.dns-shop.ru");
    logger.info("Открыта страница dns-shop.ru - " + "https://www.dns-shop.ru");
    // Получить доступ к локальному хранилищу
    WebStorage webStorage = (WebStorage) driver;
    LocalStorage localStorage = webStorage.getLocalStorage();
    // Получить данные локального хранилища
    Set<String> keySet = localStorage.keySet();
    logger.info("Получение данных локального хранилища dns-shop.ru");
    for (String key : keySet) {
        logger.info("Item [" + key + "]: " + localStorage.getItem(key));
    }
    // Добавить данные в локальное хранилище
    localStorage.setItem("item1", "item1");
    logger.info("Добавление данных в локальное хранилище dns-shop.ru");
    logger.info("Item [item1]: " + localStorage.getItem("item1"));
    // Удалить данные из локального хранилища
    localStorage.removeItem("item1");
    logger.info("Удаление данных из локального хранилища dns-shop.ru");
    logger.info("Item [item1]: " + localStorage.getItem("item1"));
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=WebStorageTest#localStorageTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/5.%20WebStorage/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут:

* получены данные локального хранилища dns-shop.ru
* добавлены данные в локальное хранилище dns-shop.ru
* удалены данные из локального хранилища dns-shop.ru

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/5.%20WebStorage/03.jpg "New Maven Project - Лог запуска")

## 5.2. Сессионное хранилище

Шаги:

1. Открыть файл **WebStorageTest.java** в **./src/test/java**.

2. Добавить в файл **WebStorageTest.java** код.

* метод **sessionStorageTest** - работа с сессионным хранилищем

```java
@Test
public void sessionStorageTest() {
    // Открыть страницу dns-shop.ru
    driver.get("https://www.dns-shop.ru");
    logger.info("Открыта страница dns-shop.ru - " + "https://www.dns-shop.ru");
    // Получить доступ к сессионному хранилищу
    WebStorage webStorage = (WebStorage) driver;
    SessionStorage sessionStorage = webStorage.getSessionStorage();
    // Получить данные сессионного хранилища
    Set<String> keySet = sessionStorage.keySet();
    logger.info("Получение данных сессионного хранилища dns-shop.ru");
    for (String key : keySet) {
        logger.info("Item [" + key + "]: " + sessionStorage.getItem(key));
    }
    // Добавить данные в сессионное хранилище
    sessionStorage.setItem("item1", "item1");
    logger.info("Добавление данных в сессионное хранилище dns-shop.ru");
    String item1 = sessionStorage.getItem("item1");
    logger.info("Item [item1]: " + item1);
    // Удалить данные из локального хранилища
    sessionStorage.removeItem("item1");
    logger.info("Удаление данных из сессионного хранилища dns-shop.ru");
    logger.info("Item [item1]: " + sessionStorage.getItem("item1"));
    // Получить данные сессионного хранилища в новой вкладке
    driver.switchTo().newWindow(WindowType.TAB);
    driver.get("https://www.dns-shop.ru");
    logger.info("Открыта страница dns-shop.ru - " + "https://www.dns-shop.ru");
    Set<String> keySet2 = sessionStorage.keySet();
    logger.info("Получение данных сессионного хранилища dns-shop.ru в новой вкладке");
    for (String key : keySet2) {
        logger.info("Item [" + key + "]: " + sessionStorage.getItem(key));
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=WebStorageTest#sessionStorageTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/5.%20WebStorage/04.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут:

* получены данные сессионного хранилища dns-shop.ru
* добавлены данные в сессионное хранилище dns-shop.ru
* удалены данные из сессионного хранилища dns-shop.ru
* получены данные сессионного хранилища dns-shop.ru в новой вкладке

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/5.%20WebStorage/05.jpg "New Maven Project - Лог запуска")

## 5.3. Полный код WebStorageTest.java

[WebStorageTest.java](_Sample/src/test/java/WebStorageTest.java)

***

# 6. Решение задач с помощью выполнения JavaScript

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **JavaScriptTest.java** в **./src/test/java**.

![New Maven Project - JavaScriptTest.java](./_Files/2.%20New%20Project/6.%20Java%20Script/01.jpg "New Maven Project - JavaScriptTest.java")

2. Добавить в файл **JavaScriptTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(JavaScriptTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 6.1. Клик на веб элемент

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **elementClickTest** - клик по кнопке

```java
@Test
public void elementClickTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Hidden-Elements/index.html");
    // Клик по кнопке
    String button1Xpath = "//span[@id=\"button1\"]";
    WebElement button1 = driver.findElement(By.xpath(button1Xpath));
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script = "arguments[0].click();";
    js.executeScript(script, button1);
    logger.info("Нажата кнопка");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#elementClickTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет выполнен клик по кнопке.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/03.jpg "New Maven Project - Лог запуска")

## 6.2. Вывод текста элементов

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **elementGetTextTest** - получение текста элемента

```java
@Test
public void elementGetTextTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Click-Buttons/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Click-Buttons/index.html");
    // Вывод текста элементов
    String sectionsXpath = "//div[@class=\"section-title\"]";
    List<WebElement> sections = driver.findElements(By.xpath(sectionsXpath));
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script = "return arguments[0].innerText;";
    for (WebElement section : sections) {
        String text = js.executeScript(script, section).toString();
        logger.info("Текст: \n" + text);
    }
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#elementGetTextTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/04.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет выведен текст элементов.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/05.jpg "New Maven Project - Лог запуска")

## 6.3. Скроллинг вниз

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **scrollPagetest** - скроллинг вниз

```java
@Test
public void scrollPagetest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Data-Table/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Data-Table/index.html");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(5000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    // Проскроллить вниз на 500px
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script1 = "window.scrollBy(0,500);";
    js.executeScript(script1);
    logger.info("Проскроллено вниз на 500px");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(5000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    // Проскроллить вниз на 500px
    String script2 = "window.scrollBy(500,1000);";
    js.executeScript(script2);
    logger.info("Проскроллено вниз на 500px");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(5000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#scrollPagetest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/06.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате страница будет проскроллена вниз.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/07.jpg "New Maven Project - Лог запуска")

## 6.4. Изменение прозрачности элемента

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **opacityChangeTest** - изменение прозрачности элемента

```java
@Test
public void opacityChangeTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Кнопка прозрачная");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    // Изменение прозрачности элемента
    String divOpacityZeroXpath = "//div[@id=\"zero-opacity\"]";
    WebElement divOpacityZero = driver.findElement(By.xpath(divOpacityZeroXpath));
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script = "arguments[0].style.opacity=1; return true;";
    js.executeScript(script, divOpacityZero);
    logger.info("Кнопка непрозрачная");
    // Клик по элементу
    divOpacityZero.click();
    logger.info("Нажата кнопка");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#opacityChangeTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/08.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате кнопка станет непрозрачной и будет нажата.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/09.jpg "New Maven Project - Лог запуска")

## 6.5. Изменение видимости элемента

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **visibilityChangeTest** - изменение видимости элемента

```java
@Test
public void visibilityChangeTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Кнопка невидимая");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    // Изменение видимости элемента
    String divVisibilityHiddenXpath = "//div[@id=\"visibility-hidden\"]";
    WebElement divVisibilityHidden = driver.findElement(By.xpath(divVisibilityHiddenXpath));
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script = "arguments[0].style.visibility='visible';";
    js.executeScript(script, divVisibilityHidden);
    logger.info("Кнопка видимая");
    // Клик по элементу
    divVisibilityHidden.click();
    logger.info("Нажата кнопка");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#visibilityChangeTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/10.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате кнопка станет невидимой и будет нажата.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/11.jpg "New Maven Project - Лог запуска")

## 6.6. Изменение отображаемости элемента

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **displayChangeTest** - изменение отображаемости элемента

```java
@Test
public void displayChangeTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Hidden-Elements/index.html");
    logger.info("Кнопка неотображаемая");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    // Изменение отображаемости элемента
    String divDisplayNoneXpath = "//div[@id=\"not-displayed\"]";
    WebElement divDisplayNone = driver.findElement(By.xpath(divDisplayNoneXpath));
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script = "arguments[0].style.display='block';";
    js.executeScript(script, divDisplayNone);
    logger.info("Кнопка отображаемая");
    // Клик по элементу
    divDisplayNone.click();
    logger.info("Нажата кнопка");
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#displayChangeTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/12.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате кнопка станет отображаемой и будет нажата.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/13.jpg "New Maven Project - Лог запуска")

## 6.7. Изменение цвета элемента

Шаги:

1. Открыть файл **JavaScriptTest.java** в **./src/test/java**.

2. Добавить в файл **JavaScriptTest.java** код.

* метод **bgColorChangeTest** - изменение цвета элемента

```java
@Test
public void bgColorChangeTest() {
    // Открыть страницу webdriveruniversity.com
    driver.get("https://webdriveruniversity.com/Click-Buttons/index.html");
    logger.info("Открыта страница webdriveruniversity.com - " + "https://webdriveruniversity.com/Click-Buttons/index.html");

    // Цвет кнопки до
    String spanBtnXpath = "//span[@id=\"button1\"]";
    WebElement spanBtn = driver.findElement(By.xpath(spanBtnXpath));
    String colorBefore = spanBtn.getCssValue("background-color");
    logger.info("Цвет кнопки до - " + colorBefore);
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    // Изменение цвета кнопки
    JavascriptExecutor js = (JavascriptExecutor) driver;
    String script = "arguments[0].style.backgroundColor = 'HotPink'";
    js.executeScript(script, spanBtn);

    // Цвет кнопки после
    String colorAfter= spanBtn.getCssValue("background-color");
    logger.info("Цвет кнопки после - " + colorAfter);
    // Добавление задержки Thread.sleep, чтобы увидеть результат
    try {
        Thread.sleep(10000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=JavaScriptTest#bgColorChangeTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/6.%20Java%20Script/14.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате кнопка сменит цвет.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/6.%20Java%20Script/15.jpg "New Maven Project - Лог запуска")

## 6.8. Полный код JavaScriptTest.java

[JavaScriptTest.java](_Sample/src/test/java/JavaScriptTest.java)

***

# 7. Решение задач с помощью DevTools

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **DevToolsTest.java** в **./src/test/java**.

![New Maven Project - DevToolsTest.java](./_Files/2.%20New%20Project/7.%20DevTools/01.jpg "New Maven Project - DevToolsTest.java")

2. Добавить в файл **DevToolsTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(DevToolsTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 7.1. Предоставление прав браузеру на выполнение операций

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **browserPermissionsTest** - предоставление прав браузеру на выполнение операций

```java
@Test
public void browserPermissionsTest() {
    // Доступ к DevTools
    ChromeDriver chrome =  (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Предоставление прав браузеру на выполнение операций
    // Browser.grantPermissions - предоставление прав браузеру
    // Список предоставляемых прав
    List<PermissionType> permissions = new ArrayList<>();
    // - запись аудио
    permissions.add(PermissionType.AUDIOCAPTURE);
    // - запись видео
    permissions.add(PermissionType.VIDEOCAPTURE);
    // - геолокация
    permissions.add(PermissionType.GEOLOCATION);
    devTools.send(Browser.grantPermissions(permissions, Optional.empty(), Optional.empty()));
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#browserPermissionsTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут предоставлены права браузеру на выполнение операций.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/03.jpg "New Maven Project - Лог запуска")

## 7.2. Получение данных о браузере

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **browserVersionTest** - получение данных о браузере

```java
@Test
public void browserVersionTest() {
    // Доступ к DevTools
    ChromeDriver chrome =  (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Получение данных о браузере
    // Browser.getVersion - получение данных о версии
    Browser.GetVersionResponse version = devTools.send(Browser.getVersion());
    // Вывод данных о браузере
    logger.info("Browser: " + version.getProduct());
    logger.info("User Agent: " + version.getUserAgent());
    logger.info("JS: " + version.getJsVersion());
    logger.info("Protocol: " + version.getProtocolVersion());
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#browserVersionTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/04.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут получены данные о браузере.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/05.jpg "New Maven Project - Лог запуска")

## 7.3. Установка параметров эмулируемого устройства

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **emulationSetDeviceMetricsTest** - установка параметров эмулируемого устройства

```java
@Test
public void emulationSetDeviceMetricsTest() {
    // Доступ к DevTools
    ChromeDriver chrome =  (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Установка параметров эмулируемого устройства
    // Emulation.setDeviceMetricsOverride - установка параметров
    // Параметры эмулируемого устройства
    // - ширина
    int width = 600;
    // - высота
    int height = 1000;
    //
    int deviceScaleFactor = 50;
    // - мобильное устройство
    boolean mobile = false;
    devTools.send(Emulation.setDeviceMetricsOverride(
    width, height, deviceScaleFactor, mobile,
    Optional.empty(), Optional.empty(), Optional.empty(),
    Optional.empty(), Optional.empty(), Optional.empty(),
    Optional.empty(), Optional.empty(), Optional.empty())
    );
    logger.info("Параметры экрана");
    logger.info("Ширина: " + chrome.executeScript("return document.documentElement.clientWidth"));
    logger.info("Высота: " + chrome.executeScript("return document.documentElement.clientHeight"));
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#emulationSetDeviceMetricsTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/06.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут установлены параметры эмулируемого устройства.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/07.jpg "New Maven Project - Лог запуска")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/08.jpg "New Maven Project - Лог запуска")

## 7.4. Установка геолокации

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **emulationSetGeoLocationTest** - установка геолокации

```java
@Test
public void emulationSetGeoLocationTest() {
    // Доступ к DevTools
    ChromeDriver chrome =  (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Установка геолокации
    // Emulation.setGeolocationOverride - установка геолокации
    // Параметры геолокации
    // - широта
    Optional<Number> latitude = Optional.of(50.52930);
    // - долгота
    Optional<Number> longitude = Optional.of(42.68620);
    // - точность
    Optional<Number> accuracy = Optional.of(10);
    devTools.send(Emulation.setGeolocationOverride(latitude, longitude, accuracy));
    // Открыть страницу mycurrentlocation.net
    chrome.get("https://mycurrentlocation.net/");
    logger.info("Открыта страница mycurrentlocation.net - " + "https://mycurrentlocation.net/");
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(3));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#emulationSetGeoLocationTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/09.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет сэмулирована геолокация.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/10.jpg "New Maven Project - Лог запуска")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/11.jpg "New Maven Project - Лог запуска")

## 7.5. Вывод логов

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **logListenerTest** - вывод логов

```java
@Test
public void logListenerTest() {
    // Доступ к DevTools
    ChromeDriver chrome =  (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Вывод логов
    // Log.enable - включение доступа к логам
    devTools.send(Log.enable());
    // Слушатель
    devTools.addListener(Log.entryAdded(),
        // Вывод логов
        logEntry -> {
            logger.info("Log: " + logEntry.getText());
            logger.info("Level: " + logEntry.getLevel());
        }
    );
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#logListenerTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/12.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет выведен лог.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/13.jpg "New Maven Project - Лог запуска")

## 7.6. Сбор метрик

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **performanceMetricsTest** - сбор метрик

```java
@Test
public void performanceMetricsTest() {
    // Доступ к DevTools
    ChromeDriver chrome = (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Сбор метрик
    // Performance.enable - включение сбора метрик
    devTools.send(Performance.enable(Optional.of(Performance.EnableTimeDomain.TIMETICKS)));
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Получение метрик
    // Performance.getMetrics - доступ к метрикам
    List<Metric> metrics = devTools.send(Performance.getMetrics());
    List<String> metricNames = metrics.stream()
        .map(o -> o.getName())
        .collect(Collectors.toList());
    // Performance.disable - выключение сбора метрик
    devTools.send(Performance.disable());
    // Список метрик для проверки
    List<String> metricsToCheck = Arrays.asList(
        "Timestamp",
        "Documents",
        "Frames",
        "JSEventListeners",
        "LayoutObjects",
        "MediaKeySessions",
        "Nodes",
        "Resources",
        "DomContentLoaded",
        "NavigationStart"
    );
    // Вывод метрик
    metricsToCheck.forEach(metric ->
        logger.info(metric + " is : " + metrics.get(metricNames.indexOf(metric)).getValue())
    );
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#performanceMetricsTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/14.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут выведены метрики.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/15.jpg "New Maven Project - Лог запуска")

## 7.7. Перехват и модификация запросов

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **fetchRequestsTest** - перехват и модификация запросов

```java
@Test
public void fetchRequestsTest() {
    // Доступ к DevTools
    ChromeDriver chrome =  (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Перехват запроса
    // Fetch.enable - включение перехвата запроса
    devTools.send(Fetch.enable(Optional.empty(), Optional.empty()));
    // Слушатель
    devTools.addListener(
        // Fetch.requestPaused - остановка запроса
        Fetch.requestPaused(),
        // Обработка запроса
        request -> {
            // Параметры нового запроса
            // - ID запроса
            RequestId requestId = request.getRequestId();
            // - URL запроса
            Optional<String> url = Optional.of(
            request.getRequest().getUrl().contains("?text=Selenium") ?
            request.getRequest().getUrl().replace("?text=Selenium", "?text=JUnit") : request.getRequest().getUrl());
            // - HTTP метод запроса
            Optional<String> method = Optional.of(request.getRequest().getMethod());
            // - данные POST запроса
            Optional<String> postData = Optional.empty();
            // - HTTP заголовки запроса
            Optional<List<HeaderEntry>> headers = request.getResponseHeaders();
            Optional<Boolean> interceptResponse = Optional.of(Boolean.FALSE);
            // Fetch.continueRequest - продолжение запроса
            devTools.send(Fetch.continueRequest(requestId, url, method, postData, headers, interceptResponse));
        }
    );
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#fetchRequestsTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/16.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет перехвачен и модифицирован запрос.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/17.jpg "New Maven Project - Лог запуска")

## 7.8. Эмуляция интернет соединения

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **networkConnectEmulationTest** - эмуляция интернет соединения

```java
@Test
public void networkConnectEmulationTest() {
    // Доступ к DevTools
    ChromeDriver chrome = (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Эмуляция медленного интернет соединения
    // Network.enable - включение сетевых возможностей
    devTools.send(Network.enable(Optional.empty(), Optional.empty(), Optional.empty()));
    // Network.emulateNetworkConditions - эмуляция интернет соединения
    // - параметры соединения
    // - оффлайн режим
    Boolean offline = false;
    // - задержка
    Number latency = 2;
    // - пропускная способность скачивания
    Number downloadThroughput = 20000;
    // - пропускная способность загрузки
    Number uploadThroughput = 20000;
    // - тип соединения
    Optional<ConnectionType> connectionType = Optional.of(ConnectionType.CELLULAR2G);
    devTools.send(Network.emulateNetworkConditions(offline, latency, downloadThroughput, uploadThroughput, connectionType));
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#networkConnectEmulationTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/18.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет сэмулировано интернет соединение (замедленная скорость).

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/19.jpg "New Maven Project - Лог запуска")

## 7.9. Добавление заголовков в запросы

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **networkAddHeadersTest** - добавление заголовков в запросы

```java
@Test
public void networkAddHeadersTest() {
    // Доступ к DevTools
    ChromeDriver chrome = (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Добавление заголовков в запросы
    // Network.enable - включение сетевых возможностей
    devTools.send(Network.enable(Optional.empty(), Optional.empty(), Optional.empty()));
    // Network.setExtraHTTPHeaders - отправка заголовков запроса
    // Заголовки
    Map<String, Object> headers = new HashMap<>();
    headers.put("headername1", "headervalue1");
    devTools.send(Network.setExtraHTTPHeaders(new Headers(headers)));
    // Слушатель
    devTools.addListener(
        // Network.requestWillBeSent - перехват запроса
        Network.requestWillBeSent(),
        // Обработка запроса
        request -> {
            if (request.getRequest().getHeaders().get("headername1") != null) {
                if(request.getRequest().getHeaders().get("headername1").equals("headervalue1")) {
                    logger.info("URL: " + request.getRequest().getUrl());
                    logger.info("Headers: ");
                    request.getRequest().getHeaders().forEach((key, value) -> logger.info(String.format("[%s]: %s", key, value)));
                }
            }
        }
    );
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#networkAddHeadersTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/20.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут добавлены кастомные заголовки в запросы.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/21.jpg "New Maven Project - Лог запуска")

## 7.10. Перехват HTTP запроса

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **networkCaptureHttpRequestTest** - перехват HTTP запроса

```java
@Test
public void networkCaptureHttpRequestTest() {
    // Доступ к DevTools
    ChromeDriver chrome = (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Перехват HTTP запроса
    // Network.enable - включение сетевых возможностей
    devTools.send(Network.enable(Optional.empty(), Optional.empty(), Optional.empty()));
    // Слушатель
    devTools.addListener(
        // Network.requestWillBeSent - перехват запроса
        Network.requestWillBeSent(),
        // Обработка запроса
        request -> {
            if (request.getRequest().getUrl().contains("yandex.ru"))
                logger.info(request.getRequest().getMethod() + " " + request.getRequest().getUrl());
        }
    );
    // Открыть страницу yandex.ru
    chrome.get("https://yandex.ru/search");
    logger.info("Открыта страница yandex.ru - " + "https://yandex.ru/search");
    // Ввести в строку поиска текст - Selenium
    WebElement input = chrome.findElement(By.xpath("//input[@class=\"input__control mini-suggest__input\"]"));
    input.sendKeys("Selenium");
    // Нажать на кнопку "Найти"
    WebElement button = chrome.findElement(By.xpath("//button[@class=\"websearch-button mini-suggest__button\"]"));
    button.click();
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(5));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#networkCaptureHttpRequestTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/22.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будут перехвачены HTTP запросы содержащие в URL текст **yandex.ru**.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/23.jpg "New Maven Project - Лог запуска")

## 7.11. Авторизация Basic Authentication

Шаги:

1. Открыть файл **DevToolsTest.java** в **./src/test/java**.

2. Добавить в файл **DevToolsTest.java** код.

* метод **networkBasicAuthTest** - перехват HTTP запроса

```java
@Test
public void networkBasicAuthTest() {
    // Доступ к DevTools
    ChromeDriver chrome = (ChromeDriver) driver;
    DevTools devTools = chrome.getDevTools();
    // Открытие сессии DevTools
    devTools.createSession();
    // Авторизация BasicAuth
    // Network.enable - включение сетевых возможностей
    devTools.send(Network.enable(Optional.empty(), Optional.empty(), Optional.empty()));
    // Открыть страницу jigsaw.w3.org/HTTP/
    driver.get("https://jigsaw.w3.org/HTTP/");
    logger.info("Открыта страница jigsaw.w3.org/HTTP/ - " + "https://jigsaw.w3.org/HTTP/");
    // Отправка заголовков
    // Network.setExtraHTTPHeaders - отправка заголовков запроса
    final String USERNAME = "guest"; // Имя пользователя
    final String PASSWORD = "guest"; // Пароль пользователя
    byte[] encodedUserPass = new Base64().encode(String.format("%s:%s", USERNAME, PASSWORD).getBytes());
    String basicAuth = "Basic " + new String(encodedUserPass);
    Map<String, Object> headers = new HashMap<>(); // Заголовки
    headers.put("Authorization", basicAuth);
    devTools.send(Network.setExtraHTTPHeaders(new Headers(headers)));
    // Нажать на ссылку "Basic Authentication test"
    WebElement link = driver.findElement(By.linkText("Basic Authentication test"));
    link.click();
    // Проверка результата
    String loginSuccessMsg = driver.findElement(By.tagName("html")).getText();
    if (loginSuccessMsg.contains("Your browser made it!")) {
        logger.info("Успех!");
    }
    else {
        logger.info("Неудача!");
    }
    // Добавление задержки, чтобы увидеть результат
    try {
        Sleeper.SYSTEM_SLEEPER.sleep(Duration.ofSeconds(3));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    // Закрытие сессии DevTools
    devTools.close();
    }
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=DevToolsTest#networkBasicAuthTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/7.%20DevTools/24.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет выполнена авторизация **Basic Auth**.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/25.jpg "New Maven Project - Лог запуска")

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/7.%20DevTools/26.jpg "New Maven Project - Лог запуска")

## 7.12. Полный код DevToolsTest.java

[DevToolsTest.java](_Sample/src/test/java/DevToolsTest.java)

***

# 8. Решение задач с PDF

[![Содержание](https://img.shields.io/badge/-Содержание-66eeff)](#содержание)

Шаги:

1. Создать файл **PdfTest.java** в **./src/test/java**.

![New Maven Project - PdfTest.java](./_Files/2.%20New%20Project/8.%20Pdf/01.jpg "New Maven Project - PdfTest.java")

2. Добавить в файл **PdfTest.java** код.

* объявление драйвера и логгера

```java
protected static WebDriver driver;
private Logger logger = LogManager.getLogger(PdfTest.class);
```

* метод **setUp**

```java
@BeforeEach
public void setUp() {
    driver = WebDriverFactory.getDriver("chrome");
    logger.info("Драйвер стартовал!");
}
```

* метод **setDown**

```java
@AfterEach
public void setDown() {
    if(driver != null) {
        driver.quit();
        logger.info("Драйвер остановлен!");
    }
}
```

## 8.1. Получение текста файла PDF с помощью библиотеки PdfBox

Шаги:

1. Открыть файл **PdfTest.java** в **./src/test/java**.

2. Добавить в файл **PdfTest.java** код.

* метод **pdfTextPdfBoxTest** - получение текста файла PDF с помощью библиотеки PdfBox

```java
@Test
public void pdfTextPdfBoxTest() {
    // Открыть страницу с PDF
    String pdfURL = "http://www.pdf995.com/samples/pdf.pdf";
    driver.get(pdfURL);

    try {
        // Открытие файла PDF
        PDDocument pdf = PDDocument.load(new BufferedInputStream(new URL(pdfURL).openStream()));
        // Извлечение текста из документа PDF
        String text = new PDFTextStripper().getText(pdf);
        logger.info(text);
        // Закрытие файла PDF
        pdf.close();
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=PdfTest#pdfTextPdfBoxTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/8.%20Pdf/02.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет получен текст файла PDF.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/8.%20Pdf/03.jpg "New Maven Project - Лог запуска")

## 8.2. Получение текста файла PDF с помощью библиотеки iText

Шаги:

1. Открыть файл **PdfTest.java** в **./src/test/java**.

2. Добавить в файл **PdfTest.java** код.

* метод **pdfTextITextPdfTest** - получение текста файла PDF с помощью библиотеки PdfBox

```java
@Test
public void pdfTextITextPdfTest() {
    // Открыть страницу с PDF
    String pdfURL = "http://www.pdf995.com/samples/pdf.pdf";
    driver.get(pdfURL);

    try {
        // Открытие файла PDF
        PdfReader pdf = new PdfReader("http://www.pdf995.com/samples/pdf.pdf");
        // Извлечение текста из документа PDF
        // Нумерация страниц в PDF начинается с 1
        TextExtractionStrategy strategy = new SimpleTextExtractionStrategy();
        for (int i = 1; i <= pdf.getNumberOfPages(); ++i) {
            String text = PdfTextExtractor.getTextFromPage(pdf, i, strategy);
            logger.info(text);
        }
        // Закрытие файла PDF
        pdf.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

3. Запустить тест командой **mvn clean test** с параметром **-Dtest=PdfTest#pdfTextITextPdfTest**.

![New Maven Project - Запуск теста](./_Files/2.%20New%20Project/8.%20Pdf/04.jpg "New Maven Project - Запуск теста")

4. Готово!

В результате будет получен текст файла PDF.

В консоли будет выведен лог запуска.

![New Maven Project - Лог запуска](./_Files/2.%20New%20Project/8.%20Pdf/05.jpg "New Maven Project - Лог запуска")

## 8.3. Полный код PdfTest.java

[PrintPdfTest.java](_Sample/src/test/java/PdfTest.java)

***

[![Лекция](https://img.shields.io/badge/-Лекция-ee99ff)](1.%20Лекция.md)
[![Главная](https://img.shields.io/badge/-Главная-aaccee)](README.md)
[![Задание](https://img.shields.io/badge/-Задание-99ffee)](3.%20Задание.md)